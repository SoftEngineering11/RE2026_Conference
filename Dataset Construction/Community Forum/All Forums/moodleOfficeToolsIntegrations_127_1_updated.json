{
  "forumName": "moodleOfficeToolsIntegrations",
  "totalNumberOfPosts": 199,
  "posts": [
    {
      "PostID": 465290,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=465290",
      "NoOfResponses": 3,
      "ResponsesInList": [
        {
          "Title": "Add Shortcut to OneDrive folder does not show in OnDrive File Picker",
          "Text": "I am able to see my OneDrive files throught the 365 Connect file picker in Moodle. I created an \"Add Shortcut to OneDrive\" in our SharePoint Online site. The shortcut folder shows up in my OneDrive when I view it either in Window File Explorer or Mac's Finder. However, when I try the file Picker, that shortcut folder that is linked to our SharePoint document library or folder is not there. thoughts?",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://private-user-images.githubusercontent.com/24686128/403973840-c69ea34a-4a60-4b9d-adbf-f31bb5d39bb7.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzcwNTkzMTksIm5iZiI6MTczNzA1OTAxOSwicGF0aCI6Ii8yNDY4NjEyOC80MDM5NzM4NDAtYzY5ZWEzNGEtNGE2MC00YjlkLWFkYmYtZjMxYmI1ZDM5YmI3LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTYlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE2VDIwMjMzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWZhNTcwMzcyYThlZjQwNjYyYjY5MjE2ZjNjYTU3ZTdmMmFhYTU4NGQ0NTZhOTE2YzNmYThkYjAxNzg5NDgzZDImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.dZhCNZUipftClyUJQw8GpdRq-NxtCw9JvJd05Q8NjQc",
            "https://private-user-images.githubusercontent.com/24686128/403974434-7d22fa70-bb8b-45ca-a997-6c03e92ac5a0.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzcwNTkzMTksIm5iZiI6MTczNzA1OTAxOSwicGF0aCI6Ii8yNDY4NjEyOC80MDM5NzQ0MzQtN2QyMmZhNzAtYmI4Yi00NWNhLWE5OTctNmMwM2U5MmFjNWEwLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTYlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE2VDIwMjMzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWQ1YTM5NTNkY2M4NjkwNzQ4NDI1ZmEyM2NjZjRjMGQ3YzIyYjdlMmZjYmQ2OTFlY2IwMzQyODc0NTZhNmQyMGYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.pgTvL0pv9NwAZsJ_qxHHU_L-MqwOez3sSM2F_YtChzs"
          ],
          "Time": "Friday, January 17, 2025, 4:27 AM",
          "AuthorName": "Jerry Lau",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1324621&course=5",
          "role": [
            "Picture of Jerry Lau",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Add Shortcut to OneDrive folder does not show in OnDrive File Picker",
          "Text": "We are also experiencing the missing 'Link to a file' within Moodle 4.5 version. Below is a screenshot from Moodle 4.3 version. Quite important for us to have this in place for our teaching staff as they use this feature quite heavily.",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1885510/2025-09-02_10-56-04.png"
          ],
          "Time": "Tuesday, September 2, 2025, 6:04 PM",
          "AuthorName": "Ali Hastie",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=90029&course=5",
          "role": [
            "Picture of Ali Hastie",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Add Shortcut to OneDrive folder does not show in OnDrive File Picker",
          "Text": "apparently they are aware of it and is a feature request/bug",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, October 22, 2025, 3:37 AM",
          "AuthorName": "Jerry Lau",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1324621&course=5",
          "role": [
            "Picture of Jerry Lau",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 467978,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=467978",
      "NoOfResponses": 2,
      "ResponsesInList": [
        {
          "Title": "Matched accounts not linked in Synch tab setting",
          "Text": "Enabled 'Match Azure usernames to moodle emails' under Synch Settings tab of Microsoft 365 Integration. Match occurs but account is not connected because '....synch option is disabled' (see below Task output). What 'synch option' is required to be enabled? We do not want to create accounts, just link existing moodle accounts with microsoft accounts (rather than manual csv upload ). I can use the csv upload or ms block to connect this account, want an automated method instead. Moodle Task output is: ......... Syncing user aaa.bbb@ccc.dd ......... Found a user in Azure AD that seems to match a user in Moodle ......... moodle username: plindgreen, aad upn: aaa.bbb@ccc.dd ......... Not matching user because that sync option is disabled. Synch tab setting: only this one setting is enabled. Moodle 4.1",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1878688/image%20%282%29.png"
          ],
          "Time": "Thursday, May 15, 2025, 12:47 AM",
          "AuthorName": "Paul Lindgreen",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1673900&course=5",
          "role": [
            "Picture of Paul Lindgreen",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Matched accounts not linked in Synch tab setting",
          "Text": "You have to have ticked \"Match preexiting uses....\" for the sync to work. Make sure \"Create new accounts in Moodle ....\" is unticked (as you have it) But you also need to go into Manage Auths, and tick \"Prevent new account creation\"",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, October 2, 2025, 9:12 PM",
          "AuthorName": "Martin Burrow",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=7009282&course=5",
          "role": [
            "Picture of Martin Burrow"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 468710,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=468710",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Microsoft Teams Full Integration with Moodle 4.4.5 – Missing local_msgraph Plugin?",
          "Text": "Hi all, I’m working on integrating Microsoft Teams meetings with Moodle 4.4.5+ and have successfully set up the following plugins: ✅ `mod_msteams` v1.5 – working for meeting creation/joining ✅ `local_o365` – installed and connected ✅ `auth_oidc` – enabled for potential Microsoft SSO ⚠️ `local_msgraph` – missing and appears to be deprecated from GitHub The core functionality I want is: Admins/teachers to create Teams meetings directly from Moodle Students to join meetings from Moodle without being prompted as guests Ideally: user sync, calendar sync, and team creation per course Right now, meetings work fine, but students are prompted to “Enter your name” when joining — meaning Teams sees them as guests, not authenticated users. I understand `local_msgraph` previously enabled Graph API features like calendar sync, user matching, and authenticated meeting join — but I can't find a version that supports Moodle 4.4+. Is there an updated version of `local_msgraph` for Moodle 4.4.5+? Or are there alternative ways to enable full Graph API support in newer Moodle versions? Any guidance, links, or insights would be hugely appreciated! Thanks in advance! Shameer P",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, June 30, 2025, 6:36 PM",
          "AuthorName": "Sham P",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1345461&course=5",
          "role": [
            "Picture of Sham P"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 468449,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=468449",
      "NoOfResponses": 3,
      "ResponsesInList": [
        {
          "Title": "local_o365/Field Mappings",
          "Text": "Hi, In the Field Mapping section of the plugin section=auth_oidc_field_mapping, i have mapped field_map_country to Country. We have users in different countries in Europe and in Americas and for all of the users country is synced as it is in Entra ID. The exception are users from Romania who in Entra have Romania as country but in Moodle it syncs the country as Oman. I have manually changed country from Oman to Romania and then run the sync again and the sync changed it back to Oman. What can have caused this? Second question is how can i remove already synced fields if I am not interested in syncyng them anymore? I have synced telephone numbers but now i want to remove them from Moodle. I have set field_map_phone1 & field_map_phone2 to not mapped but phone numbers are still there. How can I remove them?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, June 13, 2025, 5:58 PM",
          "AuthorName": "Andrei P",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=7046114&course=5",
          "role": [
            "Picture of Andrei P"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "local_o365/Field Mappings",
          "Text": "Hi Andrei, regarding to your first question: there was a bug in an o365 plugin version that could be causing your problem. However, this bug should have been fixed by now. Have you installed the latest plugin version? Bug: https://github.com/microsoft/o365-moodle/issues/2757 best regards, Anton",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, June 13, 2025, 6:54 PM",
          "AuthorName": "Anton Tremetzberger",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=9578&course=5",
          "role": [
            "Picture of Anton Tremetzberger",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "local_o365/Field Mappings",
          "Text": "Hi Anton, Thanks for replying. I've started using this plugin this week and i've installed the latest version available 4.5.2 and I noticed this issue right away. I haven't used any previous plugin versions and I see that there is no other new update for the plugin. Github issue was maked as fixed in February",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, June 13, 2025, 8:10 PM",
          "AuthorName": "Andrei P",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=7046114&course=5",
          "role": [
            "Picture of Andrei P"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 462563,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=462563",
      "NoOfResponses": 2,
      "ResponsesInList": [
        {
          "Title": "Strange Problem - MS Block does NOT show \"Connect to MS 365\" option",
          "Text": "This is a strange one. We installed the MS block and using openid authentication for our users to use. In our test platform, they added the 365 block to the courses and are able to select \"connect to MS 365\" option However, in the PRODUCTION platform,  they I have added the 365 block to some of their courses, but the block does not display the  \"Connect to MS 365\" option. ! It only shows \"You are not connected to any Microsoft Services.\" and no option to connect. See attached image Any ideas? strange",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1857144/Capture.PNG"
          ],
          "Time": "Thursday, October 3, 2024, 6:05 AM",
          "AuthorName": "Jerry Lau",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1324621&course=5",
          "role": [
            "Picture of Jerry Lau",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Strange Problem - MS Block does NOT show \"Connect to MS 365\" option",
          "Text": "Similar problem. Student see's 'You are not connected to Microsoft services. Admin see's: 'Connect to Microsoft 365' Updating Authenticated User or Student Role settings for OpenID is the solution",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1878674/MSconnect.PNG"
          ],
          "Time": "Wednesday, May 14, 2025, 10:00 PM",
          "AuthorName": "Paul Lindgreen",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1673900&course=5",
          "role": [
            "Picture of Paul Lindgreen",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 467909,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=467909",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "OAUTH 2 authentication with moodle email field instead of username?ame",
          "Text": "Oauth 2 plugin uses moodle username field for authentication with Microsoft, not moodle email field. MS authentication requires the email field, not the username. Can MS Oauth 2 authentication use moodle email field instead of username.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Saturday, May 10, 2025, 2:32 AM",
          "AuthorName": "Paul Lindgreen",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1673900&course=5",
          "role": [
            "Picture of Paul Lindgreen",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 466976,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=466976",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Automate User Matching CSV upload",
          "Text": "Uploading the User Matching CSV can link accounts for us. In our production environment new users are created daily, uploading the csv manually ever day is cumbersome and not practical in a busy environment. Can this process be automated? Can the csv be placed in a moodle folder and automatically processed by moodle or is a manual upload the only option? Why does Microsoft not provide the option to use the moodle email address when linking accounts and authenticating, instead of the moodle username?If we switch the moodle username to the email address the csv is not required, but we are unable to change our moodle username for other reasons.",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1874708/image.png"
          ],
          "Time": "Friday, March 21, 2025, 9:18 PM",
          "AuthorName": "Paul Lindgreen",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1673900&course=5",
          "role": [
            "Picture of Paul Lindgreen",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 465968,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=465968",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Refresh token error Open ID connect plugin",
          "Text": "Hi I am a newbie to Moodle and used  Microsoft 365 plugins for Moodle (open ID connect) plugin in moodle. Everything worked fine for some time and today I noticed that they are hundreds of failed sign in attempts for certain users. I logged at the sign in logs (non interactive) in Entra ID and the error is: Date 11/02/2025, Request ID 0656XXXXXXXXXXXXXXXXXX Correlation ID 982eXXXXXXXXXXXXXXXXXXXXXXXXX Authentication requirement Many thanks for your guidence.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, February 11, 2025, 8:05 PM",
          "AuthorName": "Usman Jawaid",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=5924722&course=5",
          "role": [
            "Picture of Usman Jawaid"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 465291,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=465291",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "The course is configured to be connected to a Team, but the group creation is pending.",
          "Text": "I enable it and created the teams site ahead of time in our sharepoint admin site.. yet the block shows \"The course is configured to be connected to a Team, but the group creation is pending.\" I ran the scheduled task but nothing I want to connect that teams document library to the user's file repository. I think this is the only way to connect to a sharepoint's document library that is from Teams, correct? thanks",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, January 17, 2025, 4:27 AM",
          "AuthorName": "Jerry Lau",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1324621&course=5",
          "role": [
            "Picture of Jerry Lau",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 465073,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=465073",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "AzureAD - Sync EmployeeID field with Moodle idnumber field",
          "Text": "So we have the AzureAD working perfectly except it is not syncing the employeeID field in AzureAD with the Moodle idnumber as I have requested it to. Is there something different with that field that I would need to enter to get it to sync? Currently I have: External field name Internal field name employeeID idnumber",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, January 9, 2025, 12:12 AM",
          "AuthorName": "Joel R Smith",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=434590&course=5",
          "role": [
            "Picture of Joel R Smith"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 461580,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=461580",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Disabling/Removing M365 authentication",
          "Text": "We wish to remote the M365 SSO Open ID authentication, for business reasons unrelated to the performance or quality of the app. What is the best way to do this? Can we just remove the App Reg or is there something else we need to do?  I think I need to remove the plug-ins but I want to make sure there is not some action that will render my Moodle broken completely due to a php error. I don't see any checkbox that says Enable/Disable. Thank you.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, August 30, 2024, 11:05 PM",
          "AuthorName": "tom swet",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=6117131&course=5",
          "role": [
            "Picture of tom swet"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 460786,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=460786",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Plugins versus LTI for Microsoft Teams",
          "Text": "Hello we are on a Moodle 4.1 on Linux. Hoping to go to Moodle 4.4 when Microsoft release the 4.4 version for the openid authentication plugin. We put the plugin collection of Microsoft 365 ( https://moodle.org/plugins/browse.php?list=set&id=72 ) onto our Moodle a couple of years ago. I've recently noticed Microsoft now have an LTI integration. Can you put both into one Moodle or will they interfere with each other? Or is the LTI supposed to replace the plugin collections? Basically I don't want to break something that is working as the authentication mechanism only to find the LTI version means all the current accounts suddenly won't work etc. I've read it all a couple of times, but I just can't work out whether I will be making more mess than I'm solving. Does anyone know if you can put both on at once or whether it should be one or the other and never both? Thank you",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, August 2, 2024, 5:03 PM",
          "AuthorName": "Heather P",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=45897&course=5",
          "role": [
            "Picture of Heather P",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 453441,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=453441",
      "NoOfResponses": 3,
      "ResponsesInList": [
        {
          "Title": "local_o365\\task\\usersync : Microsoft 365 not configured",
          "Text": "Hello all, I linked our Moodle to Microsoft 365 and people can connect to Moodle using their Microsoft 365 credentials. I then tried to sync existing moodle users to the Microsoft 365 acccounts but when running the task I get the following error : \n```text\nMicrosoft 365 not configured\n```\n When installing the Office 365 plugins, I took the opportunity to change the name of our domain (the name of our school changed) from moodle.gfbienne.ch -> moodle.gbjb.ch and changed my moodle config.php file to this : According to the Notifications of my Admin page, I'm using the following version But, when I get a phpinfo() my old domain name remain at some places but I dont know if this can be the cause of the 'Microsoft 365 not configured' message : My Moodle Finaly, when I tried to have a look to my sync task , I get the following infos : 1. the hostname is stil moodle.gfbienne.ch instead of moodle.gbjb.ch 2. The task returns the following error \n```text\nExecute scheduled task: Synchronisez les utilisateurs avec Azure AD. (local_o365\\task\\usersync)\n... started 16:40:01. Current memory use 7.2 Mo.\n...... Microsoft 365 not configured\n... used 0 dbqueries\n... used 0.00048708915710449 seconds\nScheduled task complete: Synchronisez les utilisateurs avec Azure AD. (local_o365\\task\\usersync)\n```\n I dont know where to change this moodle.gfbienne.ch to moodle.gbjb.ch and if this is the cause of the message 'Office 365 not configured'. As a reminder : new uses can connect using their Microsoft 365 credentials Thanks to all for your help Best Regards \n```text\n\n```",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1822103/image.png",
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1822103/image%20%285%29.png",
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1822103/image%20%281%29.png",
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1822103/image%20%282%29.png",
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1822103/image%20%283%29.png",
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1822103/image%20%284%29.png",
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1822103/image%20%286%29.png"
          ],
          "Time": "Monday, December 11, 2023, 3:03 PM",
          "AuthorName": "Arnaud Forster",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2826395&course=5",
          "role": [
            "Picture of Arnaud Forster"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: local_o365\\task\\usersync : Microsoft 365 not configured",
          "Text": "Hi Arnaud, I haven't had the error yet, but have you tried the following things (we are using version 4.1, but I think it is similar in version 4.3)? In the plugin settings for Microsoft 365 Integration / Advanced / Maintenance Tool - Run Health Check --> do you get an error there? - Run \"Cleanup User Sync Delta Tokens\" In the plugin settings for Microsoft 365 Integration / Sync Settings - Change the synchronization from Delta Sync to Full Sync (if you don't already have it) and try to run the sync again In the plugin settings for Microsoft 365 integration / Setup - which URL do you have in Step 1/3? - you can run the admin consent again (Run \"Provide Admin Consent\") In the scheduled tasks, execute the task \"\\local_o365\\task\\refreshsystemrefreshtoken\" I hope that these tips will help you. There is also a developer forum on github ( https://github.com/microsoft/o365-moodle/issues ) maybe they can also help you. br, Anton",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, December 12, 2023, 5:38 PM",
          "AuthorName": "Anton Tremetzberger",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=9578&course=5",
          "role": [
            "Picture of Anton Tremetzberger",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: local_o365\\task\\usersync : Microsoft 365 not configured",
          "Text": "i have exactly same problem and most probably it is related to some bug in the azure settings or powershell or moodle settings if i ask Microsoft they will point at moodle and with moodle as it is free you officially cannot ask anything...i think that powershell script is outed and so are the documentations... i am getting same errors causing problems",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, July 24, 2024, 2:56 PM",
          "AuthorName": "frank frank",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2676847&course=5",
          "role": [
            "Picture of frank frank"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 460170,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=460170",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Cannot see My OneDrive files - blank (Microsoft 365 block - My OneDrive )",
          "Text": "I have a strange one. In our test platform, the users are able to see their files in their onedrive (Microsoft 365 block - My OneDrive - files visible to select) and use them. However in production, the My OneDrive is blank! (No Files Available) what would cause this?",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1847899/image.png"
          ],
          "Time": "Thursday, July 11, 2024, 10:10 PM",
          "AuthorName": "Jerry Lau",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1324621&course=5",
          "role": [
            "Picture of Jerry Lau",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 458202,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=458202",
      "NoOfResponses": 3,
      "ResponsesInList": [
        {
          "Title": "As a Student - Assignment File submission missing \"Link to the file\" option",
          "Text": "I have a strange situation... we are on moodle 4.1 and running ubuntu 16.x ... when a student tries to submit their file for their homework submission, they can only do \"make a copy of the file\". The option to select \"Link to the file\" is missing. [o] Make a copy of the file [o] Link to the file (this does not show up) The student can only upload their file. Also if we are able to link to it other than trying to do a file assignment submission, I see this Original: unknownsource,repository what does this mean?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, May 7, 2024, 1:22 AM",
          "AuthorName": "Jerry Lau",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1324621&course=5",
          "role": [
            "Picture of Jerry Lau",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: As a Student - Assignment File submission missing \"Link to the file\" option",
          "Text": "Yes this is deliberate -see the documentation Working with files and in particular the section Areas where links cannot be made",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, May 7, 2024, 3:18 AM",
          "AuthorName": "Mary Cooch",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=531675&course=5",
          "role": [
            "Picture of Mary Cooch",
            "Picture of Documentation writers",
            "Picture of Moodle HQ",
            "Picture of Particularly helpful Moodlers",
            "Picture of Testers",
            "Picture of Translators"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: As a Student - Assignment File submission missing \"Link to the file\" option",
          "Text": "thank you",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, May 7, 2024, 11:12 AM",
          "AuthorName": "Jerry Lau",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1324621&course=5",
          "role": [
            "Picture of Jerry Lau",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 457588,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=457588",
      "NoOfResponses": 2,
      "ResponsesInList": [
        {
          "Title": "OneDrive - access controlled link problem (external sharing not enabled)",
          "Text": "Hello there. I have detailed this quite a bit and may not have anything to do with Moodle or your plugin.. When the ms service account is used to connect a user's onedrive for their file repository and select \"access controlled link\" rather than upload the file, the global policy to allow sharing for the \"Anyone\" group in Azure should be enabled correct? If not they will get the error message \".. external sharing is not enabled for this site\".. site meaning OneDrive here is my detailed post https://moodle.org/mod/forum/discuss.php?d=457318 thank you Jerry",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, April 18, 2024, 1:12 AM",
          "AuthorName": "Jerry Lau",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1324621&course=5",
          "role": [
            "Picture of Jerry Lau",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: OneDrive - access controlled link problem (external sharing not enabled)",
          "Text": "hold a sec... I may know why",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, May 7, 2024, 7:54 AM",
          "AuthorName": "Jerry Lau",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1324621&course=5",
          "role": [
            "Picture of Jerry Lau",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 453660,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=453660",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Teams Chat Bot Documentation Review / End of LUIS AI Services",
          "Text": "It seems that the method used to create the Teams Chat Bot is now defunct, LUIS AI Services being replaced/subsumed into Azure AI Language Services, which means that Moodle Documentation relating to the Teams Chat Bot is now also defunct. I have created a GitHub Issue [ here ] discussing this issue and detailing where documentation needs to be reviewed/updated, including Moodle Documents. As it stands, Teams Chat Bots cannot be created using existing guides. That's a weekend I'm not getting back. Hopefully this can be fixed up soon. David.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, December 18, 2023, 6:36 AM",
          "AuthorName": "David Adams",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=6151693&course=5",
          "role": [
            "Picture of David Adams"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 451578,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=451578",
      "NoOfResponses": 3,
      "ResponsesInList": [
        {
          "Title": "OIDC profile fields sync",
          "Text": "Hi everyone, hoping someone can help me out! We've recently launched our moodle site and are authenticating against our Azure AD. The sync is up and running - users are created and updated - but most profile fields that we have mapped are not included in that. When a user is created, they have an email address, location (country and city), and that's it. When they login for the first time, the rest of their profile is filled out: supervisor, job title, department, etc, etc. I've checked the mapping, and it is all set up to be updated on creation, every login, and every user sync task - but it's not. Any ideas what we might have missed? Thanks!",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, October 17, 2023, 6:49 PM",
          "AuthorName": "Louise Bennett",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=5996317&course=5",
          "role": [
            "Picture of Louise Bennett"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: OIDC profile fields sync",
          "Text": "Hi Louise,",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, October 20, 2023, 4:17 PM",
          "AuthorName": "Anton Tremetzberger",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=9578&course=5",
          "role": [
            "Picture of Anton Tremetzberger",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: OIDC profile fields sync",
          "Text": "Thanks, Anton! Yes, we have it set to full sync because the delta sync wasn't functioning properly for us. I will post my query on github, thank you!",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, October 20, 2023, 4:53 PM",
          "AuthorName": "Louise Bennett",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=5996317&course=5",
          "role": [
            "Picture of Louise Bennett"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 443102,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=443102",
      "NoOfResponses": 2,
      "ResponsesInList": [
        {
          "Title": "MS 365 in Moodle",
          "Text": "Hello mates quick one, how do I add MS 365 on my Moodle platform step by step?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, January 18, 2023, 10:47 PM",
          "AuthorName": "Khulekani Clive",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=5387052&course=5",
          "role": [
            "Picture of Khulekani Clive"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: MS 365 in Moodle",
          "Text": "Use the official docs: Moodle and Microsoft 365 - 4.2 Additionaly you have some additional Microsoft links: https://learn.microsoft.com/en-us/microsoft-365/lti/moodle-plugin-configuration?view=o365-worldwide They will be very helpfull!",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, September 20, 2023, 4:14 AM",
          "AuthorName": "João Pedro",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=5498590&course=5",
          "role": [
            "Picture of João Pedro"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 446314,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=446314",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Problem with login trough LDAP and OpenID",
          "Text": "Hello! I have a\nproblem with the login trough the OpenID authentication. I’m using moodle 4.1 (because\nLTS) and the most recent version of the plugins. My goal is\nto allow my users to log is with LDAP and the o365 plugin as they want. My users\nare synchronized from my LDAP. The o365 plugin finds them in the azure too with\nthe sync task (same email from the two sources). Their default auth method is\nLDAP. If I want to login with the OpenID, I got this error message: There was a\nproblem logging you in. Please contact your administrator for assistance. More\ninformation about this error Debug info:\n2 Error code:\nerrorauthgeneral×Dismiss this notification Stack\ntrace: line 570 of\n/auth/oidc/classes/loginflow/authcode.php: moodle_exception thrown line 376 of\n/auth/oidc/classes/loginflow/authcode.php: call to\nauth_oidc\\loginflow\\authcode->handlelogin() line 133 of\n/auth/oidc/classes/loginflow/authcode.php: call to auth_oidc\\loginflow\\authcode->handleauthresponse() line 168 of\n/auth/oidc/auth.php: call to auth_oidc\\loginflow\\authcode->handleredirect() line 31 of\n/auth/oidc/index.php: call to auth_plugin_oidc->handleredirect() But if I\nuse the built in oauth2 authentication method, I can log in with both LDAP and oauth2\nwithout changing the auth type. I don’t want\nto change my user’s auth, because they are synchronized from LDAP. But I want\nto let them login with OpenID after they connect themselves to Azure. And if they change their auth to oidc, they can't change it back to LDAP, only to manual. Thank for\nany help.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, May 2, 2023, 4:39 PM",
          "AuthorName": "Zsolt Horvath",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=5590181&course=5",
          "role": [
            "Picture of Zsolt Horvath"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 445704,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=445704",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Calendar sync issues: synchronisation of activity events (quiz, assignments)",
          "Text": "Dear Community, in our University we mainly use the Outlook calendar and we have successfully synchronised the calendar from Moodle (4.1) to Outlook - so calendar dates in Moodle will be places also in the personal calendar in Outlook. But some important dates are missing: activity events like quiz closing dates, assignment due dates, ... these are events which are also placed in the Timeline-Block of Moodle. There is an older, similar posting: https://moodle.org/mod/forum/discuss.php?d=422237 , but there were no answers to this and it was closed. I think the problem is that these events only have a point in time and not a time period (eg 30 minutes). But is there any possibility to synchronise these events also to Outlook? thanks, br Anton",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, April 12, 2023, 2:15 PM",
          "AuthorName": "Anton Tremetzberger",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=9578&course=5",
          "role": [
            "Picture of Anton Tremetzberger",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 445569,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=445569",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Connect Moodle to Powerapps Microsoft",
          "Text": "Does anyone try to connect Moodle to Powerapps to show info on Moodle courses? If yes, how do you do it? I'm triying do it, but i don't find how to. Thanks",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, April 6, 2023, 1:13 AM",
          "AuthorName": "Raul Font",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2585271&course=5",
          "role": [
            "Picture of Raul Font"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 444909,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=444909",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Trying to connect wordpress as system account using oauth",
          "Text": "I have been trying to connect to wordpress server (which contains my content) to moodle so that users in my moodle course can access content from the wordpress server. I have configured the oauth following the steps in the official document but unable to enable system account connected option. Can someone help me figure this out? Or if there is a better way to achieve solution to my original problem that will be appreciated as well. Thanks in advance",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, March 15, 2023, 4:54 PM",
          "AuthorName": "Ranadheer Mareboina",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=5270048&course=5",
          "role": [
            "Picture of Ranadheer Mareboina"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 443888,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=443888",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Cannot login with SingPass using OIDC Plugin for Moodle",
          "Text": "Cannot login after SingPass  QR code scanning using OIDC Plugin for Moodle: line 49 of /auth/oidc/classes/utils.php: moodle_exception thrown line 290 of /auth/oidc/classes/oidcclient.php: call to auth_oidc\\utils::process_json_response() line 219 of /auth/oidc/classes/loginflow/authcode.php: call to auth_oidc\\oidcclient->tokenrequest() line 118 of /auth/oidc/classes/loginflow/authcode.php: call to auth_oidc\\loginflow\\authcode->handleauthresponse() line 168 of /auth/oidc/auth.php: call to auth_oidc\\loginflow\\authcode->handleredirect() line 31 of /auth/oidc/index.php: call to auth_plugin_oidc->handleredirect()",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/attachment/1784489/img1.PNG?forcedownload=1",
            "https://moodle.org/pluginfile.php/2541971/mod_forum/attachment/1784489/img2.PNG?forcedownload=1"
          ],
          "Time": "Saturday, February 11, 2023, 1:55 AM",
          "AuthorName": "Singaravelan K",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=5439084&course=5",
          "role": [
            "Picture of Singaravelan K"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 443574,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=443574",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Can we import data from Onenote file to a course?",
          "Text": "Is there a way to import our notebook to a moodle course maybe as separate topics?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, February 2, 2023, 3:04 PM",
          "AuthorName": "Nikos Miaoulis",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=5267599&course=5",
          "role": [
            "Picture of Nikos Miaoulis"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 437371,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=437371",
      "NoOfResponses": 3,
      "ResponsesInList": [
        {
          "Title": "LTI Teams Integration",
          "Text": "Has anyone successfully integrated LTI Teams within Moodle? We have setup everything up following the instructions in the link below, except not enabling Create accounts in Moodle for users in Azure AD in the user and course Synch setting within Moodle. We don’t want all our Azure users added to our Moodle installation. https://docs.microsoft.com/en-gb/microsoft-365/lti/moodle-plugin-configuration?view=o365-worldwide When we access the created LTI link, we receive this:",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1760197/D51B5C7A-04D0-4F8B-B1E5-192015B651C2.jpeg"
          ],
          "Time": "Friday, August 19, 2022, 6:20 AM",
          "AuthorName": "Ali Hastie",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=90029&course=5",
          "role": [
            "Picture of Ali Hastie",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: LTI Teams Integration",
          "Text": "Ali - I just recently went through the steps to get Teams integrated with Moodle and it generally seems to be working but I am still working out the best way to handle the work flow. I'm not sure about the sync options available. We opted to sync all users and I know that it creates a scheduled task to do that every day. Hopefully you have figured this out but I would be interested in networking with folks who have integrated Microsoft 365 and Moodle. Peace - Anthony",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, October 28, 2022, 5:56 PM",
          "AuthorName": "Anthony Borrow",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=51473&course=5",
          "role": [
            "Picture of Anthony Borrow",
            "Picture of Core developers",
            "Picture of Plugin developers",
            "Picture of Testers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: LTI Teams Integration",
          "Text": "Hi Antony We did get it working to a fashion with excluding the synching all users from Azure setting. Still to run the pilot with staff and students right enough and our testing has indicated that it is working. As an extra step for us (administrators) where we had to go through Microsoft Integration > Advanced > Manage Teams connection and 'Connect' the Moodle courses individually.",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1770727/2022-10-28_16-10-57.png"
          ],
          "Time": "Friday, October 28, 2022, 11:22 PM",
          "AuthorName": "Ali Hastie",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=90029&course=5",
          "role": [
            "Picture of Ali Hastie",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 436076,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=436076",
      "NoOfResponses": 2,
      "ResponsesInList": [
        {
          "Title": "Moodle - Teams Integration Issue",
          "Text": "I have integrated Moodle to Microsoft Teams and am able to sync the Moodle course to Teams. However, I have a problem with the users assigned to the course. I was assigning 4 users/members (teacher and students) to the Moodle course. After I synced it to the Teams, suddenly the numbers of assigned members in Teams got increased to 293 members (meanwhile, it's still 4 members assigned to the course in the Moodle site). There were many random users (users from my moodle site) got enrolled to the course in Teams. Is there anyone here ever experience this situation? How you resolve this problem? I'm using Moodle 3.10.1+ (Build: 20210204). Thanks in advance for any help.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, July 5, 2022, 4:05 PM",
          "AuthorName": "Alfin Rahardja",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=4686444&course=5",
          "role": [
            "Picture of Alfin Rahardja"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Moodle - Teams Integration Issue",
          "Text": "Alfin - I recently installed the Microsoft 365 and Moodle integration. Similarly, I have Teams working and am able to display the course within the Teams Moodle app tab. It is not clear to me how the sync of users (teachers and members) works. I have been getting mixed results. If I add a teacher, they are automatically added as an owner and the Team shows up for them in the Teams app; however, the behavior for adding members and when they show up remains a bit of a mystery to me. Have you been able to resolve your issue and if so what have you discovered? Peace - Anthony",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, October 28, 2022, 6:02 PM",
          "AuthorName": "Anthony Borrow",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=51473&course=5",
          "role": [
            "Picture of Anthony Borrow",
            "Picture of Core developers",
            "Picture of Plugin developers",
            "Picture of Testers"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 437355,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=437355",
      "NoOfResponses": 4,
      "ResponsesInList": [
        {
          "Title": "OAuth Nginx",
          "Text": "Hi, I have installed moodle on a server with nginx. I would like to be able to connect using the nextcloud server using OAuth2 but it's not working. I made the settings as in the tutorial but when I click on \"Log in using your account on: Nextcloud\", it asks for the nextcloud username and password and after that it redirects back to the moodle login page with no error. On \"OAuth 2 services\" page it says \"System account not connected\". If I try to connect it redirects to the dashboard .  Also, the button to add files from the repository is not appearing. Can anyone help me fix this ? Thankyou!",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, August 18, 2022, 10:09 PM",
          "AuthorName": "C C",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=5031583&course=5",
          "role": [
            "Picture of C C"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: OAuth Nginx",
          "Text": "It's working to connect now.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, August 23, 2022, 6:22 PM",
          "AuthorName": "C C",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=5031583&course=5",
          "role": [
            "Picture of C C"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: OAuth Nginx",
          "Text": "Hello. What configurations dido you had to do in Nginx to allow that?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Saturday, October 8, 2022, 8:18 PM",
          "AuthorName": "Pedro Crispim",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=5195162&course=5",
          "role": [
            "Picture of Pedro Crispim"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: OAuth Nginx",
          "Text": "As I remember, it was not a problem with the nginx server, it was something with the settings in moodle.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, October 12, 2022, 3:23 PM",
          "AuthorName": "C C",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=5031583&course=5",
          "role": [
            "Picture of C C"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 438843,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=438843",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Extra attributes on the auth_oidc plugin",
          "Text": "Is there a way of adding extra AD attributes, that are not in the default list? This is with a view to using existing AD work in place already, with a custom attribute name which has the data we need for each user. TIA",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, September 29, 2022, 4:55 AM",
          "AuthorName": "Dave Perry",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=459940&course=5",
          "role": [
            "Picture of Dave Perry"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 437541,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=437541",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Odd behavior-- is this expected or a bug on our end?",
          "Text": "We've been using Moodle with 356 integration, openid connect, the repository, and the block for at least 5 years now. I have one buggy thing going on that I can't seem to crack. All users sync with Office 365, this instructor's course doesn't sync with Teams (we do it by request), and she does encourage students to sync with their Outlook calendar (which is a cron that never ends). This instructor is finding items in her Sent folder in outlook and they're meeting requests for events in Moodle. They're also for last year, not an active course/semester. So my question: Is this expected (the meeting request from an instructor)? If so, do you have any ideas why it's running on closed courses? She's not accessing the courses to trigger anything. If it's not, can you speculate what may be happening so I can ask my O365 admin to pursue more specific areas? Thank you!",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, August 24, 2022, 9:45 PM",
          "AuthorName": "Pete Phillips",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=650007&course=5",
          "role": [
            "Picture of Pete Phillips"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 433643,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=433643",
      "NoOfResponses": 7,
      "ResponsesInList": [
        {
          "Title": "Restricting visibility of Microsoft teams button in Atto editor to certain users",
          "Text": "Can we restrict visibility of ms teams button in atto editor? are there any useful plugins that help us restrict visibility of buttons in atto?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, April 15, 2022, 2:42 PM",
          "AuthorName": "Fa Ahmed",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=4886127&course=5",
          "role": [
            "Picture of Fa Ahmed"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Restricting visibility of Microsoft teams button in Atto editor to certain users",
          "Text": "You can't restrict by user without a lot of work, but you can simply remove the icon from the toolbar. Go to Site administration > Plugins > Text editors > Atto HTML editor > Atto toolbar settings (https:// yourmoodle.org /admin/settings.php?section=editorsettingsatto) and edit the \"Toolbar config\" field to replace \"links = link, teamsmeeting\" with \"links = link\". See screenshot below.",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1745056/image.png"
          ],
          "Time": "Tuesday, April 19, 2022, 9:34 PM",
          "AuthorName": "Eoin Campbell",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=726938&course=5",
          "role": [
            "Picture of Eoin Campbell",
            "Picture of Core developers",
            "Picture of Plugin developers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Restricting visibility of Microsoft teams button in Atto editor to certain users",
          "Text": "Note that some Atto plugins implement a capability check, so that the button can only be shown to some users based on role. For example see MDL-63772 / https://github.com/moodle/moodle/commit/f4ef234544d9e857ec717b2f066db764f675e5fe where this was done for one of the core atto plugins. This plugin could something similar if it wanted.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, April 20, 2022, 6:27 PM",
          "AuthorName": "Tim Hunt",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=93821&course=5",
          "role": [
            "Picture of Tim Hunt",
            "Picture of Core developers",
            "Picture of Documentation writers",
            "Picture of Particularly helpful Moodlers",
            "Picture of Peer reviewers",
            "Picture of Plugin developers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Restricting visibility of Microsoft teams button in Atto editor to certain users",
          "Text": "we want to keep this button in atto editor for teachers or instructors so they can create meetings.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, April 21, 2022, 7:28 PM",
          "AuthorName": "Fa Ahmed",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=4886127&course=5",
          "role": [
            "Picture of Fa Ahmed"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Restricting visibility of Microsoft teams button in Atto editor to certain users",
          "Text": "You could use the MS Teams Meeting activity plugin instead of the Atto one. I think it does a better job anyway, because it creates a resource directly on the course page, rather than a link inside text. Lecturers can place anywhere, so students wouldn't have a standard way of referencing Teams meetings across a range of courses.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, April 21, 2022, 8:09 PM",
          "AuthorName": "Eoin Campbell",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=726938&course=5",
          "role": [
            "Picture of Eoin Campbell",
            "Picture of Core developers",
            "Picture of Plugin developers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Restricting visibility of Microsoft teams button in Atto editor to certain users",
          "Text": "Thanks a ton Eoin. I installed both the plugins and delete 'teamsmeeting' from Toolbar config editor_atto | toolbar. this resolve the problem. the teams button is hidden from atto editor and teacher can create meetings from activity plugin. thanks a lot.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, April 25, 2022, 4:35 PM",
          "AuthorName": "Fa Ahmed",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=4886127&course=5",
          "role": [
            "Picture of Fa Ahmed"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Restricting visibility of Microsoft teams button in Atto editor to certain users",
          "Text": "Try this pull request, https://github.com/enovation/moodle-atto_teamsmeeting/pulls",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, July 14, 2022, 8:33 PM",
          "AuthorName": "Hector Pasarin",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=4307147&course=5",
          "role": [
            "Picture of Hector Pasarin"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 434445,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=434445",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "User Matching in Microsoft Office 365 Integration the Match Queue status is queued not changing",
          "Text": "Hello team,  I have added a csv file in user matching office 365 integration plugin settings successfully, but the status for match queue remain queued even after forcing the Cron job. We have activated the user sync as well. Any idea why this isn't working? Regards Hugo",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, May 12, 2022, 6:40 PM",
          "AuthorName": "Hugo Pereira Roupar Leite",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=4921125&course=5",
          "role": [
            "Picture of Hugo Pereira Roupar Leite"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 433913,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=433913",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "This forum post has been removed",
          "Text": "The content of this forum post has been removed and can no longer be accessed.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "N/a",
          "AuthorName": "N/a",
          "AuthorMoodleLink": "N/a",
          "role": [],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 432436,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=432436",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Guide to integrating and connecting the Moodle to the SharePoint 2013 service",
          "Text": "Hi Respectfully, we need to integrate the Moodle with the\nSharePoint service. We use the latest version of the Moodle and our SharePoint\nis the 2013 version. We plan to use Moodle as the LMS and SharePoint as the CMS. Thank you for guiding me on how to do this, how to configure\nit, and what I need to integrate. Thanks Mehran Farahraz",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, March 3, 2022, 12:40 PM",
          "AuthorName": "Mehran Farahraz",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=4814127&course=5",
          "role": [
            "Picture of Mehran Farahraz"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 431272,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=431272",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "How remove atto_teamsmeeting",
          "Text": "Hi, I am trying to remove theatti_teamsmeeting plugin but I always get error when I try to remove it. How can I manually remove this plugin? I may have a conflict with others and am trying to remove it to see if it is resolved. Thank you",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/attachment/1735407/Cattura231.PNG?forcedownload=1"
          ],
          "Time": "Thursday, January 27, 2022, 11:57 PM",
          "AuthorName": "Alessandro P.",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=3863204&course=5",
          "role": [
            "Picture of Alessandro P."
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 429666,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=429666",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "M365 Integration - Error when attempting to provide \"Admin consent\"",
          "Text": "Hello, We're in the process of setting up Microsoft 365 Integration and are following the steps outlined in this well written documentation here: https://docs.moodle.org/311/en/Microsoft_365 We've gone through the process of creating the \"Application\" in Azure and used the PowerShell script to configure it and generate an AppID and Token. We're now on Step 4.1 of Configure the Microsoft 365 support plugin where we log into an Azure with an Administrator account to approve new permissions.  After logging in, the browser sits on the URL \" https://login.microsoftonline.com/common/Consent/Set \" for about 30 seconds and then redirected back to Moodle \" https://www2.derbylearn.net/auth/oidc/ \" with the following error in a pink box: Error in OpenID Connect. Please check logs for more information. More information about this error [ https://docs.moodle.org/311/en/error/auth_oidc/erroroidccall ] I've checked the php error log but there's no additional information there: [03-Dec-2021 12:13:11 Europe/London] Default exception handler: Unknown state. Debug: \n```text\nError code: errorauthunknownstate\n\n\n* line 198 of \\auth\\oidc\\classes\\loginflow\\authcode.php: moodle_exception thrown\n\n\n* line 114 of \\auth\\oidc\\classes\\loginflow\\authcode.php: call to auth_oidc\\loginflow\\authcode->handleauthresponse()\n\n\n* line 165 of \\auth\\oidc\\auth.php: call to auth_oidc\\loginflow\\authcode->handleredirect()\n\n\n* line 29 of \\auth\\oidc\\index.php: call to auth_plugin_oidc->handleredirect()\n\n\n[03-Dec-2021 12:27:52 Europe/London] Default exception handler: Error in OpenID Connect. Please check logs for more information. Debug: \n\n\nError code: erroroidccall\n\n\n* line 47 of \\auth\\oidc\\classes\\utils.php: moodle_exception thrown\n\n\n* line 282 of \\auth\\oidc\\classes\\oidcclient.php: call to auth_oidc\\utils::process_json_response()\n```\n We're not sure how to proceed from this step as we're totally dependant on the instructions. Any advise would be most welcome. Thanks, Chris",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/attachment/1729085/Image%201.png?forcedownload=1",
            "https://moodle.org/pluginfile.php/2541971/mod_forum/attachment/1729085/Image%202.png?forcedownload=1"
          ],
          "Time": "Friday, December 3, 2021, 8:36 PM",
          "AuthorName": "Chris Walsh",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=56849&course=5",
          "role": [
            "Picture of Chris Walsh"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 428761,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=428761",
      "NoOfResponses": 8,
      "ResponsesInList": [
        {
          "Title": "Moodle Course and Teams sync",
          "Text": "I'm using the Microsoft 365 Integration to enable my school's teachers to use their Moodle courses inside of their teams. When syncing users does it sync from both the Moodle course and the team the course is attached to. For example: Does adding or removing users in the team get synced across to Moodle course If the a Moodle course is connected to an existing team does the members and owners already in the team get merged with the participants from the Moodle course? Many of our teachers will want to use their Moodle courses in their teams but manage the membership from within Teams.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, November 5, 2021, 12:36 AM",
          "AuthorName": "Ross Lovell",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2044051&course=5",
          "role": [
            "Picture of Ross Lovell"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Moodle Course and Teams sync",
          "Text": "I have another question: What happens if you add more than one Moodle course to an existing team? For instance I have a team already created (with no Moodle course attached to it) with members in it. I then add the first Moodle course (Course #1) which has different participants to the members already in the team. I then add a second Moodle course (Course #2) with different participants to the team and Course #1. Both of the Course #1 and Course #2 appear as tabs within the team and can be accessed but what happens to the members of the team and the participants in both in Course #1 and Course #2. Ideally in the above situation I'd like all of the users to be merged together so that the team and the Course #1 and Course #2 have the same members/participants without any being removed from them. And if any changes are made to the membership within the Team I'd like that be reflected across the Course #1 and Course #2 while they are attached to the team. I'm using the following: Moodle 3.11.3+ (Build: 20211102)",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, November 5, 2021, 6:27 PM",
          "AuthorName": "Ross Lovell",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2044051&course=5",
          "role": [
            "Picture of Ross Lovell"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Moodle Course and Teams sync",
          "Text": "I don't understand what you mean when you say \"add a Moodle course to the Team\" and the courses \"appear as tabs within the Team\". Are you adding a \"Website\" tab?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Saturday, November 6, 2021, 3:15 AM",
          "AuthorName": "Eoin Campbell",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=726938&course=5",
          "role": [
            "Picture of Eoin Campbell",
            "Picture of Core developers",
            "Picture of Plugin developers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Moodle Course and Teams sync",
          "Text": "Thank for your reply Eoin and sorry for the confusion. I've created a Teams Moodle app and loaded it into our schools Teams App Store following the instructions for the Microsoft 365 Integration plugin (see Step 4: Deploy your Microsoft Teams app). https://docs.microsoft.com/en-us/microsoftteams/install-moodle-integration https://docs.moodle.org/310/en/Microsoft_365#Add_Moodle_app_to_Teams The app creates tabs to Moodle courses specified within the Teams sync settings in Moodle or a user can click on the + button and select the Moodle app within Teams and specify the course they wish to add to their team as a tab.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Saturday, November 6, 2021, 4:50 AM",
          "AuthorName": "Ross Lovell",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2044051&course=5",
          "role": [
            "Picture of Ross Lovell"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Moodle Course and Teams sync",
          "Text": "No and no. The Team membership/course enrolment relationship is one-way: from the Moodle course to the Team. Changes to Team membership have no effect on the Moodle course.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, November 5, 2021, 8:55 PM",
          "AuthorName": "Eoin Campbell",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=726938&course=5",
          "role": [
            "Picture of Eoin Campbell",
            "Picture of Core developers",
            "Picture of Plugin developers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Moodle Course and Teams sync",
          "Text": "Thank you for your reply Eorin. It's a shame that the membership/course enrolment relationship isn't two way. I can foresee a number of our teachers won't want add Moodle courses to their teams because of this. At least the departments who are heavily invested in Moodle will get some use out of it.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, November 5, 2021, 10:24 PM",
          "AuthorName": "Ross Lovell",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2044051&course=5",
          "role": [
            "Picture of Ross Lovell"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Moodle Course and Teams sync",
          "Text": "Okay, new question. If I've added a Moodle course to a pre-existing team, how do I safely remove the course from the team so that the connection to Moodle is removed but the team and all of its members remain? In the Teams Customization area if I uncheck the sync options for Group only and Teams for the Moodle course (to set them back to default) the team is deleted from Microsoft Teams which is what I want to avoid.",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1725656/moodle-teams-sync-settings.jpg"
          ],
          "Time": "Friday, November 5, 2021, 11:07 PM",
          "AuthorName": "Ross Lovell",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2044051&course=5",
          "role": [
            "Picture of Ross Lovell"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Moodle Course and Teams sync",
          "Text": "I've been looking into this further noticed that when you go to the Microsoft 365 Integration plugin options and click on the Advanced settings tab and open the Manage Team Connections link to Connect a Moodle course the dropdown menu has the Not connected option shown by default. However once a Moodle course is connected to a MS team the Not connected option disappears and I can't find a way to remove the connection. The only option appears to be to connect the course to another team. As I mentioned what I'm looking for is a way to remove the connection between the Moodle course and the MS team without the team being deleted in the process. If anyone has any help or advise on this it would be a huge help.",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1725932/teams-connection-menu.png"
          ],
          "Time": "Monday, November 8, 2021, 8:30 PM",
          "AuthorName": "Ross Lovell",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2044051&course=5",
          "role": [
            "Picture of Ross Lovell"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 427818,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=427818",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Teams Meeting (Atto ::: atto_teamsmeeting)",
          "Text": "Hi, Trying to update \"atto_teamsmeeting\" to version \"v1.2.3 (2020032703)\" but got this error message: \"Installing available updates Debugging output enabled Downloading atto_teamsmeeting ... <- https://moodle.org/plugins/download.php/25262/atto_teamsmeeting_moodle311_2020032703.zip -> /www/moodledata/temp/core_plugin/code_manager/distfiles/22f49ed52aed1a7222b43898cff2c3eb.zip ... OK Validating atto_teamsmeeting ... core_plugin/corrupted_archive_structure",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, October 8, 2021, 10:06 PM",
          "AuthorName": "Ricardo Caiado",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=49398&course=5",
          "role": [
            "Picture of Ricardo Caiado",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 427096,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=427096",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "atto teamsmeeting questions",
          "Text": "How can prevent non participate in a course moodle from sharing link of Meeting? How can I allow only enrolled user to bypass the lobby in Teams? Is there a way ?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, September 20, 2021, 5:16 PM",
          "AuthorName": "Hanan Alsahafi",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=3328954&course=5",
          "role": [
            "Picture of Hanan Alsahafi"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 426645,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=426645",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Issue with Moodle Calendar Sync with Outlook calendar when delete events",
          "Text": "Hi, I have created calendar sync between Moodle and Outlook successfully. All created events are updating fine both ways. But when I delete or update an event from Outlook Calendar, it didn't synchronize with Moodle calendar, event remains in the Moodle side. But if I delete\nan event from Moodle calendar it synchronizes with Outlook calendar nicely. i tested with different account also with deferent calendars, but the issue exists. Integration was done using Office 365 plugin and calendar Synchronization is set to Both sides. Moodle 3.10.6+ and Office 365 latest plugin Cron is running in 1 min. I really appreciate if you could help me on this issue as this is an urgent implementation requirement. Thank you MORE DETAILS :-- ------------------------------------------------------------- Some Screen shots of my test site : This is Moodle side config my Outlook calendar : issue is I have deleted 24th Event from Outlook Calendar But in Moodle calendar Still the event is appearing. Other events are syncing normally without any issue, problem found only with edited or deleted event from Outlook side. I edit 24th event and rescheduled to 26th which is correctly appearing in Outlook calendar\nbut in Moodle calendar still in 24th \n```text\ni tested with second account also with deferent calendars, but the issue exists\n```\n \n```text\n\n```",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1717655/moodle%20calendar%20config.png",
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1717655/2.png",
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1717655/3.png"
          ],
          "Time": "Thursday, September 9, 2021, 3:03 PM",
          "AuthorName": "Nilantha Gane",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=4433170&course=5",
          "role": [
            "Picture of Nilantha Gane"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 426576,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=426576",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Description Syncing",
          "Text": "We have a moodle instance that is syncing users from our Azure using OpenIDConnect. For some reason whenever we sync our users over it replaces the users profiles descriptions (the field that users can enter text about themselves that is publicly viewable) with just a '1'. I can't figure out where the sync is pulling that from but I would like to exclude that information and let people edit the field on moodle without it syncing over. Thanks ahead!",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, September 8, 2021, 4:22 AM",
          "AuthorName": "Mark Ferron",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=3382253&course=5",
          "role": [
            "Picture of Mark Ferron"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 416143,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=416143",
      "NoOfResponses": 5,
      "ResponsesInList": [
        {
          "Title": "Change LDAP accounts to OpenID accounts automatically on log in",
          "Text": "Hi, Is there a way to set the authentications up so that is a user has logged in using LDAP and received grades, they can log in using OpenID authentication and retain the grades. I just want to change the method of authentication from LDAP to OpenID(Azure AD). There are about 400 users logged in using LDAP, is that even possible? Running the CRON to match the user not working. Thanks again",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, January 5, 2021, 6:17 PM",
          "AuthorName": "Jatin Sharma",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=3970102&course=5",
          "role": [
            "Picture of Jatin Sharma"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Change LDAP accounts to OpenID accounts automatically on log in",
          "Text": "We have the same issue with 3000 users....did you find a solution?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, August 11, 2021, 6:49 AM",
          "AuthorName": "Bruce Wilbee",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1818245&course=5",
          "role": [
            "Picture of Bruce Wilbee"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Change LDAP accounts to OpenID accounts automatically on log in",
          "Text": "The only way to change existing users' authentication method from LDAP to OpenID is by uploading an appropriately formatted file in the User Matching page (see below), as far as I can tell. This works reasonably well for us. However, we have noticed that in some cases, Moodle accounts are duplicated: a student logs in the first time using OpenID/Microsoft 365, and an hour or a day later, when they log in again, instead of logging in to their existing account, Moodle creates a new account instead, which is a nuisance. We couldn't track down the issue.",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1713792/2021-08-11%2011_42_40-TU%20Dublin%20Tallaght_%20Administration_%20Plugins_%20Local%20plugins_%20Microsoft%20365%20Integr.png"
          ],
          "Time": "Wednesday, August 11, 2021, 6:49 PM",
          "AuthorName": "Eoin Campbell",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=726938&course=5",
          "role": [
            "Picture of Eoin Campbell",
            "Picture of Core developers",
            "Picture of Plugin developers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Change LDAP accounts to OpenID accounts automatically on log in",
          "Text": "\"an hour or a day later, when they log in again, instead of logging in to their existing account, Moodle creates a new account instead, which is a nuisance.\" Try Manage authentication (/admin/settings.php?section=manageauths) > tick the Prevent account creation when authenticating (authpreventaccountcreation) box ?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, August 12, 2021, 3:55 PM",
          "AuthorName": "Przemek Kaszubski",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=109067&course=5",
          "role": [
            "Picture of Przemek Kaszubski",
            "Picture of Particularly helpful Moodlers",
            "Picture of Testers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Change LDAP accounts to OpenID accounts automatically on log in",
          "Text": "Thanks for responding, but I don't think this approach will work in our case, as we don't pre-provision students on Moodle. The behaviour I see is: 1) new student authenticates using OpenID; 2) Moodle creates an account; 3) student logs out; 4) student logs in again; 5) Moodle creates a second account for the same student, instead of simply logging them in to the existing account.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, August 12, 2021, 4:45 PM",
          "AuthorName": "Eoin Campbell",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=726938&course=5",
          "role": [
            "Picture of Eoin Campbell",
            "Picture of Core developers",
            "Picture of Plugin developers"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 424889,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=424889",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "OneNote / Moodle integration",
          "Text": "Hello We got the MS Teams integration running last year. This year we thought we would add the OneDrive integration but I'm struggling to find a good overview of how it is supposed to work because I don't' think it does what we wanted. We had hoped that we could make existing Moodle courses link to existing MS Teams. I can't seem to make it do that. If I choose to make one Moodle course sync it then creates an MS Team. We don't want the Moodle courses replicating in Teams -we do want the OneNote Notebook to link up to an existing Team. We populate Teams from our MIS system - as in Team creation and students going into and being withdrawn from. We don't do that in Moodle. Moodle is more a self enrolment and we just want the OneNote Notebook to link through from the Moodle course to a specific MS Team. Is that possible does anyone know? Thank you Heather",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, July 21, 2021, 6:06 PM",
          "AuthorName": "Heather P",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=45897&course=5",
          "role": [
            "Picture of Heather P",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 424325,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=424325",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Failed opening 'Moodle/local/o365/version.php' for inclusion",
          "Text": "How do I fix this php warning as I think it might be contributing to the lock on my Moodle that thinks there is an upgrade in progress. It occurred straight after an upgrade to Moodle 3.10 which included updating the plugin   local/o365 to the latest version. PHP Warning:  include(): Failed opening 'c:\\xxxx\\xxxx\\Moodle/local/o365/version.php' for inclusion (include_path='c:\\xxxx\\xxxxx\\Moodle/lib/ pear ;.;C:\\php\\pear') in c:\\xxxx\\xxxx\\Moodle\\lib\\classes\\component.php on line 1143 I'm on Windows servers and using MS SQL and php 7.4 I've had a look at the php ini file to try to straighten out the mixture of forward and back slashes in the file path in case that made a difference. We were using the default path and now I have put in include_path = \".;C:\\php\\pear\" I've restarted IIS but I don't think it has made any difference. I really need to release the lock, but don't know how. This maybe a red herring, but it doesn't look good in an error log having errors that I should fix. Thank you Heather",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, July 6, 2021, 9:19 PM",
          "AuthorName": "Heather P",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=45897&course=5",
          "role": [
            "Picture of Heather P",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 422878,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=422878",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Moodle Teams onwer syncing",
          "Text": "Hello, I'm facing problem with Moodle Teams syncing, the sync is working fine, but I noticed lately that some students are not synced from the course to the Team of the course. Moreover each team created with multiple owner now, the team group have many owners, like global managers and category managers, even some old users, which total strange! Can anyone help?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, May 31, 2021, 5:14 PM",
          "AuthorName": "Haytham Abdulla",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1841677&course=5",
          "role": [
            "Picture of Haytham Abdulla"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 422254,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=422254",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Integration with Teams - Moodle 3.10.1",
          "Text": "Hi Everyone, I've started to install MicroSoft Teams plugin and following the documetnation at: https://docs.microsoft.com/en-us/microsoftteams/install-moodle-integration It has a video and following that video I download the PowerShell script and run it with admin privilege.  However I get the following from the PowerShell and it just seems to hang: PS C:\\WINDOWS\\system32> cd F:\\Users\\Dave\\Downloads\\Moodle-AzureAD-Powershell\\Moodle-AzureAD-Powershell PS F:\\Users\\Dave\\Downloads\\Moodle-AzureAD-Powershell\\Moodle-AzureAD-Powershell> .\\Moodle-AzureAD-Script.ps1 Untrusted repository You are installing the modules from an untrusted repository. If you trust this repository, change its InstallationPolicy value by running the Set-PSRepository cmdlet. Are you sure you want to install the modules from 'PSGallery'? [Y] Yes  [A] Yes to All  [N] No  [L] No to All  [S] Suspend  [?] Help (default is \"N\"): Y Can anyone please explain what I can do, or should have done to get the thing to progress further? Cheers",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, May 14, 2021, 10:49 PM",
          "AuthorName": "Dave Emsley",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=95338&course=5",
          "role": [
            "Picture of Dave Emsley"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 422237,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=422237",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Moodle to Outlook course calendar no sync",
          "Text": "Hi everyone, I managed to enable login with Office 365 account on my Moodle and it work great. Using the microsoft block, I configured the calendar sync settings to enable it for a tester course I have, where the user is enrolled in. I have some assignments on that course that show on the Moodle calendar. But they don't show on my Outlook calendar. I have activated all of them just in case (Calendar, Birthdays, Holidays,...) The weird thing is, if I create a personal event on Moodle, that shows on my Outlook. Does anyone have any insights on why this happens? I'm working on a big project and It's quite important for the course events to sync. Thank you all.",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1701348/image.png",
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1701348/image%20%281%29.png"
          ],
          "Time": "Friday, May 14, 2021, 6:51 PM",
          "AuthorName": "Ur BCN",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=4243666&course=5",
          "role": [
            "Picture of Ur BCN"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 421738,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=421738",
      "NoOfResponses": 2,
      "ResponsesInList": [
        {
          "Title": "Create teams meeting url not update in chrome 90.0.4430.93",
          "Text": "Dear All, successful signin teams meeting, After clicking on the create link button in <iframe> popup, its redirecting to our application login page instead of creating a link .This issue is happening only in update chrome and working fine in other browsers This issue happens once when the user clicks the \"Create\" button on the Teams <iframe> panel and i attached the screenshots below. I would be grateful for any comments or suggestions. Thanks! ArunKumar",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://user-images.githubusercontent.com/83411032/116651400-c2068200-a9a0-11eb-88dd-6d9af74b0ce5.PNG",
            "https://user-images.githubusercontent.com/83411032/116651419-caf75380-a9a0-11eb-99f2-63163012c2ab.PNG"
          ],
          "Time": "Monday, May 3, 2021, 12:58 PM",
          "AuthorName": "Arunkumar D",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=4226449&course=5",
          "role": [
            "Picture of Arunkumar D"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Create teams meeting url not update in chrome 90.0.4430.93",
          "Text": "Hi, I would apricate if there is any update on the above query...",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, May 3, 2021, 11:01 PM",
          "AuthorName": "Arunkumar D",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=4226449&course=5",
          "role": [
            "Picture of Arunkumar D"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 403562,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=403562",
      "NoOfResponses": 2,
      "ResponsesInList": [
        {
          "Title": "User Creation Restrictions",
          "Text": "I'm trying to prevent unlicensed users that are attached to a Shared Mailbox in O365 from being created as users in moodle. Does anyone have any ideas on the best way to accomplish this? All of my real users have a \"department\" set in AzureAD, but I can't figure out how to restrict users that don't have anything in department using regular expressions. Can someone point me in the right direction?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, May 19, 2020, 3:18 AM",
          "AuthorName": "Harrison Zipper",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2993602&course=5",
          "role": [
            "Picture of Harrison Zipper"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: User Creation Restrictions",
          "Text": "I have a similar issue. I would like to exclude the non-user accounts that are in Azure. The accounts I want to exclude may have a name and.or an email address, but they will not have other profile fields completed. Is there a way to test for non-empty on a profile field using regular expressions?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, April 21, 2021, 8:10 AM",
          "AuthorName": "Ron Meske",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=55926&course=5",
          "role": [
            "Picture of Ron Meske"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 420660,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=420660",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Syncing from multiple groups",
          "Text": "We are attempting to sync users belonging to 2+ groups in AD but when more than 1 group is put into the user creation restriction field (restricting on Microsoft 365 group membership) none of the users are created. Each of the groups individually seems to work. We've tried several formats, for example ^(group1|group2)$, group1|group2, and others. What is the proper format to match users from multiple groups?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, April 8, 2021, 3:07 AM",
          "AuthorName": "J K",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=4186186&course=5",
          "role": [
            "Picture of J K"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 419543,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=419543",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Microsoft block SSO not working",
          "Text": "Hello, We use Microsoft 365 Integration and local_office365 official Moodle plugins with OpenID user/password authentication. Login using Office 365 credentials works fine and sync with Azure works fine also. The problem that I can't solve is when loggedin user click in link from Microsoft Block (for example, when click into \"My Email\" link). At this moment, user have to login again with user and password to view their emails. The same happens with the rest of the links. Is there any way so that once the user is logged into Moodle, with their Office 365 credentials, they do not have to re-enter their credentials to access the rest of the Office 365 services?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, March 11, 2021, 7:13 PM",
          "AuthorName": "Daniel MM",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2219063&course=5",
          "role": [
            "Picture of Daniel MM"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 419119,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=419119",
      "NoOfResponses": 2,
      "ResponsesInList": [
        {
          "Title": "Embed video from onedrive",
          "Text": "Trying to add embed video from my onedrive to moodle gives me \"no video with supported format and mime type found\". This will happen if I choose \"Link to the file directly\" or \"Create an alias/shortcut to the file\". I can make it work by doing \"Make a copy of the file\" but this is not an option we wanna use to fill our space. Have tried various video files and always same thing. In our moodle Azure AD Setup all is good but its telling : \"Missing Permissions: Read and write all users' full profiles\" Is this something that is affecting this behavior ? Any other suggestions/directions ?",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1688944/image.png",
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1688944/image%20%281%29.png"
          ],
          "Time": "Wednesday, March 3, 2021, 1:30 PM",
          "AuthorName": "Toni Jokinen",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=3741315&course=5",
          "role": [
            "Picture of Toni Jokinen"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Embed video from onedrive",
          "Text": "Fixed Missing Permissions and checked that Files.ReadWrite settings at Azure end are correct. Issue still remains.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, March 3, 2021, 5:08 PM",
          "AuthorName": "Toni Jokinen",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=3741315&course=5",
          "role": [
            "Picture of Toni Jokinen"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 409580,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=409580",
      "NoOfResponses": 2,
      "ResponsesInList": [
        {
          "Title": "Triggering Moodle Bot",
          "Text": "Hi all I am wondering if there is a way to trigger the Moodle Bot from within Teams? I know there is a way in the connection or health centre in Moodle to trigger the re-creation of deleted teams but is it possible to trigger this in Teams or Azure? We want to be able to trigger this outside the Moodle platform",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Sunday, August 30, 2020, 6:54 AM",
          "AuthorName": "charles hamill",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=3501314&course=5",
          "role": [
            "Picture of charles hamill"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Triggering Moodle Bot",
          "Text": "Hi Have you solved this? If not I can say that ours appears when the Moodle app is added to a team as an app. SO far we haven't managed to populate it with any useful answers sop now I'm trying to turn it off.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, February 24, 2021, 11:44 PM",
          "AuthorName": "Heather P",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=45897&course=5",
          "role": [
            "Picture of Heather P",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 418133,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=418133",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "O365 Repository Homework File Submission Link",
          "Text": "We are missing the ability to \"Create an alias/shortcut to the file.\" with our O365 repository. have looked a the documentation at https://docs.moodle.org/310/en/Microsoft_365 under \"OneDrive for Business Repository\". It lists we should have a alias/shortcut option. Unsure if this is an outdated article for when Onedrive for business wasn't integrated into the O365 repository. Long question short - how do we integrate large homework submission through O365 instead of doing an offline full upload to the Moodle server ? It the O365 repository capable of this? Do we need to turn on the old OneDrive repository first? Thank you Shane Mosaic version - 3.9.3 3",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1684719/Missing%20link.jpg"
          ],
          "Time": "Thursday, February 11, 2021, 3:49 AM",
          "AuthorName": "Shane Hall",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2492031&course=5",
          "role": [
            "Picture of Shane Hall"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 414067,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=414067",
      "NoOfResponses": 4,
      "ResponsesInList": [
        {
          "Title": "SDS sync not working",
          "Text": "You do not have any schools available in School data sync",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, November 18, 2020, 2:26 PM",
          "AuthorName": "Mohamed Lotfy",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=3531330&course=5",
          "role": [
            "Picture of Mohamed Lotfy"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: SDS sync not working",
          "Text": "I found there was an error in the SDS code - namely Microsoft have change their keyfields from 'objectid' to 'id'. Also the beta api call seems to have changed. Anyway, Im in the process of make the SDS work.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, January 8, 2021, 5:06 PM",
          "AuthorName": "Brad Nielsen",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2522606&course=5",
          "role": [
            "Picture of Brad Nielsen"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: SDS sync not working",
          "Text": "I have updated the SDS code in my own time and uploaded the code to Github. The Schools arent showing because of issue accessing the Beta API. I fixed the code and put in a number of other options. Im not ready to make a pull request on github because Im a bit of an amateur coder. But everything seems to work for me. I have even implemented Cohorts for those people wanting that behaviour. https://github.com/bradnielsen2981/o365-moodle",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, January 19, 2021, 8:40 AM",
          "AuthorName": "Brad Nielsen",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2522606&course=5",
          "role": [
            "Picture of Brad Nielsen"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: SDS sync not working",
          "Text": "Thank you very much, it worked after update.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, January 20, 2021, 5:49 PM",
          "AuthorName": "Mohamed Lotfy",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=3531330&course=5",
          "role": [
            "Picture of Mohamed Lotfy"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 414889,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=414889",
      "NoOfResponses": 12,
      "ResponsesInList": [
        {
          "Title": "Teams-Integration: Can't choose course from Moodle-App",
          "Text": "Hi everyone I'm trying to install moodle server with office 365 integraton in our intranet. Moodle Server is working ( Moodle 3.9.3 (Build: 20201109) ). Office 365 integration ( v3.9.2 2020071504, OpenID Connect v 3.9.2 2020071502) : Users are synced from o365. Groups and teams will be created from new courses.  Login with OpenID Connect is working. My problem is the moodle bot or moodle app: If i try to add the moodle app to a created team i can't choose a course  and the save button is greyed out ( see picture). What I tried so far: - Did install steps from Bot and Settings twice->no change - Find logs, moodle server logs nothing noticeable - Maybe its a firewall issue, that teams can not connect to the moodle server (Intranet). Server is allowed to go to the internet I'm stuck at the moment, I'm grateful for any help. Grettings from Germany Dominik",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/attachment/1672301/moodle.PNG?forcedownload=1"
          ],
          "Time": "Friday, December 4, 2020, 5:22 PM",
          "AuthorName": "Dominik Steiner",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=3915344&course=5",
          "role": [
            "Picture of Dominik Steiner"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Teams-Integration: Can't choose course from Moodle-App",
          "Text": "That looks like it hasn't actually logged into Moodle yet and that is why you can't choose a course. Have you managed to get it to log in yet? Ours was working before I put the patch on just before Christmas and now ours won't log in. Is yours logging in? Regards Heather",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, January 6, 2021, 9:10 PM",
          "AuthorName": "Heather P",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=45897&course=5",
          "role": [
            "Picture of Heather P",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Teams-Integration: Can't choose course from Moodle-App",
          "Text": "i Did some changes: - I made the Moodle server acessable from the internet and give him a full FQDN and made some DNS Changes -I reinstalled the office365-Plugin-Part and azure parts At the moment I have the problem, that Moodle plugin im Teams WEB are partially working (Have only 1 sec to choose the course and then it comes to this screen) and over the Desktop Client it does not. I opened a ticket at microsoft. I hope this will help. Regards Dominik",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1677161/image.png"
          ],
          "Time": "Wednesday, January 6, 2021, 9:53 PM",
          "AuthorName": "Dominik Steiner",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=3915344&course=5",
          "role": [
            "Picture of Dominik Steiner"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Teams-Integration: Can't choose course from Moodle-App",
          "Text": "Yep I have this exact same problem.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, January 8, 2021, 5:01 PM",
          "AuthorName": "Brad Nielsen",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2522606&course=5",
          "role": [
            "Picture of Brad Nielsen"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Teams-Integration: Can't choose course from Moodle-App",
          "Text": "A colleague got ours working, but I don't know what they did - I'm told it is the Azure end of it that was the problem, not the Moodle end of it. I know that isn't much help, but it will give you a clue where to look. I will try to find out what they did to it. Regards",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, January 11, 2021, 4:51 PM",
          "AuthorName": "Heather P",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=45897&course=5",
          "role": [
            "Picture of Heather P",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Teams-Integration: Can't choose course from Moodle-App",
          "Text": "Hi Heather That a good news. Thanks for your help so far. Regards Dominik",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, January 11, 2021, 10:38 PM",
          "AuthorName": "Dominik Steiner",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=3915344&course=5",
          "role": [
            "Picture of Dominik Steiner"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Teams-Integration: Can't choose course from Moodle-App",
          "Text": "Heather, if you could ask your colleague what they did? - im tearing my hair out now. I feel like the settings are correct but there must be something, Im missing. kind regards, Brad",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, January 12, 2021, 9:44 PM",
          "AuthorName": "Brad Nielsen",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2522606&course=5",
          "role": [
            "Picture of Brad Nielsen"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Teams-Integration: Can't choose course from Moodle-App",
          "Text": "Hi I have spoken to my colleague in the process of documenting in case of future need and this is over my head, but in the Azure end we needed to set up a particular URL for the application ID URL. What it should be, is listed in the manifest.json file that forms the core of the teams app. Hopefully that can get you moving in the right direction. Regards Heather",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, January 14, 2021, 5:37 PM",
          "AuthorName": "Heather P",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=45897&course=5",
          "role": [
            "Picture of Heather P",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Teams-Integration: Can't choose course from Moodle-App",
          "Text": "Hi, Please double check if you have updated the Azure application (created with the powershell script) with the latest settings, they need to be done manually while the powershell script is not updated: https://github.com/microsoft/o365-moodle/issues/1487#issuecomment-760119077 Regards",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, January 14, 2021, 6:54 PM",
          "AuthorName": "Oswaldo Rojas",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2007915&course=5",
          "role": [
            "Picture of Oswaldo Rojas"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Teams-Integration: Can't choose course from Moodle-App",
          "Text": "Were you able to make it work? I've followed the instructions carefully and I have the same behavior as OP . The URL found in the manifest.json is the same as the one in my \"Exposed API\".. Unless it isn't the one that is referred to.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, January 19, 2021, 5:16 AM",
          "AuthorName": "Alexandre Lusignan",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=3482233&course=5",
          "role": [
            "Picture of Alexandre Lusignan"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Teams-Integration: Can't choose course from Moodle-App",
          "Text": "For me it worked partially. I followed all the steps, URL in exposed-API  and Json-file of the teams app is the same. Teams-Web-App is working without problems. Teams desktop app is not. Here i have no course to choose as before. If i install the app with webapp in desktop app the tab is emtpy. I tried from different locations so i can exclude the firewall as point of failure. Any other ideas? Thanks for all of your help so far. Regards Dominik",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, January 19, 2021, 5:20 PM",
          "AuthorName": "Dominik Steiner",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=3915344&course=5",
          "role": [
            "Picture of Dominik Steiner"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Teams-Integration: Can't choose course from Moodle-App",
          "Text": "Hi That implies you are managing to log in. It will only display courses where you are the teacher on the course in Moodle, so if you are using an admin account in Moodle where you haven't specifically made yourself a teacher on the course it won't show you anything. Make your account a teacher on one or more courses and see if it shows up then.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, January 20, 2021, 4:41 PM",
          "AuthorName": "Heather P",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=45897&course=5",
          "role": [
            "Picture of Heather P",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 416463,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=416463",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Groups in Moodle creates a new SharePoint site",
          "Text": "Hi, When a user joins a group within a Moodle course, a SharePoint group an site automatically gets created for that Moodle group. Is there anyway to stop this from happening? What is even more surprising is that this is happening on Moodle courses where I haven't selected for Teams creation! Moodle 3.9, Microsoft Office 365 Integration 3.9.1 I think it is coming from the scheduled task Create user groups in Office 365 \\local_o365\\task\\groupcreate. But this also controls Team creation from selected Moodle courses. Anyone have any ideas?",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.yeovil.ac.uk/theme/image.php/boost/core/1604393695/spacer",
            "https://moodle.yeovil.ac.uk/theme/image.php/boost/core/1604393695/spacer"
          ],
          "Time": "Monday, January 11, 2021, 8:32 PM",
          "AuthorName": "Chris Canning",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1822379&course=5",
          "role": [
            "Picture of Chris Canning"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 415895,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=415895",
      "NoOfResponses": 2,
      "ResponsesInList": [
        {
          "Title": "Creation of cohorts based on Azure AD with school data sync preview?",
          "Text": "Does anyone has experiences with the creation of cohorts in Moodle  based on Azure AD and school data sync preview? The School Data Sync is becoming a better tool for creation of educational groups in Microsoft 365, and the microsoft 365 plugin now facilitates well the creation of teams based on cohorts/courses in Moodle. But it's becoming more and more interesting to have the source for groups (organisational and educational) in Microsoft 365 and let apps plugin to School Data Sync api. So is there anyone who has succeeded in creating cohorts based on the School Data Sync structure, so  the education groups in MS 365, Azure AD are primary source and then used to create also the groupstruture an enrollment of students and teachers into it within Moodle? And so the question, is it working, how well?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, December 28, 2020, 7:14 PM",
          "AuthorName": "Remko den Besten",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=3960737&course=5",
          "role": [
            "Picture of Remko den Besten"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Creation of cohorts based on Azure AD with school data sync preview?",
          "Text": "Remko, I'm editing the School Data Sync code now just for a bit of fun - it wasnt working at first because Microsoft change their key fields from 'objectid' to 'id'. I also decided to make it also able to create cohorts. At this point, is working without enrolling students in their cohorts, but Im getting there..so hopefully in a few days I should be completed. regards, Brad",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, January 8, 2021, 5:05 PM",
          "AuthorName": "Brad Nielsen",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2522606&course=5",
          "role": [
            "Picture of Brad Nielsen"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 414312,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=414312",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Sync Settings -> Teams Customization",
          "Text": "Dear team, 1. I need select courses to sync  by CATEGORY on: /local/o365/acp.php?mode=usergroupcustom 2. When course is set as archive sync to MS Temas should be off. Couid You be able to develop this 2 new futures? regards Marcin",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, November 23, 2020, 6:55 PM",
          "AuthorName": "Marcin Misiak",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2094309&course=5",
          "role": [
            "Picture of Marcin Misiak"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 411681,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=411681",
      "NoOfResponses": 7,
      "ResponsesInList": [
        {
          "Title": "Manual authentication is not working",
          "Text": "dear moodle team we are using moodle 3.9 and i have integrated the Moodle with the team using the O365. we have connected this pluggin with Azure directory. before we used to enroll the students throguh CSV file but right now we are not able to enroll the students throught CSV.  we used to write the username, password, first name, lastname, email, course1 123, 123! , abc, xyz , abc@office.com,M1 like that but now it required username in terms of email. by using the email i have enrolled the students in different courses through csv. OpenID Connect is working fine for the students but login and password boxes are not working to login. anyone tell me what i will do to work both, Oidc & manual authentication?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, October 5, 2020, 7:17 PM",
          "AuthorName": "Abu Ali",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2053906&course=5",
          "role": [
            "Picture of Abu Ali"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Manual authentication is not working",
          "Text": "HI I have similar issue where I am unable to login as Manual admin user that I have setup during Moodle installation and now only Office 365 users are allowed login but none of the Office 365 users are admin and atleast one user do not have access to Site Administration in Moodle. Any suggestions on how can i can the login method so that both manual and OpenID login methods work ? Thank you on advance",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, November 2, 2020, 1:45 AM",
          "AuthorName": "Susmitha Nori",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=3762275&course=5",
          "role": [
            "Picture of Susmitha Nori"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Manual authentication is not working",
          "Text": "Assuming that you remember the admin's password, load such a URL into the browser: [your_moodle_address]/login/index.php?username=admin On the login page you will also be able to change that login to anything else, and use that account's password. Manual authentication cannot be blocked in Moodle, and you should always be able to use the above method to log into a manual account.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, November 2, 2020, 6:19 PM",
          "AuthorName": "Przemek Kaszubski",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=109067&course=5",
          "role": [
            "Picture of Przemek Kaszubski",
            "Picture of Particularly helpful Moodlers",
            "Picture of Testers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Manual authentication is not working",
          "Text": "HI Thank you so much for responding. I do know the admin password definitely. But I get redirected to the below link automatically when I change the URL to as suggested above. https://login.microsoftonline.com/common/oauth2/authorize?response_type=code& ;..... I am avoiding to copy complete URL for security reasons but I get automatically redirected to authenticate with Office365 account. Any php files need to changed or updated for this redirection ? Thank you for helping out.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, November 2, 2020, 7:26 PM",
          "AuthorName": "Susmitha Nori",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=3762275&course=5",
          "role": [
            "Picture of Susmitha Nori"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Manual authentication is not working",
          "Text": "Tough one. The only thing I can think of is direct database access to your Moodle and making sure that you don't have alternateloginurl specified. I don't have a running 365 authentication Moodle instance to inspect any deeper, sorry.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, November 3, 2020, 7:09 PM",
          "AuthorName": "Przemek Kaszubski",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=109067&course=5",
          "role": [
            "Picture of Przemek Kaszubski",
            "Picture of Particularly helpful Moodlers",
            "Picture of Testers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Manual authentication is not working",
          "Text": "HI Przemek Thank so much for help you are providing. I do not see any alternateloginurl in my DB tables Instead can you please suggest me if there is a way to make any user full admin for Moodle site from backend like DB or config files etc. IF i can make atleast one o365 user as full admin from backend that can help me presume. Thanks again",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, November 10, 2020, 1:37 AM",
          "AuthorName": "Susmitha Nori",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=3762275&course=5",
          "role": [
            "Picture of Susmitha Nori"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Manual authentication is not working",
          "Text": "Take my reply with CAUTION. Maybe you'll want to ask this question on the general Moodle Help forum, or failing that in the \"General developer forum\" - you'll find links on https://moodle.org/course/view.php?id=5 . Or search site:moodle.org your_query_here on google. Here's what I found, although I have NOT tested, I have just observed the DB settings as they changed after I added another admin from the admin GUI: If you have DB access, then in table mdl_config there is a field \"siteadmins\". Here, using a comma as delimiter (without any spacing), you can add the user id for another admin. Do not delete the first value (most likely \"2\") - this is the id of the main administrator set when Moodle was first installed. Cf. my PHPMyAdmin screenshot (in Polish). You need to know that user id that you want to add - these you should be able to review in the mdl_user table. Or else choose the id of the user you can log in as - that corresponds to a working o365 account / authentication, and use that. Or else maybe the table mdl_auth_oauth2_linked_login will help. Again. I have NOT tested this procedure... I don't think you can break anything this way, but I want to be honest. HTH . Przemek",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/attachment/1667838/2020-11-11%20%2C%2014_29_06%20-%20pktest.amu.edu.pl%20_%20localhost%20_%20moodle%20_%20mdl_config%20_%20phpMyAdmin%205.0.2%20-%20Mozilla%20Firefox.png?forcedownload=1"
          ],
          "Time": "Wednesday, November 11, 2020, 10:06 PM",
          "AuthorName": "Przemek Kaszubski",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=109067&course=5",
          "role": [
            "Picture of Przemek Kaszubski",
            "Picture of Particularly helpful Moodlers",
            "Picture of Testers"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 410203,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=410203",
      "NoOfResponses": 3,
      "ResponsesInList": [
        {
          "Title": "OpenId Connect Error",
          "Text": "Hi, Moodle Version 3.8 After an architecture update to our Moodle Enviroment, we get this error with the OpenIdConnect Integration. We upgrade our arquitecture to use: Redis, AWS EFS, AWS Loadbalancer, Gluster FS and 2 moodle instance Debug info: Error code: erroroidccall ×Stack trace: line 47 of /auth/oidc/classes/utils.php: moodle_exception thrown line 252 of /auth/oidc/classes/oidcclient.php: call to auth_oidc\\utils::process_json_response() line 206 of /auth/oidc/classes/loginflow/authcode.php: call to auth_oidc\\oidcclient->tokenrequest() line 107 of /auth/oidc/classes/loginflow/authcode.php: call to auth_oidc\\loginflow\\authcode->handleauthresponse() line 105 of /auth/oidc/auth.php: call to auth_oidc\\loginflow\\authcode->handleredirect() line 29 of /auth/oidc/index.php: call to auth_plugin_oidc->handleredirect() No changes were made to the office 365 plugins . Any thought on now to resolve this error",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, September 10, 2020, 10:37 AM",
          "AuthorName": "Alexis Boza",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2457418&course=5",
          "role": [
            "Picture of Alexis Boza"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: OpenId Connect Error",
          "Text": "We've just migrated our Moodle site to a new Ubuntu 20.04.1 LTS server and were getting the same errors as you when trying to sign in using the OpenID Connect authentication method. After doing some investigation we found that the OpenID Connect authentication had somehow been turned off during the migration process. After switching it back on everything started working as normal.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, November 5, 2020, 10:24 PM",
          "AuthorName": "Ross Lovell",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2044051&course=5",
          "role": [
            "Picture of Ross Lovell"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: OpenId Connect Error",
          "Text": "Hi Ross, In our case we change our AWS EFS, and now we are using NFS system. Seems AWS EFS is too slow to handle OpenId token request for sessions.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, November 5, 2020, 11:16 PM",
          "AuthorName": "Alexis Boza",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2457418&course=5",
          "role": [
            "Picture of Alexis Boza"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 413205,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=413205",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Provide Admin Consent failed, looping ask login",
          "Text": "Hello Moodle teams! I'm trying integrate Moodle and Microsoft teams, I follow the steps in https://docs.moodle.org/38/en/Office365 , when follow \"Configure the Office 365 support plugin\" and Click provide admin consent button, the page going to Microsoft login page, and I enter my account and password to login, the page will direct to the login page again, no matter how many times I login, it just loop there. The account I login is the same as the account I set Moodle application in Microsoft AD. Is these any suggestion for this problem? Thanks. My moodle version is 3.8.5+ (Build: 20201006), my site address is use ip for url not domain name.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, November 3, 2020, 10:53 AM",
          "AuthorName": "cw k",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2578428&course=5",
          "role": [
            "Picture of cw k"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 412292,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=412292",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Error Login Office365",
          "Text": "When I click the Office button in the login form to login with office account i get the following error: Argument 1 passed to core\\session\\manager::login_user() must be an instance of stdClass, boolean given, called in [ dirroot ]/lib/moodlelib.php on line 4672 The integration works. It synced the users from Azure over night. the url looks like: mymoodleurl/auth/oidc/",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, October 16, 2020, 12:36 AM",
          "AuthorName": "Jose Pires",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=3749612&course=5",
          "role": [
            "Picture of Jose Pires"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 411536,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=411536",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Office 365 (teams) integration without migrating auhtication method for users",
          "Text": "Hello everybody, I'm actually considering an office 365 and teams integration with Moodle. We are using active directory for authenticating users.  My uderstanding is that users has to be logged via OpenID Connect to his Office365 account to be able to have a full integration with Office365 / Teams. I saw that there is a script to change the authenticating method of existing user matching his username in Azure but we are not quite ready to change the authentication methos of all our users to openid Connect. This is would be a too heavy change for our users. I understand that tere is a possibility for a user to link his actual moodle account with hos office365 one. But this I would want to avoid too because this is complex. So my question is what feature of Moodle teams integration do actually need the user to be logged via OpenID Connet or having his moodle account linked to his Office365 one? Reading all the documentation I could and a little bit of the plugin code,,  here is my present uderstanding : -  The moodle course synchronization to teams does not need users to be connected with his office365. It just needs the opeindc plugin to be configured and the link between Moodle and Azure to be established - The moodle tab inside teams. I'm not sure but here I thing that the user has to have an openIDC acount to use it. Or is it a simple iframe? - Notifications of moodle course to teams. This is done by the moodle bot (if i'm right) but I d'ont know if users have to have an openidc moodle account Do I forgot some features of moodle teams integration? I'm a little lost here and I can't test this integration by now. If someone could clarify for me which features do we lost if our users log in with manual auth. Thank you very much in advance. Best regards. Noel",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, October 2, 2020, 6:37 PM",
          "AuthorName": "Noel Dieschburg",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=860574&course=5",
          "role": [
            "Picture of Noel Dieschburg"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 404070,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=404070",
      "NoOfResponses": 2,
      "ResponsesInList": [
        {
          "Title": "No schools available in school data sync",
          "Text": "For some reason I don't see any schools available in School Data Sync. I do on our Production Server , but not on our Staging Server. They are both connected to our Office 365 environment, and there is an Registered App set up for both. What am I doing wrong? Do you need to do anything within School Data Sync to make it available?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, May 26, 2020, 2:34 PM",
          "AuthorName": "Brad Nielsen",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2522606&course=5",
          "role": [
            "Picture of Brad Nielsen"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: No schools available in school data sync",
          "Text": "do you find answer?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, October 1, 2020, 3:42 PM",
          "AuthorName": "Mohamed Lotfy",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=3531330&course=5",
          "role": [
            "Picture of Mohamed Lotfy"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 405828,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=405828",
      "NoOfResponses": 6,
      "ResponsesInList": [
        {
          "Title": "Create Teams meeting - 404 error",
          "Text": "When creating a Teams Meeting from Moodle (using Chrome) I can set the time and date however I then get a 404 error displayed when I click Create. The link generated is correct and works however it isn't ideal seeing the error. Any ideas? Thanks Andrew",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/attachment/1638096/teams%20error.png?forcedownload=1"
          ],
          "Time": "Tuesday, June 23, 2020, 6:54 PM",
          "AuthorName": "Andrew Senior",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=167585&course=5",
          "role": [
            "Picture of Andrew Senior"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Create Teams meeting - 404 error",
          "Text": "We are running v3.8.2 and I'm still experiencing this issue. Has anyone else come across this problem? I believe I have configured everything correctly. Thanks",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, July 3, 2020, 7:09 PM",
          "AuthorName": "Andrew Senior",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=167585&course=5",
          "role": [
            "Picture of Andrew Senior"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Create Teams meeting - 404 error",
          "Text": "Hi I have the same issue, Somebody fix it?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, July 16, 2020, 3:12 AM",
          "AuthorName": "Sergio Rossetti",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=435300&course=5",
          "role": [
            "Picture of Sergio Rossetti"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Create Teams meeting - 404 error",
          "Text": "I've upgraded to 3.9 and the issue still remains? Has anybody found a fix? Thanks",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, September 8, 2020, 4:55 AM",
          "AuthorName": "Andrew Senior",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=167585&course=5",
          "role": [
            "Picture of Andrew Senior"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Create Teams meeting - 404 error",
          "Text": "Hi I have the same issue, any one fix it?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, October 1, 2020, 1:15 AM",
          "AuthorName": "eman ali",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2370405&course=5",
          "role": [
            "Picture of eman ali"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Create Teams meeting - 404 error",
          "Text": "Sorry, we are still getting the above error message. I'm not sure what else to check or change?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, October 1, 2020, 3:59 AM",
          "AuthorName": "Andrew Senior",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=167585&course=5",
          "role": [
            "Picture of Andrew Senior"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 409651,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=409651",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "how to sync a parto of moodle course",
          "Text": "Hello, I have a moodle installation with about 5000 courses. Each year we create about 400 courses for the current accademic year. We want use integration with teams to create a team for each course. But we want sync only new courses and not for all. How can I do That? Some of old courses have an own teams without sync. I  can't use \"All Features Enabled\" option because I want sync only a part of course. In \"Custom\" option I need to manually select the course that I want sync. I want automatize the process Any tips? Thanks Roberto",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, August 31, 2020, 11:25 PM",
          "AuthorName": "Roberto Nicola Pascale",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=3506837&course=5",
          "role": [
            "Picture of Roberto Nicola Pascale"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 406352,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=406352",
      "NoOfResponses": 3,
      "ResponsesInList": [
        {
          "Title": "Office365_local — Troubleshooting User Sync",
          "Text": "I'm trying to get a sub-set of our users synced from Azure AD to Moodle using the local_o365 plugin's sync feature. I have enabled logging in the advanced tab, enabled user sync, and configured the \"User Creation Restriction\" to match against the Job Title field in AAD using the following as a regular expression: \n```text\nMU|Affiliate|student|SPCMStaff|SPCMStudent\n```\n My intention is that accounts be craeted for any user that has the job title \"MU\" or \"Affiliate\" or \"student\" ... I have ticked the following checkboxes: Create accounts in Moodle for users in Azure AD Update all accounts in Moodle for users in Azure AD Switch matched users to Office 365 (OpenID Connect) authentication Assign users to application during sync Sync Office 365 profile photos to Moodle in cron job Sync Office 365 profile photos to Moodle on login Perform a full sync each run The Azure sync cron task is running, and there are no error messages being logged, but, the users are not being created! How do I get more insight into what the plugin is doing? Have I simply made a mistake in my RE syntax?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, July 2, 2020, 12:45 AM",
          "AuthorName": "Bart Busschots",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=624500&course=5",
          "role": [
            "Picture of Bart Busschots"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Office365_local — Troubleshooting User Sync",
          "Text": "I've simplified my config to the bare minimum, not attempting to sync photos anymore, and not attempting to filter user creation anymore. A full sync of our literally tens of thousands of AAD users results in just 169 users in Moodle, and less than 150 cryptic errors in the Moodle log: \n```text\nlocal_o365\\oauth2\\token::instance \nlocal_o365\\oauth2\\token::get_for_new_resource:234: Cannot retrieve a \ntoken for the base resource. Data: (null)\n```\n On the connection page there is also one strange issue as shown in the screenshot below:",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1640391/Screenshot%202020-07-02%20at%2012.36.21.png"
          ],
          "Time": "Thursday, July 2, 2020, 7:39 PM",
          "AuthorName": "Bart Busschots",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=624500&course=5",
          "role": [
            "Picture of Bart Busschots"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Office365_local — Troubleshooting User Sync",
          "Text": "Hi Your screen shot is that a Moodle screen shot or an Azure one? I can't find anything like that in my Moodle, I'm on a 3.8.4 Moodle and can't get any users to sync which is really, really frustrating.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, August 27, 2020, 5:19 PM",
          "AuthorName": "Heather P",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=45897&course=5",
          "role": [
            "Picture of Heather P",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 408517,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=408517",
      "NoOfResponses": 3,
      "ResponsesInList": [
        {
          "Title": "Changing authentication",
          "Text": "Hi we have existing learners in our Moodle 3.8. We use LDAP . We are adding in the MS Teams integration to our MKoodle. There i s guidance on this page https://docs.moodle.org/38/en/Office365#Switching_existing_Moodle_users_to_use_Office_365_to_log_in about switching existing users to office 365 login. This is quite convoluted and requires the learners to go to a block and do all sorts of things. Is there any reason an admin can't just go to manage users and switch the log in method from LDAP to the open id? Will I fundamentally break something if I do that? We want all users who currently use LDAP as the login method to switch to openid. Switch one off and turn the other on. Basically does the account have to migrate or can I just switch it? Thank you. Heather",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, August 10, 2020, 5:58 PM",
          "AuthorName": "Heather P",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=45897&course=5",
          "role": [
            "Picture of Heather P",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Changing authentication",
          "Text": "You probably need to use \"User matching\" (cf. https://docs.moodle.org/38/en/Office365#User_Matching ) to match existing LDAP accounts with corresponding Office 365 accounts and change the login method to OpenID. You have to create a once-off CSV file listing the current users.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, August 10, 2020, 11:38 PM",
          "AuthorName": "Eoin Campbell",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=726938&course=5",
          "role": [
            "Picture of Eoin Campbell",
            "Picture of Core developers",
            "Picture of Plugin developers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Changing authentication",
          "Text": "Hi I think we must be doing this all wrong. I can get the CSV in there and make the cron run to force a sync but it doesn't happen. The people just sit in a queue forever. The users never sync. I'm also slightly confused by the instructions - should I have done a bulk update on my users first to make their accounts open id and change their username and then do the user matching or will the usermatching if it ever works do everything? I have actually tried it both ways - updating a user and then tried the sync thing, and also not updating the user and trying the sync. The sync just doesn't happen. I've even tried a manual match on the sync page and that just tells me to log in with the Moodle user first which I can't because I've changed it. Basically I'm beginning to think this won't work unless the user goes to the Microsoft block and does half of it for themselves which is a bit over complex for my learners. Is it possible to do without the user going to the Microsoft block?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, August 27, 2020, 4:31 PM",
          "AuthorName": "Heather P",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=45897&course=5",
          "role": [
            "Picture of Heather P",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 408964,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=408964",
      "NoOfResponses": 2,
      "ResponsesInList": [
        {
          "Title": "Moodle to Teams courses synchronization limit",
          "Text": "Hi, Does anyone have experience with moodle to teams course synchronization? I tried to sync 200 courses into teams. When cron starts, 5 courses are\nsynchronized and then stops. The next time cron starts, it will also\nonly sync 5 courses to teams. Why does the plugin only sync 5 courses\neach time? I want to sync more than 10,000 courses into teams. (Moodle 3.9.1 with Microsoft Office 365 Integration 3.9.0 - 2020071500) The o365 task log attached! \n```text\n\n```\n Regards, Bayao",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, August 19, 2020, 3:13 AM",
          "AuthorName": "Balázs Priol",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=3432017&course=5",
          "role": [
            "Picture of Balázs Priol"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Moodle to Teams courses synchronization limit",
          "Text": "I am interested how you do this synchronisation? What tools or plugins are you using?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, August 26, 2020, 4:53 PM",
          "AuthorName": "Gus Hagelberg",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1294597&course=5",
          "role": [
            "Picture of Gus Hagelberg"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 407973,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=407973",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "How to Customize Teams/Sharepoint Message from Moodle o365",
          "Text": "Dear Team, How can I customize the content of this mail. I will love to change the content and provide more instruction to users.",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1646257/Youve%20joined%20the%20WORKPLACE%20SAFETY%20-%20ACTIVE%20SHOOTER%20group_Page_3.jpg"
          ],
          "Time": "Thursday, July 30, 2020, 1:16 PM",
          "AuthorName": "Showemimo Adebare",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1900217&course=5",
          "role": [
            "Picture of Showemimo Adebare"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 396406,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=396406",
      "NoOfResponses": 2,
      "ResponsesInList": [
        {
          "Title": "Multiple Moodle environments single azure tenant",
          "Text": "Hi Guys Having an issue when a user has been linked between our moodle development environment and then they try to link the same user in the moodle test environment they get an error saying the office 365 user is already connected to a moodle user. I know the integration support multi azure tenants but can it support the other way around? Thanks",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, January 30, 2020, 10:44 AM",
          "AuthorName": "Ross Hart",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2697584&course=5",
          "role": [
            "Picture of Ross Hart"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Multiple Moodle environments single azure tenant",
          "Text": "Hid, did you figure it out by now? I might not be able to avoid such a scenario, and would love to know if it is at all possible to use the Office 365 set of plugins and Teams integration connected to one Azure tenant with **multiple** Moodle instances? Or does it have to be a 1-to-1 arrangement... Regards.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Sunday, July 19, 2020, 6:10 PM",
          "AuthorName": "Przemek Kaszubski",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=109067&course=5",
          "role": [
            "Picture of Przemek Kaszubski",
            "Picture of Particularly helpful Moodlers",
            "Picture of Testers"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 406312,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=406312",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Moodle App not appearing in Teams",
          "Text": "We have set up the Office 365 Integration in our Moodle (3.7.5+) and the connection to Office 365 tools works, as does the course/team and user synchronisation but the Moodle app does not appear in the teams created from the Moodle courses.  The only error we can see on the Moodle side is local_o365\\rest\\notebook::create_class_notebook:84: Error response received. Data: Array ( [code] => 40001 [message] => The request does not contain a valid authentication token Does anybody have any ideas as to where we might have gone wrong. Denis",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, July 1, 2020, 4:30 PM",
          "AuthorName": "Denis Featherstone",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=423716&course=5",
          "role": [
            "Picture of Denis Featherstone"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 406301,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=406301",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Atto Teams Meeting Plugin",
          "Text": "I have successfully installed the Plugin - love it but now have a huge problem.  My login to Teams has changed and I have a new username and password.  (I administer Teams as a sole tutor using Moodle as a platform). The plugin keeps wanting to go to the old login and I cannot find any way of changing the login.  I tried to uninstall and reinstall but that didn't happen - I received a \"this plugin cannot be uninstalled\" message. HELP!!!  How can I reset the 365 Teams login?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, July 1, 2020, 2:27 PM",
          "AuthorName": "Chris Sutton",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=347498&course=5",
          "role": [
            "Picture of Chris Sutton"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 405470,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=405470",
      "NoOfResponses": 2,
      "ResponsesInList": [
        {
          "Title": "Moodle Teams Integration throu Atto - Blank Screen",
          "Text": "Hi, After obtaining Office 365 license for our domain , we  have installed the \"moodle-atto_teamsmeeting\" plugin on our Moodle 3.8.3 using the simple instructions on the page below; https://github.com/enovation/moodle-atto_teamsmeeting We login to Office 365 and then try to create a link on the Announcements page of a course , but receive a blank screen after pressing the \"Teams Meating\" link. Is there something we are missing ? Is there anything we need to do on the Office.com site ? Any Azure/AD configuration ? Regards.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, June 17, 2020, 4:21 AM",
          "AuthorName": "mscag mscag",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2369238&course=5",
          "role": [
            "Picture of mscag mscag"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Moodle Teams Integration throu Atto - Blank Screen",
          "Text": "The problem was the browser ( IE 11). Solved by switching to up-to-date Firefox .",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, June 22, 2020, 5:22 PM",
          "AuthorName": "mscag mscag",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2369238&course=5",
          "role": [
            "Picture of mscag mscag"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 398197,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=398197",
      "NoOfResponses": 3,
      "ResponsesInList": [
        {
          "Title": "Moodle Teams Integration",
          "Text": "Hi All, We have recently installed the O365 Moodle plugin. Authentication and user synchronization is working as is the O365 block. However, we would like it to automatically create O365 Groups and Teams - has anyone been able to successfully do this? :SH Moodle Version 3.8.2",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, March 12, 2020, 5:38 AM",
          "AuthorName": "Shane Hall",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2492031&course=5",
          "role": [
            "Picture of Shane Hall"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Moodle Teams Integration",
          "Text": "Hello Shane! We are tryng hard to lnstall the O365 Moodle plugin and the authentication users synchronization, but until now it's not working. https://moodle.apvm.net/ Can you please help us? Thanks in advance!",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/theme/image.php/moodleorg/core/1763488129/s/sad"
          ],
          "Time": "Thursday, April 9, 2020, 11:19 PM",
          "AuthorName": "artur santos",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=64352&course=5",
          "role": [
            "Picture of artur santos"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Moodle Teams Integration",
          "Text": "Hi Shane I also have the integration mostly working but have some issues. Most notably when setting up the local/office365 plugin, I cannot get \"application access\" to work (it just says it can't get a token anytime something tries to run) and need to use a system API user in Azure.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Saturday, June 13, 2020, 1:17 AM",
          "AuthorName": "Ben Kahn",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1843974&course=5",
          "role": [
            "Picture of Ben Kahn"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 404277,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=404277",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "office 365 integration error",
          "Text": "Hi Everyone. i am trying to integrate office 365 to Moodle. Have installed all the right plugins, while integration am encountering error. when i execute power shell script 'Moodle-AzureAD-Script' i get an error 'Set-AzureADApplicationLogo : Error occurred while executing SetApplicationMainLogo Code: Request_ResourceNotFound Message: Resource '20e6d38b-ef82-4c7b-86e0-69126d94a52d' does not exist or one of its queried reference-property objects are not present. RequestId: de86ae37-2c50-4ca0-a870-f85ee64fa0dd DateTimeStamp: Thu, 28 May 2020 13:17:11 GMT HttpStatusCode: NotFound HttpStatusDescription: Not Found HttpResponseStatus: Completed At C:\\Users\\username\\Desktop\\Moodle-AzureAD-Powershell\\Moodle-AzureAD-Powershell\\Moodle-AzureAD-Script.ps1:91 char:1 + Set-AzureADApplicationLogo -ObjectId $appVars.ObjectId -FilePath $img ... + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ + CategoryInfo          : NotSpecified: ( [Set-AzureADApplicationLogo], ApiException + FullyQualifiedErrorId : Microsoft.Open.AzureAD16.Client.ApiException,Microsoft.Open.AzureAD16.Graph.PowerShell.C ustom.Cmdlet.SetApplicationMainLogoCustom The script returns the client id and secret key, i still went ahead and added the key in plugins- local plugins-micorsoft office 365 integration, knowing it will return and error and it did while i try to 'provide admin consent'. It returns an error code 'Exception - Call to undefined method auth_oidc\\oidcclient::use_chinese_api()'. Then i tried to add the app in azure manually it still returned the same error, i have thoroughly checked all the api permissions and done more than couple of times,  clicking on office 365 returns the 'Exception - Call to undefined method.auth_oidc\\oidcclient::use_chinese_api()'. We have azure subscription 1, office 365 A3 and ssl configured. i have raised the query in github as well no one has responded yet. Kindly help me with this issue, i am not able to find a solution.",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/theme/image.php/moodleorg/core/1589221463/s/smiley"
          ],
          "Time": "Thursday, May 28, 2020, 11:13 PM",
          "AuthorName": "Raki Dey",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=3083469&course=5",
          "role": [
            "Picture of Raki Dey"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 397845,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=397845",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Hide Office 365 option",
          "Text": "Hi guys, I want to hide the option \"Use your Office 365 ...to log in to Moodle\" I cannot find the layout of this page. Would anyone show me the path to this layout pls. Thanks !!",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1604596/O365.PNG"
          ],
          "Time": "Wednesday, March 4, 2020, 6:09 PM",
          "AuthorName": "Khanh Nguyen",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2919470&course=5",
          "role": [
            "Picture of Khanh Nguyen"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 397260,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=397260",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Office 365 Sync multiple tenant",
          "Text": "Hi. Recently i integrated another tenant in my moodle site. but, the users who are an assignation on my moodle application, dosn´t appear like a moodle´s user, they can connect to the site, but are rejected by not matched with anyone moodle account. The cron task is already operating, but new users dosn´t appear. Best regards Moodle versión: Moodle 3.7.2+ (Build: 20190920)",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, February 19, 2020, 9:34 PM",
          "AuthorName": "Alejandro Brude",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2741361&course=5",
          "role": [
            "Picture of Alejandro Brude"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 396381,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=396381",
      "NoOfResponses": 2,
      "ResponsesInList": [
        {
          "Title": "Important notice - immediate action required if your site uses Moodle and Microsoft Teams integration",
          "Text": "The stable release of the Google Chrome web browser (build 80, scheduled for release on February 4, 2020) features a change in how cookies are handled. This will include two changes: Cookies without a '''SameSite''' attribute will be treated as SameSite=Lax. Cookies with '''SameSite=None''' must also specify '''Secure''', meaning they require a secure context . The changes are explained in https://web.dev/samesite-cookies-explained and https://blog.chromium.org/2019/10/developers-get-ready-for-new.html . Moodle and Microsoft Teams integration will be affected by this change, because the integration requires embedding Moodle pages in Teams. There is an open item in Moodle Tracker about this change in broader context at https://tracker.moodle.org/browse/MDL-67175 , but the code change proposed in the tracker item didn't get integrated in time for the last minor Moodle upgrade before Chrome 80 release date. As a result, all sites using Moodle and Microsoft Teams integration feature are strongly suggested to apply the patches proposed in the tracker item so that users with Chrome 80 can keep using Moodle tabs in Teams after upgrade. Patches are provided for all Moodle versions that are supported for core feature and security issues, i.e. 3.5, 3.6, 3.7 and 3.8. Patches are only required before this is integrated into the next Moodle minor release of the Moodle versions, which is scheduled at March 9th, 2020. After the next Moodle minor release, the patch should be removed as it would be integration into core Moodle code.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, January 29, 2020, 11:10 PM",
          "AuthorName": "Lai Wei",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1265206&course=5",
          "role": [
            "Picture of Lai Wei"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Important notice - immediate action required if your site uses Moodle and Microsoft Teams integration",
          "Text": "The patch in https://tracker.moodle.org/browse/MDL-67175 is still not final. But are you using it as is? Would Moodle do an out of band release version with the patch?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, January 30, 2020, 2:41 AM",
          "AuthorName": "Rex Lorenzo",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=760981&course=5",
          "role": [
            "Picture of Rex Lorenzo"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 396304,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=396304",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "OAuth not Overwriting User Profile",
          "Text": "Hi there, When users log in using OAuth, we would like the users first name and last name to be updated. Looking at this older documentation (we're running 3.7), there is a setting whereby user fields can update on every login. https://docs.moodle.org/2x/pl/Managing_authentication#Profile_fields_data_mapping_and_locking ...but I can't find any settings that refer to ' on every login ' in the admin settings. ...could this be because the first names / last names are locked under OAuth in the authentication settings? If they need to be unlocked, how do you stop users from editing their first and last name? Thanks for your help! Scott",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, January 28, 2020, 7:12 PM",
          "AuthorName": "Scott Redrup",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2541721&course=5",
          "role": [
            "Picture of Scott Redrup"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 387218,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=387218",
      "NoOfResponses": 5,
      "ResponsesInList": [
        {
          "Title": "Login Works | Microsoft Block - \"Connection Status\"",
          "Text": "Hello all, I have hit a roadblock with my Office365 integration. We have the login fully working, the users are matched up and ready to go. The connection status in the user matching admin console reports that the user is connected. The problem is when we view the Microsoft Block it tells us that we are not connected? Going through the steps on 'Connect Office 365' still just brings us back to this status - no errors or logs picked up. Any ideas would be greatly appreciated Thanks",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1561095/Status.PNG",
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1561095/Block.PNG"
          ],
          "Time": "Wednesday, June 12, 2019, 3:50 PM",
          "AuthorName": "A O'Hara",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2310062&course=5",
          "role": [
            "Picture of A O'Hara"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Login Works | Microsoft Block - \"Connection Status\"",
          "Text": "Hi Andrew, We are experiencing the same problem.  We have integrated Moodle with Microsoft Office 365, and we are using OAuth2 for authentication, which works really great!  Then, we added the Microsoft Block, but we are seeing the exact thing you are seeing on the MS Block: \"You are not connected to any Microsoft services.\"  In addition, we are only seeing the few options you have depicted on your included screen capture. Can someone in this community please assist with this issue soonest. Thank you.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, July 16, 2019, 9:36 PM",
          "AuthorName": "Sergio Estridge",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2696009&course=5",
          "role": [
            "Picture of Sergio Estridge"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "This forum post has been removed",
          "Text": "The content of this forum post has been removed and can no longer be accessed.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "N/a",
          "AuthorName": "N/a",
          "AuthorMoodleLink": "N/a",
          "role": [],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Login Works | Microsoft Block - \"Connection Status\"",
          "Text": "I had similar problems and my issue was that I did not have default auth_oidc | oidcresource value in /admin/settings.php?section=authsettingoidc (I was using \"graph.microsoft.com\") The problem with this value is that resource value is hardcoded with \" https://graph.windows.net \" value in many scripts, and then some functions like Microsoft block \"connected\" message did not work. It becomes with database auth_oidc_token.resource inconsistencies. You can check /** * Get the API client's oauth2 resource. *",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Saturday, September 7, 2019, 4:21 AM",
          "AuthorName": "Gabriel Kulevicius",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=125725&course=5",
          "role": [
            "Picture of Gabriel Kulevicius"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Login Works | Microsoft Block - \"Connection Status\"",
          "Text": "I just wanted to thank you for pointing me in the right direction!  Took me WEEKS to figure out how to fix this.  I changed the value returned in azuread.php scrip in the get_resource() function but that didn't fix it. Here is the command I ran that ended up fixing it for me: \n```text\nfor i in $(grep -iRl graph.windows.net moodle/htdocs/* 2>/dev/null); do echo $i; sudo sed -i 's/graph.windows.net/graph.microsoft.com/g' $i; done\n```\n There was a hardcoded value of https://graph.windows.net in the following files: \n```text\nhtdocs/auth/oidc/settings.php\n\n\nhtdocs/auth/oidc/tests/privacy_provider_test.php\n\n\nhtdocs/auth/oidc/classes/oidcclient.php\n\n\nhtdocs/local/o365/tests/sdssync_test.php\n\n\nhtdocs/local/o365/tests/azuread_test.php\n\n\nhtdocs/local/o365/tests/sharepoint_test.php\n\n\nhtdocs/local/o365/tests/coursegroups_test.php\n\n\nhtdocs/local/o365/classes/healthcheck/systemapiuser.php\n\n\nhtdocs/local/o365/classes/feature/usergroups/coursegroups.php\n\n\nhtdocs/local/o365/classes/oauth2/token.php\n\n\nhtdocs/local/o365/classes/rest/sds.php\n\n\nhtdocs/local/o365/classes/rest/azuread.php\n```\n Once I did that, I restarted the httpd, php-fpm, and mysql servers.  Then I logged back in using my Microsoft creds and now it says i'm connected and lists all of the apps I enabled! Again, without finding your post I wouldn't have figured that out so thank you.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, January 21, 2020, 6:27 AM",
          "AuthorName": "Travis Graves",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2742821&course=5",
          "role": [
            "Picture of Travis Graves"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 395367,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=395367",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Language settings do not sync correctly",
          "Text": "We migrated to using Azure AD/Office 365 for employee authentication. One thing that seems to be causing problems is the language settings. We were all previously set to 'en_us,' but now everyone seems to be automatically switched over to 'en.' When looking at the user field mapping for Office 365 integration, it does show that Moodle's language setting should map to the Office 365 language setting. In my case, I have verified that my language settings in Office 365 are set to 'English (United States),' but my Moodle language always reverts to 'en' instead. I've tried manually changing the setting back to 'en_us,' but the next time I log in, it goes back to 'en.' Is this a bug in either Moodle or the Office 365 integration? I'm not sure why the language setting does not seem to be respected. I suppose I could just delete the language mapping, but I'm curious why it's not working.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, January 7, 2020, 11:40 PM",
          "AuthorName": "Brian Schmidt",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2091&course=5",
          "role": [
            "Picture of Brian Schmidt"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 394204,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=394204",
      "NoOfResponses": 4,
      "ResponsesInList": [
        {
          "Title": "Moodle enrol based on Azure AD Groups",
          "Text": "Hi there, has anyone been able to configure Moodle to \"Read\" user membership in Azure AD and based on that membership enrol students in Courses? This can be easily done with LDAP Enrolment plugin.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, December 3, 2019, 8:17 PM",
          "AuthorName": "nikolas stylianides",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1970510&course=5",
          "role": [
            "Picture of nikolas stylianides"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Moodle enrol based on Azure AD Groups",
          "Text": "FWIW, I have requested something similar via the thier GitHub - https://github.com/microsoft/o365-moodle/issues/1178",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, December 13, 2019, 1:04 AM",
          "AuthorName": "Chris Swinney",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=430091&course=5",
          "role": [
            "Picture of Chris Swinney"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Moodle enrol based on Azure AD Groups",
          "Text": "@nikolas, I believe we have achieved what we need to with the use of a couple of plugins (albeit I would still like to see this functionality in the native O365 plugin). * Profile field based cohort membership * Cohort role synchronization The sync fields in the O365 plugins don't give you a lot of options, but for us the \"Company\" field just about does it. We have mapped this to both the \"Institution Name\" and a custom user field, and it is this custom user field that can be used to enrol users into a cohort using the \"Profile field based cohort membership\" plugin. You can then use an enrolment method of a \"Cohort Sync\" in the course, and et voila. As a side option, we also use the \"Cohort role synchronization\" plugin to add a role to the users in the cohort, and this now allows us to show (or hide) course categories to those users.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, December 24, 2019, 3:54 AM",
          "AuthorName": "Chris Swinney",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=430091&course=5",
          "role": [
            "Picture of Chris Swinney"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Moodle enrol based on Azure AD Groups",
          "Text": "@nikolas, I believe we have achieved what we need to with the use of a couple of plugins (albeit I would still like to see this functionality in the native O365 plugin). * Profile field based cohort membership * Cohort role synchronization",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, December 24, 2019, 3:54 AM",
          "AuthorName": "Chris Swinney",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=430091&course=5",
          "role": [
            "Picture of Chris Swinney"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 393115,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=393115",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Azure AD groups synchronization to Moodle",
          "Text": "Hello, I configured Azure Active Directory integration to Moodle (used Microsoft Office 365 integration plug in). It is used to synchronize users from the Azure Active Directory to Moodle. Synchronization works fine, but there is a one downside - this plug in doesn't support AAD groups synchronization. Maybe you know how to synchronize groups from AAD to Moodle? Any advice would be valuable . Thank you",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, November 6, 2019, 1:21 AM",
          "AuthorName": "Mikas Krukauskas",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2779217&course=5",
          "role": [
            "Picture of Mikas Krukauskas"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 393050,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=393050",
      "NoOfResponses": 2,
      "ResponsesInList": [
        {
          "Title": "o365 User Sync OpenID connect without Office 365",
          "Text": "Hi, I read elsewhere that you can use the OpenID connect authentication module provided in the o365 plugin suite to provide authentication to Moodle from Azure AD without needing an office 365 integration set up with Azure AD. Can the user sync in local_o365 also be set up with no Office 365 component also? If not, how does the field mapping work when a user first logs in and it either finds the user has an account or needs to create a new account? Does the plugin look at the response for fields with the same name as the internal user DB fields? Regards ~Eamon Delaney",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, November 4, 2019, 12:57 PM",
          "AuthorName": "Eamon Delaney",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2827500&course=5",
          "role": [
            "Picture of Eamon Delaney"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: o365 User Sync OpenID connect without Office 365",
          "Text": "After reading up on the sync a little further, I may not need it most of it. To clarify what I need when logging in via OIDC: -If user account exists based on username, log in user, IDP sends several fields, (email, firstname, lastname, 1 custom profile field.. etc), if any of these are different, update in the users account in LMS -If user account doesn't exit create it, auto populating several fields (email, firstname, lastname, 1 custom profile text field .. etc) Is this the behaviour of the auth_oidc plugin and if so, how does the field mapping from idp to lms work?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, November 4, 2019, 2:38 PM",
          "AuthorName": "Eamon Delaney",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2827500&course=5",
          "role": [
            "Picture of Eamon Delaney"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 391746,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=391746",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Office 365 Repository vs OneDrive Repository and Accessed Controlled Links",
          "Text": "Question posted in the Repositories forum but relevant here too: https://moodle.org/mod/forum/discuss.php?d=391745",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, October 2, 2019, 2:43 AM",
          "AuthorName": "Ben Kahn",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1843974&course=5",
          "role": [
            "Picture of Ben Kahn"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 391687,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=391687",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Moodle on Plesk",
          "Text": "has any one got a idea how i can run the task on a plesk hosted moodle",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, October 1, 2019, 12:00 AM",
          "AuthorName": "Admin Manager",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2776429&course=5",
          "role": [
            "Picture of Admin Manager"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 389780,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=389780",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Microsoft Teams Guest User",
          "Text": "Hello I have a moodle instance and connected it via Office 365 integration and openID to my Teams environment. For users in my domain everything works fine. If I invite Guest to my Microsoft Teams environment. How can I provide them access to the moodle courses. Thanks for your help Regards Robert",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Saturday, August 17, 2019, 8:49 PM",
          "AuthorName": "Robert Vogel",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2382784&course=5",
          "role": [
            "Picture of Robert Vogel"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 389013,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=389013",
      "NoOfResponses": 5,
      "ResponsesInList": [
        {
          "Title": "usernotfullysetup",
          "Text": "I set up my moodle 3.6.3 with Open ID connect according to https://docs.moodle.org/36/en/Office365 I found that when I log in to my moodle with an O365 account. The login was successful with Open ID authentication but afterwards moodle directed me to a page (user/edit.php) to enter my surname, first name and email address. A pop-up message with title 'usernotfullysetup' appeared. I checked that the O365 account is filled with proper surname, first name and email address. Is there any way to get rid of that page (user/edit.php)? Is there any special setting required at Azure AD? All O365 users of my organization are not supposed to enter their details again while logging into moodle. Your feedback is highly appreciated. Thank you very much.",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/attachment/1568090/20190729.png?forcedownload=1"
          ],
          "Time": "Monday, July 29, 2019, 11:11 AM",
          "AuthorName": "Jack Lai",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2702495&course=5",
          "role": [
            "Picture of Jack Lai"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: usernotfullysetup",
          "Text": "Hello, Rather than using the Office365 additional plugin (which may not have been updated to work in Moodle 3.6), I suggest you use OAuth 2 authentication with an OAuth 2 Microsoft service which is included in standard Moodle.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, July 29, 2019, 6:27 PM",
          "AuthorName": "Helen Foster",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=24152&course=5",
          "role": [
            "Picture of Helen Foster",
            "Picture of Core developers",
            "Picture of Documentation writers",
            "Picture of Moodle HQ",
            "Picture of Particularly helpful Moodlers",
            "Picture of Plugin developers",
            "Picture of Testers",
            "Picture of Translators"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: usernotfullysetup",
          "Text": "Thank you for your feedback. Does OAuth 2 Microsoft service support only one O365 user only? For OAuth 2 support for all O365 users of my entire organization, does the app built in Microsoft Application Console need extra permissions, besides \"User.Read\" permission ? Your feedback is highly appreciated. Thank you very much.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, July 30, 2019, 11:19 AM",
          "AuthorName": "Jack Lai",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2702495&course=5",
          "role": [
            "Picture of Jack Lai"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: usernotfullysetup",
          "Text": "Unfortunately I can't answer your questions, however I am moving your discussion thread to the Moodle office tool integrations forum where hopefully someone will be able to help. You may wish to browse other discussions in the forum.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, July 30, 2019, 9:49 PM",
          "AuthorName": "Helen Foster",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=24152&course=5",
          "role": [
            "Picture of Helen Foster",
            "Picture of Core developers",
            "Picture of Documentation writers",
            "Picture of Moodle HQ",
            "Picture of Particularly helpful Moodlers",
            "Picture of Plugin developers",
            "Picture of Testers",
            "Picture of Translators"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: usernotfullysetup",
          "Text": "Thanks for your feedback. I have successfully set up OAuth 2 authentication with OAuth 2 Microsoft service in my moodle site. However, I sometimes received an error \"error/auth oauth2/alreadylinked\" Description: This external account is already linked to an account on this site This error happens on both users who have and haven't logged in my moodle site before. Users who have previously logged in were using other authentication methods. Is there any special setting that I need to take care? Your feedback is highly appreciated. Thank you very much.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, August 8, 2019, 4:52 PM",
          "AuthorName": "Jack Lai",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2702495&course=5",
          "role": [
            "Picture of Jack Lai"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 388397,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=388397",
      "NoOfResponses": 2,
      "ResponsesInList": [
        {
          "Title": "User field mapping Office 365 user ID - help!",
          "Text": "Hi! We are trying to integrate Office 365 for SSO into Moodle. We want the user ID of our user to be the first part of their email. So they login via their emails 12345@college.ac.uk EG we want the 12345 part to be the username. In the user field mapping, we have Given name Surname Email city country Department Object ID I can't see a way we can just have the ID. Does anyone have any ideas how we can do this? There must be thousands of places that are already doing this so i'm sure it's something we're missing Thanks very much!",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/theme/image.php/moodleorg/core/1763488129/s/smiley"
          ],
          "Time": "Thursday, July 11, 2019, 4:15 PM",
          "AuthorName": "Animal the muppet",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1719331&course=5",
          "role": [
            "Picture of Animal the muppet"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: User field mapping Office 365 user ID - help!",
          "Text": "Any ideas?",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/theme/image.php/moodleorg/core/1562913129/s/smiley"
          ],
          "Time": "Monday, July 15, 2019, 2:43 AM",
          "AuthorName": "Animal the muppet",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1719331&course=5",
          "role": [
            "Picture of Animal the muppet"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 383823,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=383823",
      "NoOfResponses": 5,
      "ResponsesInList": [
        {
          "Title": "[3.6]PDF document conversion",
          "Text": "What a pain in the *** is pdf conversion for me. Finally, I had it al working for about one year. Now I upgraded to Moodle 3.6 and it's all bad again. unoconv - doesn't work (hosting on WHM panel) Google: stopped working. Deleted everything, tried to get a new service going but the docs on this are outdated . Google Developer Console looks totally different and I can't find out how to set it up anymore. Microsoft: this ons worked best in the past, but also stopped working. Also deleted it, set it up again but still the same error: ×Debug info: Error code: conversionfailed $a contents: Array ( [statusmessage] => The file was not uploaded to Microsoft OneDrive. ) ×Stack trace: line 494 of /lib/setuplib.php: moodle_exception thrown line 223 of /files/converter/onedrive/classes/converter.php: call to print_error() line 52 of /files/converter/onedrive/test.php: call to fileconverter_onedrive\\converter->serve_test_document() What happens if I can get this working later, will everything that still needs to be converted be in a queue?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, March 14, 2019, 7:05 PM",
          "AuthorName": "Richard van Iwaarden",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=138659&course=5",
          "role": [
            "Picture of Richard van Iwaarden",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: [3.6]PDF document conversion",
          "Text": "Just to add: I also added a new Google document converter. Doesn't work either, finally gives the error: 'can not open PDF file' upon testing. System account is connected for both services.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, March 15, 2019, 1:20 AM",
          "AuthorName": "Richard van Iwaarden",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=138659&course=5",
          "role": [
            "Picture of Richard van Iwaarden",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Er: Re: [3.6]PDF document conversion",
          "Text": "Hi Richard, Did you finally get the OneDrive converter working? I'm testing it and when try the test conversion I get that same message ( Error code: conversionfailed - The file was not uploaded to Microsoft OneDrive ), but on the\nother hand I can see the tmp file on OneDrive, so the message seems inaccurate and I don't know what else can I try. I haven't found any documentation about how this should be configured (only vague remarks i n the plugins' readme ), so any help will be appreciated. TIA",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, July 5, 2019, 10:36 PM",
          "AuthorName": "Iñigo Zendegi Urzelai",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=709961&course=5",
          "role": [
            "Picture of Iñigo Zendegi Urzelai",
            "Picture of Core developers",
            "Picture of Particularly helpful Moodlers",
            "Picture of Peer reviewers",
            "Picture of Plugin developers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Er: Re: [3.6]PDF document conversion",
          "Text": "Nope, never got it working again. Same with Google btw . I had to switch back to Unoconv, but this also crashes sometimes. This PDF conversion is just an Achilles heel for Moodle.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, July 8, 2019, 1:22 PM",
          "AuthorName": "Richard van Iwaarden",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=138659&course=5",
          "role": [
            "Picture of Richard van Iwaarden",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Er: Re: Er: Re: [3.6]PDF document conversion",
          "Text": ">> This PDF conversion is just an Achilles heel for Moodle I agree with that, we're actually using Google Drive and Unoconv but there are some files making all kind of trouble (CPUs at 100%, cron executions consuming GBs of RAM...) and that's the reason I'm trying with OneDrive (as those troublemaking files\nare often Microsoft's Office files, Microsoft may get them converted correctly). BTW , we have the Google Drive converter working (on 3.5 and 3.7); we set it up following the docs, but if you have any specific question perhaps I can help you...",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, July 8, 2019, 3:14 PM",
          "AuthorName": "Iñigo Zendegi Urzelai",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=709961&course=5",
          "role": [
            "Picture of Iñigo Zendegi Urzelai",
            "Picture of Core developers",
            "Picture of Particularly helpful Moodlers",
            "Picture of Peer reviewers",
            "Picture of Plugin developers"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 385623,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=385623",
      "NoOfResponses": 7,
      "ResponsesInList": [
        {
          "Title": "All user cannot log into moodle using OIDC",
          "Text": "Hi, Moodle Version 3.5 We upgraded a theme and the error that comes up post the upgrade is as below: Debug info: Error code: erroroidccall ×Stack trace: line 47 of /auth/oidc/classes/utils.php: moodle_exception thrown line 252 of /auth/oidc/classes/oidcclient.php: call to auth_oidc\\utils::process_json_response() line 206 of /auth/oidc/classes/loginflow/authcode.php: call to auth_oidc\\oidcclient->tokenrequest() line 107 of /auth/oidc/classes/loginflow/authcode.php: call to auth_oidc\\loginflow\\authcode->handleauthresponse() line 105 of /auth/oidc/auth.php: call to auth_oidc\\loginflow\\authcode->handleredirect() line 29 of /auth/oidc/index.php: call to auth_plugin_oidc->handleredirect() No changes were made to the office 365 plugins . Any thought on now to resolve this error",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, April 25, 2019, 4:24 PM",
          "AuthorName": "Mahesh Babu Telakula Sathyan",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1089481&course=5",
          "role": [
            "Picture of Mahesh Babu Telakula Sathyan"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: All user cannot log into moodle using OIDC",
          "Text": "...a theme... which theme?? Did you upgrade Moodle codebase as well as the theme? You shouldn't need the OIDC plugins with v3.5 - OAuth 2 authentication (enabling users to log in to Moodle with their Microsoft account) and the OneDrive repository are included in the standard Moodle. But since you've upgraded a theme, if I was to hazard a guess without further information, it might be related to https://docs.moodle.org/dev/Login_token Try changing to one of the included standard themes to see if the error is still there. If it isn't, it's almost certainly the login token.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, April 25, 2019, 5:33 PM",
          "AuthorName": "Jon Bolton",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=5514&course=5",
          "role": [
            "Picture of Jon Bolton",
            "Picture of Testers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: All user cannot log into moodle using OIDC",
          "Text": "Jon, That was one of the fastest replies to a post. The theme I am using is https://edwiser.org/remui/documentation/ We recently upgrade to the latest version. BTW it has slowed down the system like mad. and we are getting all type of 502proxy errors.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, April 25, 2019, 7:26 PM",
          "AuthorName": "Mahesh Babu Telakula Sathyan",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1089481&course=5",
          "role": [
            "Picture of Mahesh Babu Telakula Sathyan"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: All user cannot log into moodle using OIDC",
          "Text": "So you only updated the theme? Not the Moodle code? As I said earlier, can you try changing to one of the included standard themes to see if the error is still there?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, April 25, 2019, 11:03 PM",
          "AuthorName": "Jon Bolton",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=5514&course=5",
          "role": [
            "Picture of Jon Bolton",
            "Picture of Testers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: All user cannot log into moodle using OIDC",
          "Text": "Hi, I switched to Boost a standard theme and the error still occurs. Not sure what is happening. Here is the debug information Debug info: Error code: erroroidccall Stack trace: line 47 of /auth/oidc/classes/utils.php: moodle_exception thrown line 252 of /auth/oidc/classes/oidcclient.php: call to auth_oidc\\utils::process_json_response() line 206 of /auth/oidc/classes/loginflow/authcode.php: call to auth_oidc\\oidcclient->tokenrequest() line 107 of /auth/oidc/classes/loginflow/authcode.php: call to auth_oidc\\loginflow\\authcode->handleauthresponse() line 105 of /auth/oidc/auth.php: call to auth_oidc\\loginflow\\authcode->handleredirect() line 29 of /auth/oidc/index.php: call to auth_plugin_oidc->handleredirect()",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, April 29, 2019, 1:26 PM",
          "AuthorName": "Mahesh Babu Telakula Sathyan",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1089481&course=5",
          "role": [
            "Picture of Mahesh Babu Telakula Sathyan"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: All user cannot log into moodle using OIDC",
          "Text": "Jon, Just to add. We have implemented office 365 plugin and it uses OIDC is what I wanted to say. The access keys are valid till 2021.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, April 25, 2019, 10:18 PM",
          "AuthorName": "Mahesh Babu Telakula Sathyan",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1089481&course=5",
          "role": [
            "Picture of Mahesh Babu Telakula Sathyan"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: All user cannot log into moodle using OIDC",
          "Text": "Hi Mahesh The issue was not related to Edwiser RemUI theme. If I'm not wrong the issues was fixed by reconfiguring your server for internet connection. There was no Internet connection in the server and therefore it could not authenticate users from 3rd party platform. This happens commonly when you have an Internal network which has restricted or completely disabled Internet access.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, June 18, 2019, 10:01 PM",
          "AuthorName": "Sarang Nair",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2344322&course=5",
          "role": [
            "Picture of Sarang Nair"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 383908,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=383908",
      "NoOfResponses": 6,
      "ResponsesInList": [
        {
          "Title": "Office 365 plugins Moodle 3.6 support",
          "Text": "Hi, I am wondering if there is news of 3.6 support for the Office 365/Azure AD set of plugins. From looking at the support page it appears that 3.5 is the latest. I imagine this might work on 3.6 but wonder if there will be updates - seems like this is a little delayed? On on 3.4.x and upgrading to either 3.5 or 3.6 in the coming months. From: https://github.com/Microsoft/o365-moodle The plugins currently support Moodle 3.1 through 3.5. Support for newer releases of Moodle typically comes a few weeks after the release.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Saturday, March 16, 2019, 3:51 AM",
          "AuthorName": "Ben Kahn",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1843974&course=5",
          "role": [
            "Picture of Ben Kahn"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Office 365 plugins Moodle 3.6 support",
          "Text": "+1",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Sunday, March 17, 2019, 2:03 AM",
          "AuthorName": "Paul F",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=315605&course=5",
          "role": [
            "Picture of Paul F"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Office 365 plugins Moodle 3.6 support",
          "Text": "For what it's worth I installed the 3.5 version of several of the O365 plugins on a Moodle 3.6 site running on MAMP as a quick test. They install fine. That's enough for me to move forward with them for further testing on a real dev server for now.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, March 18, 2019, 5:05 AM",
          "AuthorName": "Ben Kahn",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1843974&course=5",
          "role": [
            "Picture of Ben Kahn"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Office 365 plugins Moodle 3.6 support",
          "Text": "Now try and create a OneNote activity.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, March 18, 2019, 5:37 AM",
          "AuthorName": "Paul F",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=315605&course=5",
          "role": [
            "Picture of Paul F"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Office 365 plugins Moodle 3.6 support",
          "Text": "I won't be able to test the functionality for a couple of days until I get this set up on my dev server, where I have an Office 365 app configured with the required APIs. Are you seeing an issue? Or just wanting to know if it works.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, March 18, 2019, 11:58 AM",
          "AuthorName": "Ben Kahn",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1843974&course=5",
          "role": [
            "Picture of Ben Kahn"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Office 365 plugins Moodle 3.6 support",
          "Text": "Sorry for delay - didn't see this.  OneNote activity appears to be broken since 3.6.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, March 29, 2019, 5:07 PM",
          "AuthorName": "Paul F",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=315605&course=5",
          "role": [
            "Picture of Paul F"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 366516,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=366516",
      "NoOfResponses": 3,
      "ResponsesInList": [
        {
          "Title": "oEmbed plugin with Stream",
          "Text": "Hello, I had this request: how to embed a Microsoft Stream video in a Moodle wiki? The iFrame code gets stripped in the wiki for security reasons. So we tried the oEmbed filter. However, there is no preset for Stream among all the providers available. On Microsoft site, we see that oEmbed is supported for Stream videos: https://docs.microsoft.com/en-us/stream/embed-video-oembed How can we add Stream as a oEmbed provider? Moodle 3.2 oEmbed 2016111100 François",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, March 1, 2018, 12:21 AM",
          "AuthorName": "François Lizotte",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=421621&course=5",
          "role": [
            "Picture of François Lizotte"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: oEmbed plugin with Stream",
          "Text": "Hi! I am having this exact problem. Have you had any update? Has anyone else been able to make it work?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, November 12, 2018, 11:01 PM",
          "AuthorName": "Alicia Wallace",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2085097&course=5",
          "role": [
            "Picture of Alicia Wallace"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: oEmbed plugin with Stream",
          "Text": "Same! I would really like oEmbed to support Microsoft Stream. Has anyone got a work around, or an update? I also cant seem to get Office Forms working with oEmbed? cheers, Brad",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, March 21, 2019, 8:00 AM",
          "AuthorName": "Brad Nielsen",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2522606&course=5",
          "role": [
            "Picture of Brad Nielsen"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 382505,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=382505",
      "NoOfResponses": 2,
      "ResponsesInList": [
        {
          "Title": "local/office365 read and write domain permission in Azure",
          "Text": "Hi, I'm the Moodle admin at a school. We are running Moodle 3.4.6 and using the Office plugins,  on 3.4 version of the local/office365 plugin. Our OneNote assignment submission stopped working as it looks like MS has changed the permissions needed in Azure for the plugin to function with APIs back to Azure. We are working on updating this per the documentation, but my Office 365 admin has expressed concern about the need to enable \"read and write domain \" permissions for the Moodle app. Would anyone be able to shed any light on why this particular permission is needed?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, February 15, 2019, 2:09 AM",
          "AuthorName": "Ben Kahn",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1843974&course=5",
          "role": [
            "Picture of Ben Kahn"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: local/office365 read and write domain permission in Azure",
          "Text": "Nevermind, I see in the set-up instructions : Required to automatically detect your Office 365 tenant during setup. It seems in the API there is not a permission to just read a domain, so I guess the read/write level is needed in practice to read.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Saturday, February 16, 2019, 2:47 AM",
          "AuthorName": "Ben Kahn",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1843974&course=5",
          "role": [
            "Picture of Ben Kahn"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 381320,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=381320",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Office 365 User Connection Issue",
          "Text": "Hello, I have an issue that I do not know how to fix and need immediate assistance. I work at a college so will be talking about student accounts Situation: User 1: Krillin Son (email: kson@school.edu) User 2: KaioShin Son (email: kson_inactive@school.edu) _inactive as they are no longer a student and needed to change it so Krillin Son could use kson@school.edu account. User 2 is no longer in AD, Office 365 or Azure. This account is only in Moodle. User 1 can login to Moodle via basic login with username kson and their password and get into their account. But when they try to login via the Microsoft SSO button with email kson@school.edu and their password. It will show User 2's account. After investigating and going to Gear>Plugins>Local Plugins>Microsoft Office 365 Integration>Advanced>Manage User Connections. I noticed that User 2 is still showing a connections to email address kson@school.edu. I enabled the Match button on User 1 and User 2 clicked Unmatch for User 2. But when User 1 logs in with kson@school.edu it still shows User 2 account. From the Manage User Connection section I have no other changes I can make to remove User 2's connection to kson@school.edu Any help would be great. thanks Alex",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, January 23, 2019, 1:52 AM",
          "AuthorName": "Alex Diaz",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2584613&course=5",
          "role": [
            "Picture of Alex Diaz"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 351727,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=351727",
      "NoOfResponses": 22,
      "ResponsesInList": [
        {
          "Title": "Oauth2 problems in Moodle 3.3",
          "Text": "Hello everyone, I just did a fresh install for Moodle 3.3 as I'm a big fan of using Oauth for authenticating my users. I used a plugin in prior versions, but since it became a core plugin in 3.3 and on, I just did a fresh install and hope to be migrating my courses soon. I followed instructions from https://docs.moodle.org/dev/OAuth2_Services . My users started creating accounts normally, but now all I get is the following message: error/Could not upgrade oauth token I tried to recreate / update the setting at the Oauth2 services page, but as you can see in the image attached, Moodle seems to be unable to do Discovery nor connect to the System Account. I also attached my current settings. Is there anything I could do to fix this issue? thanls in advance, - Breno",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/attachment/1419462/Moodle.png?forcedownload=1",
            "https://moodle.org/pluginfile.php/2541971/mod_forum/attachment/1419462/Moodle2.png?forcedownload=1"
          ],
          "Time": "Wednesday, May 3, 2017, 4:14 AM",
          "AuthorName": "Breno Jacinto",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=840908&course=5",
          "role": [
            "Picture of Breno Jacinto"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Oauth2 problems in Moodle 3.3",
          "Text": "Hi Breno, Have you tried clicking the arrow in the System account connected column? Just today I was doing the Moodle 3.3 QA test for DropBox, OneDrive, and Flickr. I too was having trouble until I realized I had to have the system account connected before things would work.",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1419475/SystemAccountConnected1.png"
          ],
          "Time": "Wednesday, May 3, 2017, 5:33 AM",
          "AuthorName": "AL Rachels",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=94615&course=5",
          "role": [
            "Picture of AL Rachels",
            "Picture of Core developers",
            "Picture of Particularly helpful Moodlers",
            "Picture of Plugin developers",
            "Picture of Testers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Oauth2 problems in Moodle 3.3",
          "Text": "Hi Rachels, Thanks for you reply. I did this, and it properly redirected to Google's oauth page for confirmation, etc. Then I get the same error as always about not upgrading the oauth token . I attached the image below. Any other idea of why this is happening? The funny thing is that it was working normally, then it began raising this error message. Some users even created their accounts already, but none are being able to login and new users are unable to create new accounts. regards, - Breno",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/theme/image.php/moodleorg/core/1763488129/s/sad",
            "https://moodle.org/pluginfile.php/2541971/mod_forum/attachment/1419480/Moodle-1.png?forcedownload=1"
          ],
          "Time": "Wednesday, May 3, 2017, 7:42 AM",
          "AuthorName": "Breno Jacinto",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=840908&course=5",
          "role": [
            "Picture of Breno Jacinto"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Oauth2 problems in Moodle 3.3",
          "Text": "Hi Al, I just made a similar post to what I am reading here in the Authentication forum.  Do you believe that your fix will solve my problem?  Is this what you experienced for GoogleDrive, OneDrive, Flickr, etc? as you mentioned... Here is my post from the other forum: I recently upgraded from 3.1 to 3.3.  After the upgrade, I am having difficulty using the file picker to pull up Google Drive. 1. File Picker opens 2.  Click on Google Drive and the \"Login to your account\" button appears. 3.  Then this screen: ...and for OneDrive... I appreciate any suggestions or thoughts for troubleshooting this error! ...and if your fix did work, where is that screenshot from that you show to \"connect the system account\"?",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1443873/Google%20Drive%20Error.jpg",
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1443873/OneDrive%20Error.jpg"
          ],
          "Time": "Wednesday, September 6, 2017, 11:49 AM",
          "AuthorName": "Jason Touw",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1860221&course=5",
          "role": [
            "Picture of Jason Touw"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Oauth2 problems in Moodle 3.3",
          "Text": "Hi Jason, Possibly it will work. The screenshot is from Site administration > Server OAuth 2 services in the System account connected column.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, September 7, 2017, 12:16 AM",
          "AuthorName": "AL Rachels",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=94615&course=5",
          "role": [
            "Picture of AL Rachels",
            "Picture of Core developers",
            "Picture of Particularly helpful Moodlers",
            "Picture of Plugin developers",
            "Picture of Testers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Oauth2 problems in Moodle 3.3",
          "Text": "This error means that google is returning a HTTP code other than 200 from the request to get an access token. This could mean many things, but I would start by carefully checking your clientid and secret as well as checking the google api console for anything suspicious (bad redirect url, APIs not enabled etc).",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, May 3, 2017, 9:23 AM",
          "AuthorName": "Damyon Wiese",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1337843&course=5",
          "role": [
            "Picture of Damyon Wiese"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Oauth2 problems in Moodle 3.3",
          "Text": "Hi Damyon, I tried to reset my configuration carefully, but while saving new credentials I got: error/Could not discover end points for identity issuerGoogle The API is enabled and the URL set is http://cursos.brenojac.com/admin/oauth2callback.php . I may try to reconfigure using another Gmail account and see what happens.. but I'd like to have some more debugging information to solve this issue. Is there anyway I could monitor messages exchanged between Moodle and Google? regards, - Breno",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Saturday, May 6, 2017, 7:47 AM",
          "AuthorName": "Breno Jacinto",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=840908&course=5",
          "role": [
            "Picture of Breno Jacinto"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Oauth2 problems in Moodle 3.3",
          "Text": "I, like you, had previously used the excellent addon/plugin for authentications to google.   One of  the thing I noticed had to do with getting the secret and key from google into Moodle properly.   After creating an IAM in Google, you are presented with the key and secret.   If I copied and pasted those into Moodle, noticed that there was a space at the start of both (key and secret) as well as a space at the end of both.  That caused errors and the error came from the google end ... no way for Moodle to trap it. Check that in the Moodle config for Google Authentication, there are no spaces before nor after the secret/key. If you are getting google errors, you might have to share screen shots of those. The sites I was using were NOT https but http.   So am not sure that's really the reason, although now-a-days it's probably best to run https ... even though that's only a 'comfort thang' for users. The other thing that folks might have to share about issues is some more about their systems ... Ubuntu version?   What are you using for a web service on your Moodle server ? Apache as what (mod/cgi) or is it Nginx? There could also be issues with curl on your server .... from terminal might be a good idea to test using curl -I URL to Google.  That's a capital \"I\" To see more output ...  curl -I -vvv URL to Google. The -vvv sets verbose levels which will show every step in exchange/negotiation of the connection. 'spirit of sharing', Ken",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, May 18, 2017, 8:21 PM",
          "AuthorName": "Ken Task",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=141618&course=5",
          "role": [
            "Picture of Ken Task",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Oauth2 problems in Moodle 3.3",
          "Text": "I got the same error with Google and Facebook. By the way, my site's using http instead of https, which may be a reason.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, May 18, 2017, 6:35 PM",
          "AuthorName": "Phuong Hoang",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1519046&course=5",
          "role": [
            "Picture of Phuong Hoang"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Oauth2 problems in Moodle 3.3",
          "Text": "Hello! Could you resolved your problem??.. Because I just installed the new version moodle 3.3 and I cant get the google login working, not even been  the button  appears. my site's using http instead of https, too. I don have ssl certificate. I need help!! Note: Sorry about my English.!",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, May 18, 2017, 11:00 PM",
          "AuthorName": "Emi Camargo",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2239180&course=5",
          "role": [
            "Picture of Emi Camargo"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Oauth2 problems in Moodle 3.3",
          "Text": "This may/may not solve the issues immediately, but .... When one begins to interface things like Google (Facebook/other) to Moodle, there are settings etc. on the other end - yeah, ok, we all know that so what's the point.   Point is you might need to check everything on the other end. Tip Every once in a while Google does send via Email to the primary account you might have used to interface Moodle with Google that ask you to  check - got one of those today. Here's the URL in case you didn't get an EMail today (you might get one in near future): https://myaccount.google.com/permissions You should be prompted to login into Google and if you have multiple accounts in Google, make sure you login with the same account you used to interface Moodle. Can check it all: https://myaccount.google.com/security https://myaccount.google.com/security#connectedapps May not be a bad idea to create a System Admin Category and a System Admin course in your Moodle that's accessible only by System Admin (hidden/assign no one) and record your keys/secrets and other information.   Could create a page resource of the above information and thus not have to find that message in your EMail - nor have to return to these forums to find the links. 'spirit of sharing', Ken",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, May 18, 2017, 11:13 PM",
          "AuthorName": "Ken Task",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=141618&course=5",
          "role": [
            "Picture of Ken Task",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Oauth2 problems in Moodle 3.3",
          "Text": "thanks Ken. All setting are ckecked!..the google configuration worked on versión 3.2.3 moodle with Outh2 plugin. But in this case, the button for google login doesn appear in the login page, so I cant test the google login. Any ideas about why is not showing up? Show on login page: Is checked!! thanks!!",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, May 19, 2017, 12:18 AM",
          "AuthorName": "Emi Camargo",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2239180&course=5",
          "role": [
            "Picture of Emi Camargo"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Oauth2 problems in Moodle 3.3",
          "Text": "Isn't there a test button in config?   Try that? Are there all greens in the setup of Google? https://docs.moodle.org/33/en/OAuth_2_services Change theme.  Does login button show?  Got theme designer mode on?  Turn off. Other than that, since 3.3 is brand spanking new, cache?   On server purge cache ... might even manually purge in moodledata cache and localcache. In the paste, before using the plugin no longer supported or it was built in, had a link in drop down menus for \"Login to Google\" ... pointed to accounts ... one of those links seen in the config.   Try making a menu item in the theme pointed to accounts that uses new window. If that dosn't work, then ???? ... look else where ... web server error logs?  Other logs? The old plugin used to detech that user was logged on and took one right into Moodle. Just can't do 'Vulcan Mind Melds'! 'spirit of sharing', Ken",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, May 19, 2017, 1:47 AM",
          "AuthorName": "Ken Task",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=141618&course=5",
          "role": [
            "Picture of Ken Task",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Oauth2 problems in Moodle 3.3",
          "Text": "I have a new question! Where are setting about the answers mails and the page  linked login confirmation after cliking  the   \"google\"button in oauth2?, Because I need  to change the language to spanish. thanks !!",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, May 24, 2017, 9:17 PM",
          "AuthorName": "Emi Camargo",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2239180&course=5",
          "role": [
            "Picture of Emi Camargo"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Oauth2 problems in Moodle 3.3",
          "Text": "Ken, When we use the system account to connect between Moodle and Google, is that just a generic Google account or is like a Google \"Super user\"?? Thanks, Steve",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, June 15, 2017, 10:57 PM",
          "AuthorName": "Steven Geggie",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=12743&course=5",
          "role": [
            "Picture of Steven Geggie"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Oauth2 problems in Moodle 3.3",
          "Text": "For the system account, you can use any Google account but it must be one dedicated to that purpose - ie - not your own  account.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, June 15, 2017, 11:15 PM",
          "AuthorName": "Mary Cooch",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=531675&course=5",
          "role": [
            "Picture of Mary Cooch",
            "Picture of Documentation writers",
            "Picture of Moodle HQ",
            "Picture of Particularly helpful Moodlers",
            "Picture of Testers",
            "Picture of Translators"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Oauth2 problems in Moodle 3.3",
          "Text": "You mentioned that the account must not be the one you use on a normal basis -- why is this? In other words, how does this fail and what problems would it cause? I'm currently using it this way and trying to trouble shoot items. I'm also not certain why it needs email confirmation followup -- i.e. why the site says \"This account is pending email confirmation.\" I'm also in the middle of getting my email relay set up, so I'm not receiving any confirmation messages yet; I'm not certain why that's needed since other OAuth2 services don't do that.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, July 26, 2017, 4:36 AM",
          "AuthorName": "Dirk Grunwald",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=25027&course=5",
          "role": [
            "Picture of Dirk Grunwald"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Oauth2 problems in Moodle 3.3",
          "Text": "I Resolved the problem!! It was my template fault!.. I restored the default theme and the button showed. Thanks!!",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, May 19, 2017, 2:18 AM",
          "AuthorName": "Emi Camargo",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2239180&course=5",
          "role": [
            "Picture of Emi Camargo"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Oauth2 problems in Moodle 3.3",
          "Text": "Thanks for posting back with your solution, Emi -it could be helpful to others in future",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/theme/image.php/moodleorg/core/1763488129/s/smiley"
          ],
          "Time": "Friday, May 19, 2017, 2:54 AM",
          "AuthorName": "Mary Cooch",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=531675&course=5",
          "role": [
            "Picture of Mary Cooch",
            "Picture of Documentation writers",
            "Picture of Moodle HQ",
            "Picture of Particularly helpful Moodlers",
            "Picture of Testers",
            "Picture of Translators"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Oauth2 problems in Moodle 3.3",
          "Text": "Same error \"error/Could not upgrade oauth token\" using a custom external OAuth provider. Any hints as answers above don't seem linked to the inital question ?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, September 5, 2018, 11:42 PM",
          "AuthorName": "Jerome Denanot",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2497315&course=5",
          "role": [
            "Picture of Jerome Denanot"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Oauth2 problems in Moodle 3.3",
          "Text": "I have the same error , OneDrive / DropBox return \"error/Could not upgrade oauth token\". it's clear, in the code \n```text\nif ($this->info['http_code'] !== 200) {\n\n\n    throw new moodle_exception('Could not upgrade oauth token');\n\n\n}\n```\n We have 4 identical web server (same code / same config / share DB) and just one retun this error. If i inspect the request i find this Request URL : https://[........]/repository/repository_callback.php?callback=yes&repo_id=258&sesskey=ssJ0VPwCih&oauth2code=M491d5458[........] Request Method: GET Status Code: 404 Not Found I don't understant why for this server the callback get 404 error.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, November 7, 2018, 2:35 AM",
          "AuthorName": "Aurélien Besson",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2481430&course=5",
          "role": [
            "Picture of Aurélien Besson"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Oauth2 problems in Moodle 3.3",
          "Text": "After many research, i put somes traces in /lib/oauthlib.php (ln 566). Trace exemple : \n```text\nerror_log(\"==== HTTP_CODE : \".$this->info['http_code'], 0);\nerror_log(\"==== ERROR : \".$this->error, 0);\nerror_log(\"==== ERRORNO : \".$this->errno, 0);\n$TypeCode=gettype($this->info['http_code']);\nerror_log(\"==== type HTTP_CODE : \".$TypeCode, 0);\n```\n Return \n```text\n[07-Nov-2018 08:52:48 America/New_York] ==== HTTP_CODE : 0\n[07-Nov-2018 08:52:48 America/New_York] ==== ERROR : couldn't connect to \nhost\n\n[07-Nov-2018 08:52:48 America/New_York] ==== ERRORNO : 7\n[07-Nov-2018 08:52:48 America/New_York] ==== type HTTP_CODE : integer\n[07-Nov-2018 08:52:48 America/New_York] Default exception handler: error/Could not upgrade oauth token Debug:\nError code: Could not upgrade oauth token\n```\n couldn't connect to host caused by a firewall rule.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, November 7, 2018, 10:34 PM",
          "AuthorName": "Aurélien Besson",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2481430&course=5",
          "role": [
            "Picture of Aurélien Besson"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 375946,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=375946",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "OAuth 2 : Moodle vs Bitrix24",
          "Text": "I want to use the Bitrix24 login account on the internal moodle page, I do not know how you are wrong, please help when me test login this is error",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1515785/1.png",
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1515785/2.png",
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1515785/3.png",
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1515785/4.png"
          ],
          "Time": "Friday, September 14, 2018, 4:18 PM",
          "AuthorName": "Secrect Nguyen",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2510817&course=5",
          "role": [
            "Picture of Secrect Nguyen"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 360709,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=360709",
      "NoOfResponses": 4,
      "ResponsesInList": [
        {
          "Title": "Office 365 Intregation Setup",
          "Text": "Have been setting up when I press update I get this Azure AD Application Verifies the correct parameters are set up in Azure AD. Could not check reply url. Could not check sign-on url. Microsoft Graph API (Recommended) The Microsoft Graph API replaces the existing application-specific APIs. If available, you should add this to your Azure AD application to be ready for the future. Eventually, this will replace the legacy API. Error in API call: Property 'appId' does not exist as a declared property or extension property. any advice please",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, October 30, 2017, 2:29 AM",
          "AuthorName": "Ian Allen",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2335202&course=5",
          "role": [
            "Picture of Ian Allen"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Office 365 Intregation Setup",
          "Text": "Dear Ian Install the updated plugin. This should solve the problem. -> https://github.com/Microsoft/o365-moodle/issues/215 Best regards Regina Zaugg",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, December 1, 2017, 5:25 PM",
          "AuthorName": "Regina Zaugg",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=822755&course=5",
          "role": [
            "Picture of Regina Zaugg"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Office 365 Intregation Setup",
          "Text": "Got this error Error\nin API call: Resource '2cxxxxxxxxxxxxxxxx5' does not\nexist or one of its queried reference-property objects are not present.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, August 29, 2018, 12:42 PM",
          "AuthorName": "Alessio Onofri",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1892131&course=5",
          "role": [
            "Picture of Alessio Onofri"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Office 365 Intregation Setup",
          "Text": "Same problem here with Moodle 3.4 ????",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, September 10, 2018, 5:47 PM",
          "AuthorName": "Albert Ramsbottom",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=403579&course=5",
          "role": [
            "Picture of Albert Ramsbottom"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 352457,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=352457",
      "NoOfResponses": 45,
      "ResponsesInList": [
        {
          "Title": "Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "Hello, I just upgraded my Moodle installations to version 3.3. My users login using Oauth2 with their LinkedIn accounts. I could not however find a way how to migrate them to the new Oauth2 core plugin, therefore I am still using the old contributed one. Is there any way to achieve the above goal? Thank you!",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, May 16, 2017, 5:27 PM",
          "AuthorName": "Kaloyan Ganev",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2238272&course=5",
          "role": [
            "Picture of Kaloyan Ganev"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "Were you using this one: https://moodle.org/plugins/auth_googleoauth2 Think this will require direct manipulation of mdl_users table.   If you look at that table you will see that two columns in that table are different ... the 'auth' column is set to 'googleoath2' and the user_name column has used 'social_user_#' as opposed to a 'ktask' or 'ken.task' or other.  And the password field is set to 'not cached' right now. One way to make such massive changes, used to be export all users to a csv file.   Then manipulate that csv file for desired results (did this once when Moodle moving from all manual to LDAP ). You won't be creating new accounts but editing existing. In 3.3 new table: mdl_oauth2_user_field_mapping exist (fresh install).  The mdl_user table under auth now has oath2 and username is now an EMail address.  Password is blank - that's because the password, like LDAP, not stored in Moodle. The new table ... mdl_oauth2_user_field_mapping ... has a 'user_modified' column which appears to be the user ID number. You might have to refer to: https://github.com/rabser/moodle-auth_googleoauth2/issues Suggest using one user for testing when using CSV updates like that. The tricky part of this ... might involve turning off current oath2 authentication, turning on the new one (after it is configured) and testing with the one user you've changed via CSV. Might be best to set up a clone of production where you can 'tinker' without fear! ;) 'spirit of sharing', Ken",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, May 16, 2017, 7:22 PM",
          "AuthorName": "Ken Task",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=141618&course=5",
          "role": [
            "Picture of Ken Task",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "Thank you very much! Yes, this is the one I am still using. For the time being I will postpone the tinkering but I think I will give it a try (especially if no smoother way comes up). The good thing is that I can afford even a fresh re-install and user re-registration during the summer when the semester is over but I was wondering whether there is a cleverer approach.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, May 16, 2017, 7:44 PM",
          "AuthorName": "Kaloyan Ganev",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2238272&course=5",
          "role": [
            "Picture of Kaloyan Ganev"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "'cleverer' sometimes gets one in trouble ... been there done that! (not very clever). 'Smoother' way might have to be provided by the maker of the plugin ... some conversion script of some sort.  See from the git hub, however, it's changed ownership and am not sure I'd look for a freebie conversion script in the near future.   Guess you could contact current maintainer and inquire. Good that you have a break ... perfect time to take care of it.   Fresh install will probably clean up things you've not discovered yet. ;) 'spirit of sharing', Ken",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, May 16, 2017, 8:31 PM",
          "AuthorName": "Ken Task",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=141618&course=5",
          "role": [
            "Picture of Ken Task",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "\"Cleverer\" was related to a potential alternative of a fresh install. I apologize if I did not make it clear enough and this possibly made it sound rude. Thank you very much again, and cheers! (And, summer is not so much far ahead, and you are right that cleaning old and forgotten stuff might bring some pleasant gains.)",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, May 16, 2017, 9:55 PM",
          "AuthorName": "Kaloyan Ganev",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2238272&course=5",
          "role": [
            "Picture of Kaloyan Ganev"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "No offense take about 'clever'!  I know more about how not to do something than do it right the first time ...  no matter how 'clever' I think I might be!!!! ;) It has been a great plugin and one that drew enough attention to be partially responsible for Moodle HQ decision to move in that direction (it's time!). And am glad to see the current maintainer dropped in here ... would be nice to have a script to convert accounts.    But, then again, like I mentioned, a fresh install of a site, new users registering under the new authentication and new courses does also sound good. I know of a Univ on West Coast of USA, that has a new Moodle every academic year ... archiving old sites to another domain and allowing students/teachers continued access to old courses ... but can't re-submit assignments, add to any forum, etc..   Am almost willing to bet they get the bugs out of new at the start and then pretty much 'surf' the remainder of that academic year. Must be nice!   I wouldn't know, however. 'spirit of sharing', Ken",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, May 16, 2017, 10:49 PM",
          "AuthorName": "Ken Task",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=141618&course=5",
          "role": [
            "Picture of Ken Task",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "I'm the new lead mantainer for the plugin. As stated in the plugin page by the old mantainer (Jerome Mouneyrac) this plugin will not be ported to moodle 3.3 because it can cause conflict with the oauth2 embedded authentication. My job will be mantaining the plugin only for 2.x / 3.1 / 3.2  releases, and in particular for Moodle 3.1 which is a LTS release. Thanks to Ken for sharing some hints i'll take a look asap, and i could do a special branch for 3.3, but i would'nt overlap the moodle core functionalities, so i'm in doubt if it's correct publish an official release. Comments and suggestions are welcome.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, May 16, 2017, 9:06 PM",
          "AuthorName": "Sergio Rabellino",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=617016&course=5",
          "role": [
            "Picture of Sergio Rabellino",
            "Picture of Particularly helpful Moodlers",
            "Picture of Plugin developers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "Thank you for joining the discussion! The plugin that you are taking care of is working so far perfectly under Moodle 3.3. I have disabled the core one to avoid potential conflicts. So if no bug issues are pending, guys like me can put up with some waiting and migrate as soon as possible to the core Oauth2.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, May 16, 2017, 10:01 PM",
          "AuthorName": "Kaloyan Ganev",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2238272&course=5",
          "role": [
            "Picture of Kaloyan Ganev"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "Hi Sergio! Thanks for your message! I've been using the \"old auth2\" plugin and I confess I'm not 100% confident about upgrading my moodle 3.2+ to 3.3. I'm not a developer so I don't know if I'll be able to do this \"manual-bit-byte-migration\". I know it's not your responsability, but could you help me with this info I would be very thankful: 1) I have many users created using \"linkedin\", \"facebook\" and Google+\". If I update my moodle, will they be migrated to this new \"Auth2 core\"? 2) If thre's no automatic migration, is there a script \"how-to\" migrate? 3) If it doen't work properly, can I unistall the \"core auth\" and keep using the old one? I really appreciate your help. Best Regards",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Sunday, May 21, 2017, 2:17 AM",
          "AuthorName": "Filipe Ferreira",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2164587&course=5",
          "role": [
            "Picture of Filipe Ferreira"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "Actually i could'nt answer to your question, as i didn't have time to take a look into the new code: hope that who developed the new core functionality could answer to your doubt: they know better than me their code. My effort it's mostly oriented to guarantee a support for the releases older than 3.3 until they lives and are officially supported. By now, if you are not urged to do this upgrade, my very personal suggestion is:  wait some weeks...",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, May 22, 2017, 3:14 PM",
          "AuthorName": "Sergio Rabellino",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=617016&course=5",
          "role": [
            "Picture of Sergio Rabellino",
            "Picture of Particularly helpful Moodlers",
            "Picture of Plugin developers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "Sergio, thanks for your message. I have the same feeling (to wait a while untill they get all the problems set). In my opinion, moodle dev team has acted hastily releasing this new \"core oauth2\". Very fast, but inefficient. I tried to install both oath2 on my DEV server and they didn't work properly. It means, I can't update my moodle anymore till this point is completely clarified by moodle team. Again, thanks. Best Regards, Filipe",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/theme/image.php/moodleorg/core/1763488129/s/sad"
          ],
          "Time": "Monday, May 22, 2017, 9:30 PM",
          "AuthorName": "Filipe Ferreira",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2164587&course=5",
          "role": [
            "Picture of Filipe Ferreira"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "Sergio, you stated, \"this plugin will not be ported to moodle 3.3 because it can cause conflict with the oauth2 embedded authentication.\" Can you amplify on that, please? I have just upgraded from 3.1.7 to 3.3.1. My update script copied the auth/googleoauth2 plugin directory across to the the new install, and immediately after the upgrade, my site was still using the plugin. However, all attempts to get the core OAuth 2 functionality to work has failed - sessions time out after a short time (around a minute or two, often less). See my posts further down this thread. Just about the only thing I haven't tried in my attempts to get the core OAuth 2 code to work is to uninstall the auth_googleoath2 plugin and delete its directory. I am very reluctant to try this for fear of not being able to re-enable it if that fails to solve the problem, so for the time being, I am assuming that if the auth_googleoauth2 plugin remains installed, but disabled, it should not cause any problems. What do you think? --- Les",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Saturday, July 15, 2017, 1:26 PM",
          "AuthorName": "Les Bell",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=23064&course=5",
          "role": [
            "Picture of Les Bell"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "Sorry for the late response, i was away for summer holidays. Mainly i believe that is wrong duplicating inside a plugin the core functionality, so i believe that the core oauth2 should be the first choice, and our effort should be in helping the HQ to debug and correct the errors in the core code. A plugin, even if disabled, can cause conflicts in loading libraries, so i suggest (my opinion...) that if the plugin is not used anymore, it should be removed from the filesystem. Bye.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, July 31, 2017, 6:34 PM",
          "AuthorName": "Sergio Rabellino",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=617016&course=5",
          "role": [
            "Picture of Sergio Rabellino",
            "Picture of Particularly helpful Moodlers",
            "Picture of Plugin developers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "That's all great, Sergio, but: Until 3.3 was released, there was no duplication of functionality - the plugin was the only way to allow OAuth2 logins. Until the core functionality works, the plugin is necessary, to allow existing users to log in. As I pointed out (possibly in another thread), there is no way to remove the plugin, even if I wanted to, and simply renaming or removing the plugin's directory after the core functionality is enabled results in major errors. At this point, I suspect the problem lies in the caching of tokens somewhere - maybe the server, maybe the browser, maybe Google and maybe all three. Once the current high level of activity on our site dies down, next week (I hope), then I'm going to do a 5 am test in which I log myself completely out of Google, switch to the core OAuth 2 module, disable the plugin, rename its subdirectory and purge all caches on the server, touch wood, say a prayer to the Blessed Saint Turing and try to log in using my Google account. If that works, trust me - I will be yelling it from the rooftops. ;) --- Les",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, August 1, 2017, 7:31 AM",
          "AuthorName": "Les Bell",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=23064&course=5",
          "role": [
            "Picture of Les Bell"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "AFAIK there are two oauth2 plugins for moodle, the one who i'm currently mantaining and using is auth_googleoauth2: in this plugin there is no oauth2 token caching enabled nor needed for the authentication mechanism. Please, post the errors that you're getting after switching and (re)moving the plugin, to better understand what it's happening.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, August 1, 2017, 5:57 PM",
          "AuthorName": "Sergio Rabellino",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=617016&course=5",
          "role": [
            "Picture of Sergio Rabellino",
            "Picture of Particularly helpful Moodlers",
            "Picture of Plugin developers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "Hi, Sergio, I have a thread with a more comprehensive description of the problem at https://moodle.org/mod/forum/discuss.php?d=355492#p1434007 . But what I said there is: --------------------------- I went to Plugins -> Authentication -> Manage authentication,\ndisabled OAuth2 (googleoauth2) and enabled OAuth 2 (oauth2). Then I went\nto Plugins overview, only to find there is no uninstall option for the googleoauth2 module. So I moved\nauth/googleoauth2 out of the way by renaming it - after all, it was disabled. Refreshing the Plugins overview page\ngot Moodle to complain that the plugin could not be found on the disk,\nfollowed by an option to update the database - so I did that, and thought I'd got googleoauth2 uninstalled. I logged\nout, then tried to log back in using the core OAuth2 Google button and was\ntaken to the Google account chooser, only to then get a BIG message that\ngoogleoauth2 could not be found, and no way of getting the site to\nload. (From memory, it was trying to invoke /auth/googleoauth2/google_redirect.php.) --------------------------- I'm guessing that there's no uninstall option for googleoauth2 because I have around 80 users who registered through it and are using it. I can't delete their accounts - they're active users with stuff going on in courses - and even if there was an uninstall option, I'd be reluctant to mess with it unless I was confident that a) the uninstall wouldn't mess with their accounts and b) that the uninstall would also resolve the problem with sessions timing out after 30 - 90 seconds. I suspect that I'm going to have to: enable the core oauth2 module disable googleoauth2 purge all cached session data on the server rename the auth/googleoauth2 directory update the plugins database log out of Google completely, on all my machines, and delete all cookies in the browser in order to get this resolved. Then the question is, are my users going to have to go through a similar process of logging out and deleting cookies? In any case, I can't try this until things go quiet on the server, some time early next week. --- Les",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, August 2, 2017, 11:19 AM",
          "AuthorName": "Les Bell",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=23064&course=5",
          "role": [
            "Picture of Les Bell"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "Have you checked into the mdl_user table and editing via csv file that you manipulate? User ID's wouldn't change then and the only thing that would change is the 'auth' column for how a user would be authenticated. On the Google end, at least, the secret/key should be different as well as the call back URL - where one sets up the credentials in Google. Had to do something similar for a site that had used manual/email for students originally and later that same academic year the entity had finally worked out their LDAP issues and wanted all students to authenticate via LDAP.   Had to make a couple of runs via csv but eventually got all students auth vs. LDAP.    Think you should be able to do the same. 'spirit of sharing', Ken",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, August 2, 2017, 10:07 PM",
          "AuthorName": "Ken Task",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=141618&course=5",
          "role": [
            "Picture of Ken Task",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "Hi, Ken, \"User ID's wouldn't change then and the only thing that would change is the 'auth' column for how a user would be authenticated.\" I don't think the user ID changes anyway, although I could be wrong. The old plugin created user ID's like \"social_user_n\" and I don't think that switching to the new core OAuth2 functionality will change that - in fact, I just checked and on my test account, which I used to log in with both, it hasn't changed. It's the email address that is the identifier for OAuth 2, not the username. \"On the Google end, at least, the secret/key should be different as well as the call back URL - where one sets up the credentials in Google.\" Agreed, and in fact, I deliberately created two distinct sets of secrets at Google for just that purpose. However, switching to the core OAuth2 still results in the original plugin callback URL being called after 90 seconds or so - I'm pretty sure that's why sessions were getting broken after a minute or two, and why I got big warnings when I renamed the googleoauth2 plugin directory. I checked that the callback URL was set correctly on the core OAuth2 setup, but Google was still using the old URL. That's why I think this is a caching problem - so when things go quiet, early next week, I'm going to get up at 5 am, switch the config and purge every cached bit of session info and cookies I can think of. Hopefully, that will fix it and my users won't have too much trouble. Thanks, Ken! --- Les",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, August 3, 2017, 9:19 AM",
          "AuthorName": "Les Bell",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=23064&course=5",
          "role": [
            "Picture of Les Bell"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "In/on a Moodle 3.3 that cannot run the old plugin: mysql > select id,auth,username,firstname,lastname,email from mdl_user where auth=\"oauth2\"; +----+--------+------------------------+-----------+----------+------------------------+ | id | auth   | username               | firstname | lastname | email                  | +----+--------+------------------------+-----------+----------+------------------------+ |  4 | oauth2 | mine@gmail.com      | Ken       | Task     | mine@gmail.com On a 3.2 that **does** use the old plugin: my sql > select id,auth,username,firstname,lastname,email from mdl_user where auth like \"google%\"; +----+--------------+---------------+-----------+----------+----------------------+ | id | auth         | username      | firstname | lastname | email                | +----+--------------+---------------+-----------+----------+----------------------+ |  6 | googleoauth2 | social_user_1 | Ken       | Task     | mine@gmail.com Moodle doesn't populate the password column. which is why I think if one used csv from a spreadsheet that's been manipulated ... googleoauth2 changed to oauth2 username changed from social_user_# to googleemailaddress Might be the eaiest way to move all users to the new and keep them in courses in which enrolled, etc. Google has always used EMail address for username, me thinks. The user ID is what ties users to courses ... is it not? 'spirit of sharing', Ken",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, August 3, 2017, 10:56 AM",
          "AuthorName": "Ken Task",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=141618&course=5",
          "role": [
            "Picture of Ken Task",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "Hello Ken, I solved it in a simple way. I have set the authentication method again for: manual and username for email This way when the user who was already registered click the authentication icon of google, it will be asked if you want to associate the existing account with google account. If so, it will receive an email with the link that will simply click and the existing account (manual) will be associated with google account. SQL to update user table update mdl_user set username=email , auth='manual' where auth='googleoauth2' 'spirit of sharing'",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/theme/image.php/moodleorg/core/1763488129/s/smiley"
          ],
          "Time": "Thursday, May 24, 2018, 4:21 AM",
          "AuthorName": "Gisele Brugger",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=16848&course=5",
          "role": [
            "Picture of Gisele Brugger"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "To be useful, I need the error message exactly as it is printed out or,even better, enabling the moodle debugging to the max level the errors thrown in the error_log of the web server. So i'll wait for your next tests...",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, August 3, 2017, 3:51 PM",
          "AuthorName": "Sergio Rabellino",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=617016&course=5",
          "role": [
            "Picture of Sergio Rabellino",
            "Picture of Particularly helpful Moodlers",
            "Picture of Plugin developers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "OK, Sergio, I was at my desk by 6:15 am this morning to attempt the changeover. I did all the things I suggested above: Logged out of Moodle as a user Looged out of Google Cleared the browser of *all* cookies, logins and cache content Logged in to Moodle as admin, with a password Enabled the core Oauth 2 plugin Disabled the googleoauth2 plugin Purged the server's cached session data (and the other stuff, for good measure) Renamed auth/googleoauth2 to auth/googleoath2 so it can't be found Went to \"Plugins overview\", saw the plugin was not found on the disk and refreshed the database Logged out Logged in using the new, core Oauth 2 grey \"Google\" button I went through the whole two-factor process, only to see the URL bar redirect through /accounts/setSID to a near-blank screen with the message \"Authentication plugin googleoauth2 not found\" appearing twice. I even went to the Google API Manager and set all possible callbacks to the new core OAuth 2 module's address of \"/admin/oauth2callback.php\" but it still produces the same error message. If I've got my notes correct, the URL at that point is https://www.lesbell.com.au/classroom/auth/oauth2/login.php?wantsurl=https%3A%2F%2Fwww.lesbell.com.au%2Fclassroom%2Fadmin%2Ftool%2Foauth2%2Fissuers.php&sesskey=aJLQEnkMMT&id=4&oauth2code=4%2FHq1zCLczzj4EfQugx5CC2Z1VOMofFNppraO_xc4ROy0 which looks, to me, as though it's redirecting through the new OAuth 2 module. With the googleoauth2 directory in place (but disabled) the error messages do not appear and the login appears to be successful - but within a minute or two, the session is broken and I am logged out (I'm testing by editing quiz question feedback - the symptom specifically is that draft edits cannot be saved and refreshing the site front page in another tab shows I'm logged ut). I didn't up the level of logging, but the logs just show me logging in and out (I wasn't noting the specific times so can't correlate my actions against the logs) and selecting \"Site errors\" produces an empty report, so I'm not sure anything useful is being logged anyway. And sure enough - no sooner had I reset the site to normal operation (which turned out to be tricky as it wasn't recognising the replaced auth/googleoauth2 directory at first) than a student logged in, before 7:30 am. tl;dr - There is no \"uninstall\" option for the googleoauth2 plugin but just disabling it and moving it away is not enough to stop callbacks to it. Happy to up the level of logging and correlate with the Apache logs if it will help. At this point, I'm flummoxed. --- Les",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, August 7, 2017, 6:39 AM",
          "AuthorName": "Les Bell",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=23064&course=5",
          "role": [
            "Picture of Les Bell"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "Another curious thing: not only is there no \"uninstall\" link for this plugin, I can't find any \"settings\" link or admin page, either. Yet there must be one - the docs refer to it, and I must have set up the client ID and key or it wouldn't be working. I've tried reinstalling the auth_googleoauth2 plugin - the installation just warned that the target directory already exists and will be removed - but reinstalling didn't seem to make any difference. --- Les",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, August 7, 2017, 10:00 AM",
          "AuthorName": "Les Bell",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=23064&course=5",
          "role": [
            "Picture of Les Bell"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "I've no doubt that you're doing the things well, so these are my opinions: The oauth2 plugin  \"uninstall\" menu option missing is correct, should not be a real problem; disabling it it's normally enough; caches in the browser or in the server should not be a problem, they should be cleared automagically for the updated values; Please note that the value \"googleoauth2\" it's written along all your users which where tied to it, so you need to alter your mdl_user records (DO A BACKUP FIRST!) to reset the authentication method for your users: change in the column auth from googleoauth2 to oauth2. Maybe start changing only your user and note that you can do the same by opening the moodle interface for you user and changing in the advanced settings of the user profile the authentication method and you should be ok. Hope this helps.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, August 7, 2017, 7:03 PM",
          "AuthorName": "Sergio Rabellino",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=617016&course=5",
          "role": [
            "Picture of Sergio Rabellino",
            "Picture of Particularly helpful Moodlers",
            "Picture of Plugin developers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "Thanks, Sergio - I will give it another try tomorrow morning. I'll also up the level of logging. --- Les",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, August 7, 2017, 7:09 PM",
          "AuthorName": "Les Bell",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=23064&course=5",
          "role": [
            "Picture of Les Bell"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "Apologies for the delayed reply - the site has been busy, as have I, and I've been traveling, to boot. SUCCESS! The missing link was this: \"Please note that the value \"googleoauth2\" it's written along all your\nusers which where tied to it, so you need to alter your mdl_user records\n(DO A BACKUP FIRST!) to reset the authentication method for your users:\nchange in the column auth from googleoauth2 to oauth2. Maybe start\nchanging only your user and note that you can do the same by opening the\nmoodle interface for you user and changing in the advanced settings of\nthe user profile the authentication method and you should be ok.\" As you suggested, I tried it with my own account first and after some testing, I breathed a sigh of relief and have now changed all the old googleoauth2 entries - for the SQL neophytes among us, the statement to do this is \n```text\nUPDATE mdl_user SET auth = 'oauth2' WHERE auth = 'googleoauth2';\n```\n I'm hoping that the confirmation emails go out OK and don't get caught in spam traps, etc. Thanks for your help with this - now it's done I can sleep a bit more easily. ;) --- Les",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Sunday, August 20, 2017, 9:30 AM",
          "AuthorName": "Les Bell",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=23064&course=5",
          "role": [
            "Picture of Les Bell"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "Hi Les, I've followed the same process and some of my users have received the email in their SPAM folder. So, my suggestion is to send a \"newsletter\" informing the users about the validation process and to check their spam folder just in case. Anyway, As said in other entry of this threat it would be great if there was a chance to avoid this mail to the users that had been using the old OAuth module in previous Moodle versions. I assume it's not easy to fix from a tech point of view, bur from a user point of view it doesn't make any sense they've been login for years with their google account in the platform and now the have to validate it again. Best regards, Alejandro",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, August 21, 2017, 2:41 PM",
          "AuthorName": "Alejandro Orviz",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1763659&course=5",
          "role": [
            "Picture of Alejandro Orviz"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "Can anyone tell me why I'm getting the error message \" The system account was not connected for offline access\" when I go to enable LinkedIn and Facebook?  I've successfully set up Oauth2 for Google and Microsoft but something isn't right for Facebook and LinkedIn.  When I go to connect, it doesn't go to Facebook or LinkedIn for the final step (like it did for Google and Microsoft) and just returns me to the Moodle Oauth 2 service settings with that message displayed at the top.  I've double checked all of the settings and they look correct.  Purged Moodle cache, too, but I get the same result. Thanks for any help. Dave",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, February 9, 2018, 2:44 PM",
          "AuthorName": "David Heuring",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1145297&course=5",
          "role": [
            "Picture of David Heuring"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "Which release of moodle are you using ? did you configure the oauth2 plugin or you are using the native (Moodle >3.2) oauth2 feature ?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, February 12, 2018, 7:22 PM",
          "AuthorName": "Sergio Rabellino",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=617016&course=5",
          "role": [
            "Picture of Sergio Rabellino",
            "Picture of Particularly helpful Moodlers",
            "Picture of Plugin developers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "It's Moodle 3.4.1+ (Build: 20180208) Version 2017111301.04.  I'm using the native Moodle oauth2 feature.  I was able to get Microsoft and Google set up properly.  Not happening with LinkedIn and Facebook.  I double-checked all the settings as well as the endpoints and everything seems correct to me.  I'm also logged into LinkedIn and Facebook developer accounts but when I try to connect to authorize, it just returns to the Moodle Oauth2 Service page instead of going to LinkedIn and Facebook to get approval.  The message at the top says - \" The system account was not connected for offline access\". \nI also turned on debugging but nothing showed when I tried to connect.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, February 12, 2018, 7:38 PM",
          "AuthorName": "David Heuring",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1145297&course=5",
          "role": [
            "Picture of David Heuring"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "I'm sorry i can't help you. I'm using only the Oauth2 plugin ...",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, February 12, 2018, 8:18 PM",
          "AuthorName": "Sergio Rabellino",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=617016&course=5",
          "role": [
            "Picture of Sergio Rabellino",
            "Picture of Particularly helpful Moodlers",
            "Picture of Plugin developers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "I just documented the process for setting up login with LinkedIn using the OAuth support added in Moodle 3.3. See this page: https://docs.moodle.org/dev/OAuth2_Services_Setup_Project_In_LinkedIn#Setup_App_in_LinkedIn If you switch to use this new service the first time your users login they will need to click a confirmation link in their email in order to connect to their existing Moodle accounts.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, May 23, 2017, 10:25 AM",
          "AuthorName": "Damyon Wiese",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1337843&course=5",
          "role": [
            "Picture of Damyon Wiese"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "I followed your instructions to the letter, but I get this error message when I try to connect my account: The system account was not connected for offline access",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, May 23, 2017, 4:37 PM",
          "AuthorName": "Dr. Nellie Deutsch",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=72041&course=5",
          "role": [
            "Picture of Dr. Nellie Deutsch"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "You don't need to connect a system account just for logins. The system account is only for things like repository plugins and file conversions (e.g. for google/office stuff).",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, May 24, 2017, 1:58 PM",
          "AuthorName": "Damyon Wiese",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1337843&course=5",
          "role": [
            "Picture of Damyon Wiese"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "Damyon, many thanks for your message. I currently have moodle 3.2.3+ with previous \"auth2\" plugin. Could you please help me with these tips? 1) I have many users created using \"linkedin\", \"facebook\" and Google+\". If I update my moodle to 3.3+, will they be migrated to this new \"Auth2 core\"? 2) If thre's no automatic migration, is there a script \"how-to\" migrate? Thanks in advance. Best regards Filipe",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Sunday, May 28, 2017, 1:24 AM",
          "AuthorName": "Filipe Ferreira",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2164587&course=5",
          "role": [
            "Picture of Filipe Ferreira"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "They will still be able to login - but the first time they do so with the new plugin they will be required to \"confirm\" that they own the email address by clicking a link in an email.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, May 29, 2017, 2:38 PM",
          "AuthorName": "Damyon Wiese",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1337843&course=5",
          "role": [
            "Picture of Damyon Wiese"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "Damyon, good evening! I tried to upgrade my moodle 3.2+ to 3.3+ and non of my services are working (Linkedin, Google and Facebook). Really really bad... could you please help me out? All I get is this message: \"The system account was not connected for offline access\". Urgent!",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/attachment/1432694/error.PNG?forcedownload=1"
          ],
          "Time": "Sunday, July 9, 2017, 12:52 PM",
          "AuthorName": "Filipe Ferreira",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2164587&course=5",
          "role": [
            "Picture of Filipe Ferreira"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "I'm right in the middle of upgrading from 3.1.7 to 3.3.1 and am also switching from using the googleoauth2 plugin to the new core OAuth 2 module. I can confirm that the process works as you've described above. I configured the new OAuth 2 Services with the Google client ID and secret, enabled it and disabled the old plugin. I immediately got a session expired message and had to log in again, and as you described, I received an email asking me to confirm that I wanted to link the account. However, a new and major problem has emerged - sessions expire extremely quickly and I keep having to log in again. Basically, load a page, take a minute to read something, and you're kicked out. I couldn't even complete editing a forum post before I was getting error messages that drafts couldn't be saved. Is there a setting somewhere that also needs to be updated? Because as it stands, this is unusable. --- Les",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Saturday, July 15, 2017, 11:21 AM",
          "AuthorName": "Les Bell",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=23064&course=5",
          "role": [
            "Picture of Les Bell"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "Update: I've now done the following: Updated Site Administration -> Server -> Session handling -> Timeout to 3 hours. (After being timed out once while doing so). Cleared all site-related cookies. Exited the Firefox browser and restarted Completely rebooted the server. Logged in from a different machine, using Chrome rather than Firefox. Nothing worked. Within about a minute, I start to get error messages (\"web service not available\", \"draft could not be saved\", etc.) and the session times out. I've gone back to the old googleoauth2 plugin for the time being, as most of my users prefer to authenticate via OAuth2. At least the system is usable once more, and I can research before, hopefully, switching back to the core module later. Any suggestions gratefully welcomed. --- Les",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Saturday, July 15, 2017, 12:07 PM",
          "AuthorName": "Les Bell",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=23064&course=5",
          "role": [
            "Picture of Les Bell"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "More test changes that didn't solve the problem: The Google API client ID was set up with two authorised redirect URI's: /auth/googleoauth2/google_redirect.php (for the googleoauth2 plugin) /admin/oauth2callback.php (for the new core OAuth 2 support) I created (actually, edited and reused an old) client ID that had only the latter redirect URI. Rebooted the server, cleared the cookies in the browser. No joy. --- Les",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Saturday, July 15, 2017, 12:59 PM",
          "AuthorName": "Les Bell",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=23064&course=5",
          "role": [
            "Picture of Les Bell"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "Dear all, I followed strictly the instructions in this link (as suggested in the previous replies): https://docs.moodle.org/dev/index.php?title=OAuth2_Services_Setup_Project_In_LinkedIn&oldid=52510 (I only had a minor and insignificant issue with finding a suitable\nLinkedIn logo for the button which of course is totally irrelevant to\nsuccess). The migration worked as charm and all my users can now use\ntheir accounts with the core module with no information loss. Thanks a lot to everyone who helped with this issue!",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Sunday, July 16, 2017, 7:36 PM",
          "AuthorName": "Kaloyan Ganev",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2238272&course=5",
          "role": [
            "Picture of Kaloyan Ganev"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "Hi Damyon, I've migrated from v3.1 to v3.3. In the old version I had installed and working with Google authentication the module Auth2. After the migration I've configured the new core auth module and it's working fine. The only problem (as said in this thread) before) is that I had to change in the database the field auth in the table mdl_user. It was googleoauth2 in the previous version and I changed it by auth2 . As you say they receive an email, but system says that it's because the email address in not linked yet. Is there any way to avoid this? It doesn't have any sense to these users because they've been working on the system with the google accounts for years. I've checked the moodle database and I assume there's some relationship with a table called: mdl_auth_oauth2_linked_login. Is there some way that me as Moodle administrator can link all the existing account in a massive way? Thanks PS. I assume this is happening to everybody who is upgrading the version and was using the old module, so it would be great some kind of solution for this.",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1439699/error.PNG"
          ],
          "Time": "Wednesday, August 16, 2017, 8:20 PM",
          "AuthorName": "Alejandro Orviz",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1763659&course=5",
          "role": [
            "Picture of Alejandro Orviz"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "Am just adding 2 cent opinion here .... I would hope that an Admin could NOT massively accomplish this for it would mean that individual (possibly all admins in a Moodle) could change controls/access to etc. for those individuals.    Their accounts ... thus they need to be in control. As an Admin of a Moodle I would NOT want to be taking on the security of their accounts ... unless all individuals involved were part of a Google Edu domain - and I was one of the Google Admins of that domain and authorized to control the Edu domain. IF one looks at such things overall (not just Moodle) ... don't individual owners of an Android, as example, have control over granting permissions?   It's becoming more common place with smartphones and tablets now so would think users may have already had a similar experience. Making a change such as this in a Moodle site should be planned (understatement) and all users informed for weeks of a cutover/change date.    Tutorials for such outside of Moodle with example screen shots, etc. Yes, some will make a mistake ... prepare for it with another set of Tutorials/page info etc. on how to correct the problem. Like I said ... 2 cent opinion. Unless one can figure out how to provide Moodle with the following ... (seen in confirmation link): ﻿ site/auth/oauth2/confirm-linkedlogin.php? a token user id username (which is the Email address) issuer = 1 (which on the site being used has only Google auth configured). And Moodle communicate to Google that it's OK. 'spirit of sharing', Ken",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, August 16, 2017, 10:30 PM",
          "AuthorName": "Ken Task",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=141618&course=5",
          "role": [
            "Picture of Ken Task",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "I'm just going through this at the moment - see my posts earlier in the thread, and since I was logged into MySQL anyway . . . During my migration, I tested creating an account and logging in using a Google ID associated with my university email account. It created a row in mdl_user with the 'confirmed' column set to 0. While I was waiting for the confirmation email to turn up - it went into the spam folder - the account appeared in Site Administration -> Users -> Accounts -> Browse list of users with a \"Confirm\" link at the right end of the line, to allow manual confirmation. When I got the email and went to the confirmation link, the 'confirmed' value went to 1. I also looked at mdl_auth_oauth2_linked_login during this process - it has two columns called 'confirmtoken' and 'confirmtokenexpires', but they stayed blank right through the confirmation process, so I'm not sure how they're involved. Note, though, that this was for the creation of a new oauth2 user account, not migration of an existing googleoauth2 account. So it might be as simple as \n```text\nUPDATE mdl_user SET confirmed = 1 WHERE auth = 'oauth2';\n```\n Or it might not. ;) I'm anxiously watching live logs to see if any of my users experience problems during the migration from googleoauth2 to oauth2, and if worse comes to worst, I might try the above statement as a way of \"pre-authenticating\" them to avoid any problems. --- Les",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Sunday, August 20, 2017, 10:40 AM",
          "AuthorName": "Les Bell",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=23064&course=5",
          "role": [
            "Picture of Les Bell"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Migrating Oauth2 (LinkedIn) users to new core Oauth2",
          "Text": "Hi Les, Please can I ask what the outcome of your test was and whether you got around existing users receiving an email asking them to authenticate their account on the switch from the OAuth Plugin to the Core OAuth? Kind regards, Sarah",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, June 12, 2018, 11:50 PM",
          "AuthorName": "Sarah Ricketts",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1600211&course=5",
          "role": [
            "Picture of Sarah Ricketts"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 369755,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=369755",
      "NoOfResponses": 4,
      "ResponsesInList": [
        {
          "Title": "Moodle with Multi Factor Authentication office365",
          "Text": "Hello everyone, Does anyone already use office365 with Multi Factor Authentication  in moodle? Users with Multi Factor Authentication can not log in to moodle. Has anyone ever had this problem?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, April 25, 2018, 7:43 PM",
          "AuthorName": "Pedro Pacheco",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2236392&course=5",
          "role": [
            "Picture of Pedro Pacheco"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Moodle with Multi Factor Authentication office365",
          "Text": "I use an account with MFA enabled to login to Moodle with OpenID and I never had a problem. To be more specific it is not the MSA from the premium AAD but the free MFA that is available for all O365 global admin, password are also authenticated over my ADFS infrastructure so local user are full SSO and Internet user receive the Microsoft login treatment. So it could definitely work.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, May 17, 2018, 4:33 AM",
          "AuthorName": "Jean-François Marcotte",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2441570&course=5",
          "role": [
            "Picture of Jean-François Marcotte"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Moodle with Multi Factor Authentication office365",
          "Text": "Hello, In order to work the MFA in moodle, was there any specific configuration? Can you be more specific?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, May 17, 2018, 7:10 PM",
          "AuthorName": "Pedro Pacheco",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2236392&course=5",
          "role": [
            "Picture of Pedro Pacheco"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Moodle with Multi Factor Authentication office365",
          "Text": "Hi, I installed the O365 integration folowing these instruction https://docs.moodle.org/34/en/Office365 and it just worked out of the box for me, MFA user could logon as well as non MFA one. Moodle is version 3.4.2 So no there was no MFA specific config to the configuration to make it work on my installation, user logon experience is exactly the same on Moodle as it is for Outlook web acces for example.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, May 17, 2018, 8:27 PM",
          "AuthorName": "Jean-François Marcotte",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2441570&course=5",
          "role": [
            "Picture of Jean-François Marcotte"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 368694,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=368694",
      "NoOfResponses": 5,
      "ResponsesInList": [
        {
          "Title": "Testing multi-tenancy Office 365",
          "Text": "Hi all First, a bit of context , then my question. I work for a group of schools which has a couple of group-wide Moodle installations. We use Office 365/Azure Active Directory for identity management. Each school in our group has a separate tenant in Office 365/Azure AD. I'm trying to set up a testing environment in Azure AD to test out the O365 plugins on our staging environment. When I get to \"Step 3/3: Admin consent & additional information\" of the Office 365 plugin setup, I click the link, it takes me to the O365 signin page, I click to sign in but nothing happens - the signin page stays on 'pick an account' - if I click the account that I set up as admin of Azure (free trial account) the page either just reloads, saying that I am signed in. Anyone else had this issue? I'm currently using my personal old hotmail account for this - I guess it might be worth setting up a new trial O365 account. Any other thoughts? Cheers Chris",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, April 9, 2018, 4:40 PM",
          "AuthorName": "Chris Baldwin",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=707825&course=5",
          "role": [
            "Picture of Chris Baldwin"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Testing multi-tenancy Office 365",
          "Text": "Ok, so I answered my own question - setting up a clean O365 test account worked. I'm now trying to test the multi tenant options - when I click on Multitenancy, I always get 'Please complete the plugin setup process before adding additional tenants.' Even though the plugin is set up and syncing correctly. Any ideas?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, April 9, 2018, 5:53 PM",
          "AuthorName": "Chris Baldwin",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=707825&course=5",
          "role": [
            "Picture of Chris Baldwin"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Testing multi-tenancy Office 365",
          "Text": "Bumping this - any ideas as to why I'm always getting \"Please complete the plugin setup process before adding additional tenants.\" Even though it is set up correctly?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, May 10, 2018, 4:17 PM",
          "AuthorName": "Chris Baldwin",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=707825&course=5",
          "role": [
            "Picture of Chris Baldwin"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Testing multi-tenancy Office 365",
          "Text": "Hi Chris, If it's okay with you, we'd like to move the discussion to the GitHub issue you raised at https://github.com/Microsoft/o365-moodle/issues/247 . Thank you, Zion Brewer",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, May 16, 2018, 3:37 PM",
          "AuthorName": "Zion Brewer",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1977124&course=5",
          "role": [
            "Picture of Zion Brewer"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Testing multi-tenancy Office 365",
          "Text": "Thanks for that. See you there.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, May 17, 2018, 11:44 AM",
          "AuthorName": "Chris Baldwin",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=707825&course=5",
          "role": [
            "Picture of Chris Baldwin"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 368779,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=368779",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "No access to Google Team Drives",
          "Text": "I am just adding a link to a post over on the Repositories forum here as it relates to Google G Suite integration and people may come here rather than the repositories forum... https://moodle.org/mod/forum/discuss.php?d=361641",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, April 10, 2018, 8:25 PM",
          "AuthorName": "Jon Witts",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=89775&course=5",
          "role": [
            "Picture of Jon Witts",
            "Picture of Plugin developers",
            "Picture of Testers"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 368549,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=368549",
      "NoOfResponses": 4,
      "ResponsesInList": [
        {
          "Title": "Moodle office integrations seem to be less useful that I was expecting",
          "Text": "I am a bit confused about the Moodle office integrations. I thought that, at its simplest, the concept was, for example: You have, for example, a Word document in your OneDrive or Google drive or Drop box, that you want to submit as your Assignment. Instead of downloading the file to your desktop, then reuploading it, if you Moodle site admin has set up the right plugins, you can just select the file directly in the file-picker (after logging in to the other system.) What acutally seems to happen is that, for example, a student can only pick a file from OneDrive if it is an institutional onedrive that you are providing to students. If the student is already using a personal onedrive account, they are out of luck. Have I got that right? It seems a bit disappointing if so.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, April 6, 2018, 2:11 AM",
          "AuthorName": "Tim Hunt",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=93821&course=5",
          "role": [
            "Picture of Tim Hunt",
            "Picture of Core developers",
            "Picture of Documentation writers",
            "Picture of Particularly helpful Moodlers",
            "Picture of Peer reviewers",
            "Picture of Plugin developers"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Moodle office integrations seem to be less useful that I was expecting",
          "Text": "student can only pick a file from OneDrive if it is an institutional onedrive that you are providing to students What does make you to think that? When I was involved in testing issues involving OAuth2 and OneDrive, I was able to use normal personal accounts and pick files as expected (IIRC).",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, April 6, 2018, 2:39 AM",
          "AuthorName": "David Mudrák",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1601&course=5",
          "role": [
            "Picture of David Mudrák",
            "Picture of Core developers",
            "Picture of Documentation writers",
            "Picture of Moodle HQ",
            "Picture of Particularly helpful Moodlers",
            "Picture of Peer reviewers",
            "Picture of Plugin developers",
            "Picture of Plugins guardians",
            "Picture of Testers",
            "Picture of Translators"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Moodle office integrations seem to be less useful that I was expecting",
          "Text": "Ah! that is good to know. I don't suppose you remember the number of (or some good terms to search for) a MDL issue with nice clear testing instructions, that makes it clear how to configure this? Thanks.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, April 10, 2018, 12:03 AM",
          "AuthorName": "Tim Hunt",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=93821&course=5",
          "role": [
            "Picture of Tim Hunt",
            "Picture of Core developers",
            "Picture of Documentation writers",
            "Picture of Particularly helpful Moodlers",
            "Picture of Peer reviewers",
            "Picture of Plugin developers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Moodle office integrations seem to be less useful that I was expecting",
          "Text": "MDL-59505 - but the issue does not provide \"nice clear testing instructions, that makes it clear how to configure this\" as that is not the purpose of testing instructions. There are user docs for that. In this particular issue, it would be https://docs.moodle.org/en/Google_Drive_repository https://docs.moodle.org/en/OAuth_2_Google_service https://docs.moodle.org/en/OAuth_2_Microsoft_service",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, April 10, 2018, 12:50 AM",
          "AuthorName": "David Mudrák",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1601&course=5",
          "role": [
            "Picture of David Mudrák",
            "Picture of Core developers",
            "Picture of Documentation writers",
            "Picture of Moodle HQ",
            "Picture of Particularly helpful Moodlers",
            "Picture of Peer reviewers",
            "Picture of Plugin developers",
            "Picture of Plugins guardians",
            "Picture of Testers",
            "Picture of Translators"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 368128,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=368128",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Onenote block & repository for Moodle 3.3?",
          "Text": "Hello, When we will see Onenote block & repository for Moodle 3.3?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, March 28, 2018, 7:19 PM",
          "AuthorName": "Jari Vilkman",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1830157&course=5",
          "role": [
            "Picture of Jari Vilkman"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 364123,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=364123",
      "NoOfResponses": 2,
      "ResponsesInList": [
        {
          "Title": "Facebook login, v3.4: error/Could not upgrade oauth token",
          "Text": "I am getting the same on 3.4 1) existing customers are unable to login to their accounts. Can they link an email id to the a/c created by Fb login? Any way to sidestep Fb login and login? 2) Facebook replied \"Thanks for the additional information - unfortunately we can't support issues that you encounter using 3rd Party Applications which are built on top of the Facebook SDKs. I have gone through the sign up flow on both of your sites. The Facebook Login dialog loads correctly, the permissions are requested and granted. The error occurs after Facebook has successfully granted the user permission to your App and redirects to your website with the authentication details. At this stage it is your redirect URI that is failing to handle the response from Facebook correctly. To get more information on the error and how to resolve it you would be best placed to contact moodle directly. \" Valid OAuth redirect URIs: https://www.website.in/admin/oauth2callback.php https://www.website.in/_oauth2/login.php 3) DEBUG This page did not call $PAGE->set_url(...). Using http://www.website.in/auth/oauth2/login.php?id=1&wantsurl=%2F&sesskey=qBSzh9lz2U Error code: Could not upgrade oauth token $a contents: Stack trace: line 559 of /lib/oauthlib.php: moodle_exception thrown line 473 of /lib/oauthlib.php: call to oauth2_client->upgrade_token() line 44 of /auth/oauth2/login.php: call to oauth2_client->is_logged_in() 4) Unable to connect System Account. What is a system account? I already have a system administrator account. How can I create one? 'Create a new user' is not working.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, January 16, 2018, 9:55 PM",
          "AuthorName": "Rekha C",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1970051&course=5",
          "role": [
            "Picture of Rekha C"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Facebook login, v3.4: error/Could not upgrade oauth token",
          "Text": "You should contact support team",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, March 22, 2018, 8:33 PM",
          "AuthorName": "mark mvps",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2413389&course=5",
          "role": [
            "Picture of mark mvps"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 364581,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=364581",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Moodle One-drive Integration",
          "Text": "Hi, I am currently on Moodle 3.1. and we want to use the OneDrive repository. Our course content developers managed to have the application installed and can access the online version. We activated our OneDrive repositories within Moodle and registered our Moodle site on Micriosoft's App registration Portal. When trying to select pick a file from the OneDrive repository, we get the error below. Please assist, how can this get fixed?",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1470316/MicrosoftErroMessage%20.jpg"
          ],
          "Time": "Thursday, January 25, 2018, 4:16 PM",
          "AuthorName": "Aviwe Foji",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1770953&course=5",
          "role": [
            "Picture of Aviwe Foji"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 348859,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=348859",
      "NoOfResponses": 11,
      "ResponsesInList": [
        {
          "Title": "Difference between link to the file directly and Create an alias/shortcut to the file?",
          "Text": "When linking a file from Onedrive for business what is the difference of link to the file directly and Create an alias/shortcut to the file?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, March 9, 2017, 3:32 PM",
          "AuthorName": "Jari Vilkman",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1830157&course=5",
          "role": [
            "Picture of Jari Vilkman"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Difference between link to the file directly and Create an alias/shortcut to the file?",
          "Text": "Hi Urpo In this link you can find, what is difference between link and alias. https://apple.stackexchange.com/questions/2991/whats-the-difference-between-alias-and-link",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, July 5, 2017, 6:42 PM",
          "AuthorName": "Rahul Rai",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2254760&course=5",
          "role": [
            "Picture of Rahul Rai"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Difference between link to the file directly and Create an alias/shortcut to the file?",
          "Text": "You didn't answer the question Rahul, but presented link to 10 years old thread about Apple file system. It is not helping at all as I myself love to see explanation of difference between link to the file directly and Create an alias/shortcut to the file.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, September 27, 2017, 8:29 AM",
          "AuthorName": "Dublin Design",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2300337&course=5",
          "role": [
            "Picture of Dublin Design"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Difference between link to the file directly and Create an alias/shortcut to the file?",
          "Text": "Hello Dublin and Urpo- are either of you able to post a screenshot of where you see \"link to a file directly or create a alias/shortcut\"? (I don't have OneDrive for Business.)",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, September 29, 2017, 4:38 PM",
          "AuthorName": "Mary Cooch",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=531675&course=5",
          "role": [
            "Picture of Mary Cooch",
            "Picture of Documentation writers",
            "Picture of Moodle HQ",
            "Picture of Particularly helpful Moodlers",
            "Picture of Testers",
            "Picture of Translators"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Difference between link to the file directly and Create an alias/shortcut to the file?",
          "Text": "Hello, 1. Choose a text 2. Click \"make link\" icon from the toolbar https://imgur.com/sHS0jtG 3. In file picker select o365 https://imgur.com/7GPGeWU 4. Click some file 5. Now you can see all three options. https://imgur.com/a/1kBmv",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, September 29, 2017, 5:19 PM",
          "AuthorName": "Jari Vilkman",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1830157&course=5",
          "role": [
            "Picture of Jari Vilkman"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Difference between link to the file directly and Create an alias/shortcut to the file?",
          "Text": "I haven't been able to replicate all three of these settings together on my OneDrive, but I have been able in other places to get link to a file/make a copy and create an alias/shortcut (plus with 3.3 assignments, also 'Create an access controlled link') I am going to speculate that Link to the file directly means exactly that -as with this option in Wikimedia, it will take you straight to the place where that file lives, in your case, to your OneDrive account, which would then imply any users would need access rights to it. I speculate that 'make a shortcut/alias' is done within Moodle so there are no access issues, and of course, if you change the file in your OneDrive then it will change for all instances of the shortcut. It would be useful if someone else with a OneDrive business account could actually test out both options to see",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/theme/image.php/moodleorg/core/1763488129/s/smiley"
          ],
          "Time": "Friday, September 29, 2017, 6:54 PM",
          "AuthorName": "Mary Cooch",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=531675&course=5",
          "role": [
            "Picture of Mary Cooch",
            "Picture of Documentation writers",
            "Picture of Moodle HQ",
            "Picture of Particularly helpful Moodlers",
            "Picture of Testers",
            "Picture of Translators"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Difference between link to the file directly and Create an alias/shortcut to the file?",
          "Text": "Hi Mary - apologies for late response, new Academic Year about to start this Monday and we are very busy here. We want to store big files on Dropbox could - but when selecting file there are 3 options and it's not clear how they work: 1 - \"Make  copy of the file\" - this I presume just copy file from Dropbox to local Moodle depositort - WE DON'T WANT THIS! 2 - \"Link to the file directly\" - this I presume means that file stays on Dropbox and only link to the file will be located on Moodle? For some reason this option is not available only in Description ? 3 - \"Create an alias/shortcut to the file\" - this one is confusing and we are not sure what is a difference between this and number 2 (Link to file)? I presume file stays on Dropbox and link (shortcut) is added to Moodle ? As I said we dont want to copy files to Moodle, just link them.",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1449011/dropbox_file_MAKE-A-COPY.png",
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1449011/dropbox_file_LINK-TO-FILE.png",
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1449011/dropbox_file_CREATE-AN-ALIAS.png"
          ],
          "Time": "Saturday, September 30, 2017, 8:17 AM",
          "AuthorName": "Dublin Design",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2300337&course=5",
          "role": [
            "Picture of Dublin Design"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Difference between link to the file directly and Create an alias/shortcut to the file?",
          "Text": "Also if I try to add same file \"as Attachment\" there are only 2 options instead of 3. As we dont want to copy files to Moodle (file size issue) we hope \"Create an alias/shortcut\" creates only links, am I right?",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1449012/dropbox_file_2-OPTIONS-ONLY.png"
          ],
          "Time": "Saturday, September 30, 2017, 8:26 AM",
          "AuthorName": "Dublin Design",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2300337&course=5",
          "role": [
            "Picture of Dublin Design"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Difference between link to the file directly and Create an alias/shortcut to the file?",
          "Text": "In the documentation on Working with files there is a section on shortcut/alias. I suggest for your purposes you would use this option rather than either of the others.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Saturday, September 30, 2017, 4:38 PM",
          "AuthorName": "Mary Cooch",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=531675&course=5",
          "role": [
            "Picture of Mary Cooch",
            "Picture of Documentation writers",
            "Picture of Moodle HQ",
            "Picture of Particularly helpful Moodlers",
            "Picture of Testers",
            "Picture of Translators"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Difference between link to the file directly and Create an alias/shortcut to the file?",
          "Text": "My basic concern is which option let us save space on our Moodle. Does \"Create an alias/shortcut to the file\" option make copy of file on Moodle or just link it? We have hundreds of animation files we would rather store them on Dropbox and link to Moodle. They wont be altered so no alias option is needed .",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Sunday, October 1, 2017, 12:59 AM",
          "AuthorName": "Dublin Design",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2300337&course=5",
          "role": [
            "Picture of Dublin Design"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Difference between link to the file directly and Create an alias/shortcut to the file?",
          "Text": "I can confirm that the alias/shortcut does not copy the file to moodle so you won't need to worry about space. I'd be interested to know how you are getting on with this as we are exploring it in our dev environment for our next upgrade (to 3.4)",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, November 20, 2017, 7:08 PM",
          "AuthorName": "Sally Hanford",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2081964&course=5",
          "role": [
            "Picture of Sally Hanford"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 359478,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=359478",
      "NoOfResponses": 2,
      "ResponsesInList": [
        {
          "Title": "Does Moodle 3.3 currently support the Office 365 Plugin Set?",
          "Text": "I’m\njust wanting to clarify the supported versions of Moodle that work with the\nOffice365 plugin Set, this is in reference to the Moodle Documentation: https://docs.moodle.org/33/en/Office365 Under\nSection 5.1 Installation it gives a link to the Moodle Plugins directory to download the plugins & a link to the Office\n365 Plugin set When\nyou go to the Office 365 Plugin Set link it shows the plugins and only 1\nplugin specifically says it is supported in Moodle 3.3 which is oEmbed\nFilter . Plugins:                                               \n               \nSupported Moodle Versions Microsoft\nOffice 365\nIntegration              \n3.1 , 3.2 OpenID\nConnect                              \n               \n3.1 , 3.2 Office\n365\nRepository                                   \n3.1 , 3.2 oEmbed\nFilter                                                  \n3.1 , 3.2 , 3.3 Microsoft\nBlock                                                \n3.1 , 3.2 I\njust wanted to double check if the plugins work with Moodle 3.3 or if they\ndon’t actually work and they are still being developed, if they are still being\ndeveloped does anyone know when they will be released? Thanks for your support,",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, October 4, 2017, 10:51 AM",
          "AuthorName": "Simeon Hemus",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2318168&course=5",
          "role": [
            "Picture of Simeon Hemus"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Does Moodle 3.3 currently support the Office 365 Plugin Set?",
          "Text": "The new integration for OAuth2, which includes office365, google, facebook etc that's in 3.3 was not built to work with these plugins. It was build to add the the baseline features of single sign on, document permission and assignment workflow into Core Moodle. So I'm not sure if the Office365 plugin Set have been updated to work with 3.3, or not.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, November 15, 2017, 2:28 AM",
          "AuthorName": "Karen Holland",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1349863&course=5",
          "role": [
            "Picture of Karen Holland",
            "Picture of Core developers",
            "Picture of Plugin developers",
            "Picture of Testers"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 361126,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=361126",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Autosubsription of calendars",
          "Text": "Hi, At our university, we use Office 365 integration, and one great thing is the ability to sync events into the Office 365 calendar. But we have to advice each individual to 1) activate this by ticking off \"Enable Outlook Calendar Sync\", 2) After that, go in to \"Outlook Calendar sync settings\" and tick of all courses, 3) Every time they get enrolled in a new course, the have to go to \"Outlook Calendar sync settings\" and tick of the new courses. So out question is, is it possible somehow to autosubscribe everybody to the courses they are enrolled in? If so, I'd love to know how If not, I'd suggest to add this feature. E.g. by 1. Having an option under \"Outlook Calendar sync settings\" where it is possible to tick of \"Auto subscribe to all course\" or to \"new\" courses or something similar (when \"Enable Outlook Calendar Sync\" is ticked). 2. Having a setting for the site, saying that it is possible to choose whether \"Enable Outlook Calendar Sync\" and the mentioned feature from 1 are automatically enabled for new users. I know that other people also have been asking for something similar - if this is not the right forum to ask, then have me excused and point me to the right place",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/theme/image.php/moodleorg/core/1763488129/s/smiley",
            "https://moodle.org/theme/image.php/moodleorg/core/1763488129/s/smiley"
          ],
          "Time": "Tuesday, November 7, 2017, 8:04 PM",
          "AuthorName": "Gunnar Restorff",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1554685&course=5",
          "role": [
            "Picture of Gunnar Restorff"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 358018,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=358018",
      "NoOfResponses": 2,
      "ResponsesInList": [
        {
          "Title": "Google Drive Not Showing All files/folders",
          "Text": "Is there a known issue with Google Drive not showing all files or folders when browsing using the repository? If there is no issue I would like to show that many of our users are reporting they do not see all of their files or folders when browsing.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, September 7, 2017, 2:56 AM",
          "AuthorName": "Chris Kenniburg",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=26675&course=5",
          "role": [
            "Picture of Chris Kenniburg",
            "Picture of Plugin developers"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Google Drive Not Showing All files/folders",
          "Text": "Apparently there is a time limit where when browsing files/folders it only shows most recent items.  A folder which was last modified 3 years ago was not displayed until I renamed it.  Even though files within the folder were very new.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, September 7, 2017, 3:39 AM",
          "AuthorName": "Chris Kenniburg",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=26675&course=5",
          "role": [
            "Picture of Chris Kenniburg",
            "Picture of Plugin developers"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 346085,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=346085",
      "NoOfResponses": 32,
      "ResponsesInList": [
        {
          "Title": "Community Meeting re: Office integrations",
          "Text": "Hi all, Having looked at what the community has done for Google Apps, and Office 365 - we have been doing some brainstorming in HQ about a core implementation. We have some ideas we would like to discuss so are holding an open meeting for the community to attend this Wednesday. Its very hard to select one time that suits everyone so hopefully this will cover most. We will be using ZOOM for the discussion, which works on all devices. Date: Jan 25, 2017 4:00 PM GMT This is at 8am PST , 11am EST , 4pm GMT , and midnight in Perth You can join from PC, Mac, Linux, iOS or Android: https://zoom.us/j/604102893 We look forward to seeing you there.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, January 19, 2017, 11:33 AM",
          "AuthorName": "Damyon Wiese",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1337843&course=5",
          "role": [
            "Picture of Damyon Wiese"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "Hi Damyon, The early specs look really good. How certain is it that this will be developed for 3.3? Cheers, Fred",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, January 30, 2017, 10:14 AM",
          "AuthorName": "Frederic Nevers",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=234677&course=5",
          "role": [
            "Picture of Frederic Nevers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "Just confirming - the requirements for this project and some info on the implementation is listed in this document: https://docs.moodle.org/dev/Better_Office_Integrations_3.3 This has been updated based on the feedback we got from the community meeting - thanks to all who attended. We will be starting work on this project soon. If anyone has feedback or questions - please reply to this thread.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, February 1, 2017, 11:54 AM",
          "AuthorName": "Damyon Wiese",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1337843&course=5",
          "role": [
            "Picture of Damyon Wiese"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "Some extra REQs / comments: REQ 2: This spec seems to very heavily lean on plain OAuth which I'd question a little bit given that it's only an access protocol and not an identity protocol. It would be better to use the superset protocol OIDC instead. REQ 4: I'd add the extra requirement that an admin should be able to set this up so a student doesn't need to approve the connection. This is mostly external to moodle, but it's critical to the user experience so needs to be possible and documented. REQ 6: As above, if the admin has auto-approved this across a domain you shouldn't be able to manage this (or even see this?). REQ 11: Please not google search, it should be deterministic and not require internet. eg it could detect strings from lorem ipsum. This should be coverable by behat.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, February 1, 2017, 1:34 PM",
          "AuthorName": "Brendan Heywood",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=6290&course=5",
          "role": [
            "Picture of Brendan Heywood",
            "Picture of Core developers",
            "Picture of Peer reviewers",
            "Picture of Plugin developers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "REQ 11: it may be that crot plugin is doing what we need here, have a look at https://moodle.org/plugins/plagiarism_crot",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, February 1, 2017, 11:47 PM",
          "AuthorName": "Tomasz Muras",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=353008&course=5",
          "role": [
            "Picture of Tomasz Muras",
            "Picture of Core developers",
            "Picture of Particularly helpful Moodlers",
            "Picture of Plugin developers",
            "Picture of Plugins guardians",
            "Picture of Translators"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "Can you clarify point 3 in REQ 2 please? From my interpretation of it you'd have this situation: a student who has an existing Moodle account provided by the university clicks on \"login with Office 365\", authenticates successfully and - as Moodle can't match these OAuth details to an existing account - gets a new Moodle account. In that case, I'd expect the student to be given the option to log in to their existing account and link the OAuth details to it. I guess it depends on the meaning of \"matching\" in this context , and I may well be misinterpreting that as some kind of automated thing, so some clarification would be useful.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, February 1, 2017, 6:01 PM",
          "AuthorName": "Michael Aherne",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=599107&course=5",
          "role": [
            "Picture of Michael Aherne",
            "Picture of Core developers",
            "Picture of Peer reviewers",
            "Picture of Plugin developers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "Hi, I may have missed it but I could not find anything in the specs about grading/annotating files stored in the office suite (e.g. G Suite or Office 365). Will there be provision for documents to be marked using the Moodle grading interface? This would be most useful for organisations that use advanced grading methods, such as rubrics or advanced grading for example. Cheers, Fred",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, February 2, 2017, 8:01 AM",
          "AuthorName": "Frederic Nevers",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=234677&course=5",
          "role": [
            "Picture of Frederic Nevers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "Based on the townhall the goal was to have a minimum viable product integration. I think grading while nice was not considered MVP.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, February 3, 2017, 12:59 AM",
          "AuthorName": "Jason Hardin",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=265574&course=5",
          "role": [
            "Picture of Jason Hardin"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "Hi Jason, Thanks for the response. That would be a real shame, as from a teaching/learning perspective being able to 'close' the feedback loop is an absolute must. Does anyone know how teachers will be able to feedback on documents submitted by students? I assumed that the documents uploaded by students would be converted to PDF, to make them accessible to the plagiarism plugins (for example), and that they would sit nicely in the Moodle grading interface but it seems my assumption was incorrect. If the ability to give feedback easily, and in a manner that is familiar to Moodle users is not available, I am worried this project will be a lot less exciting and useful from a teacher's standpoint. Cheers, Fred",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, February 3, 2017, 4:59 AM",
          "AuthorName": "Frederic Nevers",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=234677&course=5",
          "role": [
            "Picture of Frederic Nevers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "With the recent issues related to PDF Annotations in grading, decided to seek what might be 'out there' in Google La-La-Land which could possibly be an alternative to grading in Moodle. Have setup a GCE Moodle site and have been working on limited Moodle\nintegration with Google.  Google doesn't offer a 'Classroom' for\nindividuals and only those entities that qualify for a Google EDU Domain\ncan set up Classroom (I think).   Google Classroom, BTW , is worth keeping an eye on ... IMHO . Ran across a site and GDocs addon called ﻿ Kaizen. Kaizena https://kaizena.com/ A Japanese philosophy of continuous improvement. Might want to watch these first: Wonder if the folks at Kaizena would be interested, if someone approached, about collaborating on a Moodle 'plugin'? The way I see things ... Moodle has grown too monolithic and needs to start looking into microservices. 'spirit of sharing', Ken",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Sunday, February 5, 2017, 11:08 PM",
          "AuthorName": "Ken Task",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=141618&course=5",
          "role": [
            "Picture of Ken Task",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "Canvas integrating Google Apps for Education (GAFE) using LTI , is what inspired my to develop a new Google drive resource module . Hope Google will add LTI support to their Education account, which will enable Moodle and other LMS systems integrate and use it more easily.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, February 7, 2017, 5:40 PM",
          "AuthorName": "Nadav Kavalerchik",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=383231&course=5",
          "role": [
            "Picture of Nadav Kavalerchik",
            "Picture of Core developers",
            "Picture of Plugin developers",
            "Picture of Testers",
            "Picture of Translators"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "I'd like to explore if O365 video could be included in some future iteration - the functionality of O365 video is similar to that of 3rd party providers like Kaltura and would be a great way of ensuring moodle can handle video content in a sensible way.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, April 14, 2017, 4:13 PM",
          "AuthorName": "Sally Hanford",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2081964&course=5",
          "role": [
            "Picture of Sally Hanford"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "Sensible would be to stick with Kaltura.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Saturday, April 15, 2017, 5:12 AM",
          "AuthorName": "Rob Bosch",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2176286&course=5",
          "role": [
            "Picture of Rob Bosch"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "Can we confirm that as part of this work the Office 365 and G Suite integrations are going to be created? Or is this project just to create the hooks so that other projects can create the actual integrations using the hooks?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, February 3, 2017, 12:57 AM",
          "AuthorName": "Jason Hardin",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=265574&course=5",
          "role": [
            "Picture of Jason Hardin"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "Hi Jason, Did you ever find out? I am looking for exactly the same answer. Cheers, Fred",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, February 7, 2017, 10:57 AM",
          "AuthorName": "Frederic Nevers",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=234677&course=5",
          "role": [
            "Picture of Frederic Nevers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "This project includes the work to make those 2 integrations.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, February 7, 2017, 1:23 PM",
          "AuthorName": "Damyon Wiese",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1337843&course=5",
          "role": [
            "Picture of Damyon Wiese"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "Perfect. Thank you for the clarification. Cheers, Fred",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, February 7, 2017, 2:17 PM",
          "AuthorName": "Frederic Nevers",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=234677&course=5",
          "role": [
            "Picture of Frederic Nevers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "I'm gonna go out on a limb and predict that Dropbox Paper will quickly become the third major player in this space, even though it was only fully released a couple weeks ago. I've been pretty impressed with it so far. I'm not saying it should be supported straight up by moodle but I think it would be prudent to make sure it can fit as well into the overall architecture as 365 and GDocs would. https://paper.dropbox.com/ https://www.dropbox.com/developers/documentation/http/documentation#paper",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, February 13, 2017, 6:21 AM",
          "AuthorName": "Brendan Heywood",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=6290&course=5",
          "role": [
            "Picture of Brendan Heywood",
            "Picture of Core developers",
            "Picture of Peer reviewers",
            "Picture of Plugin developers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "Work has started on this project. The first piece is a new OAuth 2 (and OpenID Connect) authentication plugin and a core configuration page for managing OAuth 2 services including setting up a \"system account\" for Moodle (and getting refresh tokens). A prototype is available here: https://prototype.moodle.net/office/",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, February 28, 2017, 11:20 AM",
          "AuthorName": "Damyon Wiese",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1337843&course=5",
          "role": [
            "Picture of Damyon Wiese"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "That is fantastic news! Very excited about this development. Can I confirm that the tracker is at https://tracker.moodle.org/browse/MDL-57794? I would like to make sure I follow development very closely. Cheers, Fred",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, February 28, 2017, 12:57 PM",
          "AuthorName": "Frederic Nevers",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=234677&course=5",
          "role": [
            "Picture of Frederic Nevers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "Yes that is the Epic for this project and all work will be done on issues within that Epic.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, February 28, 2017, 1:51 PM",
          "AuthorName": "Damyon Wiese",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1337843&course=5",
          "role": [
            "Picture of Damyon Wiese"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "I re-read my last post and it is a bit unclear - what it means is you get \"Login using Google/Facebook/Microsoft\" buttons on the login page and you can configure it to work with many other login systems on the web without installing new plugins etc.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, February 28, 2017, 1:53 PM",
          "AuthorName": "Damyon Wiese",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1337843&course=5",
          "role": [
            "Picture of Damyon Wiese"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "Progress update: Most of the work is completed and the prototype just received a major upgrade. Both core repository plugins (Google Drive and Microsoft OneDrive) have been overhauled and work with the new OAuth 2 services. The testing instructions for https://tracker.moodle.org/browse/MDL-58220 are very detailed and explain the new functionality. The most significant feature is that there is a new file type that repositories can support which is a \"controlled link\". It is a link to a file - but at the time it is added to Moodle - the original resource is copied into an account owned by the Moodle system. Moodle then grants read and (temporary) write access to the link when it is accessed - based on the permissions in Moodle.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, March 16, 2017, 11:17 AM",
          "AuthorName": "Damyon Wiese",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1337843&course=5",
          "role": [
            "Picture of Damyon Wiese"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "@Damyon Can the work in https://tracker.moodle.org/browse/MDL-58220 be helpful also for my request in https://moodle.org/mod/forum/discuss.php?d=349255 ? Thanks!",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, March 16, 2017, 11:32 PM",
          "AuthorName": "Roberto Catanuto",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2077652&course=5",
          "role": [
            "Picture of Roberto Catanuto"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "Hi Damyon, Thank you for the hard work. I have tested the system a little bit as a teacher and student, and I have a few questions/comments. The login with OAuth, addition of files from Google Drive, etc. all worked well. When I added a file from Google Drive, I was expecting the file to then show in a 'Google Doc' frame inside Moodle, so that if I wanted to continue editing the document - then I could (e.g. similar to the work Nadav has done). Instead a simple link to the Google document is presented to the user. Is what I experienced the expected behaviour? In an assignment, if a student uses a Google Doc as their submitted document, the left-panel of the grading interface attempts to convert the document into a PDF/image to launch the Moodle PDF annotator. Is there a way to only show a Google Doc editor on the left-panel instead, so that the teacher has access to the full set of Google tools for commenting, and the power of Moodle rubrics (and other Moodle grading goodness) at the same time? That way, teachers have access to the best of both worlds. Cheers, Fred",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Sunday, March 19, 2017, 8:41 AM",
          "AuthorName": "Frederic Nevers",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=234677&course=5",
          "role": [
            "Picture of Frederic Nevers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "Some Google related news ... \" Classroom is now available for users with personal Google accounts, such\nas homeschoolers, tutoring programs, lifelong learners, and others who\naren’t associated with a school. \" https://support.google.com/edu/classroom/answer/6149237?hl=en&ref_topic=7175444 'spirit of sharing', Ken",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Saturday, March 18, 2017, 12:17 AM",
          "AuthorName": "Ken Task",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=141618&course=5",
          "role": [
            "Picture of Ken Task",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "I am not that familiar (yet) with Moodle. As I am more a tech guy than a teacher, I would love to see the embracement of opensource options when it comes to extra functionality. Therefor, I would suggest to have the option open for Collabora online: the libreoffice online solution. (or similar) NextCloud already has the option for collabora online. If Moodle could go that direction it would mean that the opensource background of Moodle stays open for external solutions too. Links: https://www.collaboraoffice.com/code/ https://hub.docker.com/r/collabora/code/",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, March 20, 2017, 5:17 AM",
          "AuthorName": "Rob Bosch",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2176286&course=5",
          "role": [
            "Picture of Rob Bosch"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "Rob, I couldn't agree more.    Follow MDL-58943",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, May 16, 2017, 12:42 AM",
          "AuthorName": "Martin Dougiamas",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1&course=5",
          "role": [
            "Picture of Martin Dougiamas",
            "Picture of Core developers",
            "Picture of Documentation writers",
            "Picture of Moodle HQ",
            "Picture of Particularly helpful Moodlers",
            "Picture of Plugin developers",
            "Picture of Testers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "Thanks for the pointer. following the issue (and voted for it)",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, May 16, 2017, 1:22 AM",
          "AuthorName": "Rob Bosch",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2176286&course=5",
          "role": [
            "Picture of Rob Bosch"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "This forum post has been removed",
          "Text": "The content of this forum post has been removed and can no longer be accessed.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "N/a",
          "AuthorName": "N/a",
          "AuthorMoodleLink": "N/a",
          "role": [],
          "IsInitialPost": false
        },
        {
          "Title": "回复: Re: Community Meeting re: Office integrations",
          "Text": "Onlyoffice may be a better choice than Collabora.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, May 16, 2017, 9:48 AM",
          "AuthorName": "wz z",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=250778&course=5",
          "role": [
            "Picture of wz z"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Community Meeting re: Office integrations",
          "Text": "Damyon, Do you know if there will be another set of work planned for 3.4 that will continue to make improvements to this and continue to add more of the functionality in the specification?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, April 10, 2017, 8:56 PM",
          "AuthorName": "Jason Hardin",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=265574&course=5",
          "role": [
            "Picture of Jason Hardin"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 356350,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=356350",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "office 365 integration",
          "Text": "error when i am trying to connect moodle with office 365 (Please configure OpenID Connect client credentials.) help plz..",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, August 3, 2017, 3:27 PM",
          "AuthorName": "khan jee",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2240533&course=5",
          "role": [
            "Picture of khan jee"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 355787,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=355787",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Moodle 3.3. Google integration - non-matching email addresses",
          "Text": "Hi, At our institution, users have different email addresses for their AD and Google accounts. Their main Moodle email address is the one stored in AD e.g. 12345678@student.school.edu and the Google email address is *nearly* the same, but not quite e.g. 12345678@google.school.edu. We store the Google email address in a custom Moodle profile field. I am able to set up a Google OAuth2 service successfully, but there is an issue when users attempt to login to Moodle using their Google account, as the email addresses don't match. To avoid this issue, I probably *could* change the main email addresses stored in Moodle to the Google ones, but I am concerned this will cause more issues than it solves (Moodle is integrated with more services than just Google). Also, it would affect the way Moodle accounts are created and maintained. Does anyone know if there is a way to avoid this issue? Perhaps by specifying an 'alternate email' address in the OAuth services. Cheers, Fred",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, July 21, 2017, 2:47 PM",
          "AuthorName": "Frederic Nevers",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=234677&course=5",
          "role": [
            "Picture of Frederic Nevers"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 350091,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=350091",
      "NoOfResponses": 3,
      "ResponsesInList": [
        {
          "Title": "Azure integration with Moodle",
          "Text": "Hello all, I am attempting to do azure integration with moodle, I have followed the guide here https://docs.moodle.org/32/en/Office365 but I cannot for the life of me get the Set Api User function to work. It proceeds to the correct tenancy asking me to log in, and then authorise but then returns me to moodle with a general error. The debug error is: auth_oidc\\oidcclient::tokenrequest:252: Bad response received Data: (string)Could not resolve host : login.microsoftonline.com Any ideas?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, March 30, 2017, 10:52 PM",
          "AuthorName": "Ian Williams",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=639081&course=5",
          "role": [
            "Picture of Ian Williams"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Azure integration with Moodle",
          "Text": "Looks like you're having the same issue as me, even though on very rare occasions I managed to get API system user to log in but would fail again after that. I'm leaning to the possibility of routing issues. As our moodle server is stored on a VM that directs through our Sophos firewall to our internet connection then to our WAN which then goes through another firewall to another internet connection and finally out to the big bad world. I'm hoping to take a copy of our moodle server off site without any of this in the mix to test it as the issue.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, April 18, 2017, 10:57 AM",
          "AuthorName": "Shannon Talbot",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1989029&course=5",
          "role": [
            "Picture of Shannon Talbot"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Azure integration with Moodle",
          "Text": "Hi Azure Maybe this link help you. https://moodle.org/plugins/auth_azuread",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, July 5, 2017, 6:30 PM",
          "AuthorName": "Rahul Rai",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2254760&course=5",
          "role": [
            "Picture of Rahul Rai"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 349651,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=349651",
      "NoOfResponses": 2,
      "ResponsesInList": [
        {
          "Title": "Office 365 session dont close when session expired in Moodle",
          "Text": "Please help, when the moodle session expired, dont close the Office 365 session. If you press f5 can connect again without login. Information: Moodle 3.1.4.+ / auth_oidc 3.1.0.4. Login flow: Username/Password Authentication",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, March 23, 2017, 6:22 AM",
          "AuthorName": "Victor Vera",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1872281&course=5",
          "role": [
            "Picture of Victor Vera"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Office 365 session dont close when session expired in Moodle",
          "Text": "Hi Victor Please find below link maybe helpful. https://support.office.com/en-us/article/Session-timeouts-for-Office-365-37a5c116-5b07-4f70-8333-5b86fd2c3c40",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, June 29, 2017, 6:31 PM",
          "AuthorName": "Rahul Barpha",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2205202&course=5",
          "role": [
            "Picture of Rahul Barpha"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 346452,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=346452",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Configuring Office 365 integration",
          "Text": "Hi, At our site we are currently in the process of integrating the office 365 plugins into moodle V3.0 Currently we have office 365 logins enabled and can use our Azure AD to login to moodle fine. The issue is when our test user tries to Submit/Save a onenote assignment they get a \"Error reading from Database \" They can click on the onenote link and it will successfully create a page in a notebook for that user. Expanding on this with the debugging we get the following: Table \"onenote_assign_pages\" does not exist. I'm pretty certain its moodle side as everything else is working fine. As for how to resolve this issue, should I manually create this table? if so what permissions to what database user? Thanks for any assistance.",
          "HasImageInpost": true,
          "ImagesInPost": [
            "https://moodle.org/pluginfile.php/2541971/mod_forum/post/1397141/Error.JPG"
          ],
          "Time": "Thursday, January 26, 2017, 10:45 AM",
          "AuthorName": "Dion McGovern-Allen",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2193353&course=5",
          "role": [
            "Picture of Dion McGovern-Allen"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 346429,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=346429",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Microsoft Block Office 365 Link",
          "Text": "This is a development on the classic problem of institutions having to change user login names. In this particular university: we use LDAP authentication for Moodle we setup the Office 365 integration, but did not change the authentication method we use the Microsoft Block on the dashboard to manually link to Office 365 My question is this:  what will happen to the established link if the username for the account changes in Active Directory? This can happen with a marriage/divorce, or an adoption, for example. The username and email address will change for authentication, but will we have to make sure the old account is un-linked in Moodle first? Otherwise, with a different username, Moodle may report that that the account is already linked. Related to that, is there a way to view all linked accounts in the Office 365 Integration local plugin?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, January 26, 2017, 12:41 AM",
          "AuthorName": "Bryce Holland",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=436285&course=5",
          "role": [
            "Picture of Bryce Holland"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 339425,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=339425",
      "NoOfResponses": 8,
      "ResponsesInList": [
        {
          "Title": "Google Apps One Login Plugin",
          "Text": "Is there a one login from Google apps for education that currently works for Moodle 3.0+ or 3.1?  I have searched and found that the links on the Moodle Docs page direct to pages that no longer exist. Thanks!",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, September 7, 2016, 10:54 PM",
          "AuthorName": "Jason Touw",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1860221&course=5",
          "role": [
            "Picture of Jason Touw"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Google Apps One Login Plugin",
          "Text": "Mind providing those links that are broken? I seem to re-call someting for version 1.9 that did indeed work, but since Google now has Google Classroom, development on a Moodle SSO and greater integration seems to have lost interest. However, there is a plugin that does work ... I do use it. https://moodle.org/plugins/auth_googleoauth2 May not require much on the Moodle end *IF* your school has GAFE and syncs users in GAFE via LDAP but due how either/both handles user accounts, the time to do this 'conversion' would have been before the current school year started. The above plugin, for example, would allow students to login using Google credentials but that would create a new user in Moodle whose actual username is social_user_# and not (for example) john.jones (student login like in LDAP).   So this student (in the example) would actually have two accounts in Moodle ... as the year has begun and student accounts have been either manually assigned student role in courses or students have enrolled themselves.   Any work, assignment submissions, etc. would be associated with old account and not new. Google uses EMail addresses where as Moodle doesn't by default. It would be possible, however, to set install the auth plugin, then manipulate a CSV dump of student users on your system to change the fields that need to be changed ... same sort of thing done when entity has accounts already in Moodle and want to switch to LDAP. Comment: for schools that have 'gone google' it is the way to go IF continuing to use Moodle. 'spirit of sharing', Ken",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, September 8, 2016, 1:07 AM",
          "AuthorName": "Ken Task",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=141618&course=5",
          "role": [
            "Picture of Ken Task",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Google Apps One Login Plugin",
          "Text": "Hi Ken, The link to the original docs page is https://docs.moodle.org/31/en/Google_Apps_Integration . The outdated links referenced in the documentation are https://github.com/cthernandez/moodle-google-apps/tree/master/blocks/gmail and https://moodle.org/plugins/auth_onelogin_saml The latter still sends you to a plugin, but the plugin is very outdated. Thanks for looking!",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, September 8, 2016, 1:45 AM",
          "AuthorName": "Jason Touw",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1860221&course=5",
          "role": [
            "Picture of Jason Touw"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Google Apps One Login Plugin",
          "Text": "Docs page says this: Credentials stored in Google Users can login to Moodle using the Google Apps stored credentials\nthrough OAuth2 sign in method. Remember that OpenID 2.0 authentication\nmethod is deprecated and it has been migrated to OAuth 2.0 (OpenID\nConnect). In this case user and mail fields must match in both\nplatforms. Moodle has a third party plugin that has been already\nconfigured to support Google Apps service. The auth plugin link provided to you earlier does use Google Oath2 for authentication. The entire package you found was supposedly supported up to version 2.5+ of Moodle from what I've read of it and included a GMail block.   Nice little feature but not really necessary ... one could create an HTML block OR use drop down menus for school district (GAFE) links. Don't think they'd mind ... here's a link to an ISD that has GAFE domain for the ISD. http://eagles.wisd.net/moodle2/ Note at the top the drop down menus which all point to the ISD Google Domain.  Login does use the auth plugin previously shared.   That doesn't really restrict attempts to login with gmail.com creditials but due the restriction of acceptable EMail domains, a student cannot use their private gmail.com account or hotmail.com or aol.com or other ... must use the Google ISD Domain account. Admin of Google domain gets a notification/request to allow user X with a gmail.com addy or other addy to join the Moodle.   Not a bad thing as this is also a way parents could gain access.   Admin user would have to setup a parent role and assign parent accounts that role so they could only monitor their childs work/courses, etc..  and not participate in activities . I also lurk on the Google Group for Google Classroom.    Been interesting to watch as teachers using GC ask if features could be added that Moodle has had for some time now. Anyway, advantage of using Google Auth for a Moodle means very few files need to be stored in Moodle .... even the videos could be stored in Google Drive and linked to with special permissions like, 'users from domain only'.   Storage is unlimited. Do give up controls over players of multimedia, but you won't miss them. Backups of courses are reduced greatly but they are not 100% restorable to other Moodle servers that are not part of the same ISD Google Domain. Besides that, no teacher or student needs to have a computer or device that has any commercial office suite or viewers installed.    Thus saving tons of $$$ $$'s.   All of what is done is done inside a browser and can be done on smartphones as well as tablets. For an example of  a site that's google but more open ... no ISD domain, go to any of the sandbox sites on: http://sos.tcea.org/ They all allow Google Oath 2 authentication.  If you want to see what it looks like as a teacher, let me know ... and have been known to grant users seeking temporary admin levels to see the backend ... as long as they promise NOT to break it! ;) So your pursuit of Google integration is worth the effort and time. It is, for all practical purposes, single sign on *but* NOT signout - which is the only thing I've found lacking.   That's why the sanboxes have a Google SignOut link in drop down menus. 'spirit of sharing', Ken",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, September 8, 2016, 5:19 AM",
          "AuthorName": "Ken Task",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=141618&course=5",
          "role": [
            "Picture of Ken Task",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Google Apps One Login Plugin",
          "Text": "Hi Ken, I didn't realize the OAuth2 plugin could be used for creating a google sign in to moodle. I do have that plug in and I want to get started on building the login, because as you said, we are one of the schools that has gone all google for the students (faculty uses google, but now Office 365 is quickly gaining momentum). I'll need step by step directions on how to set that up. Is there anywhere in the docs that someone already wrote it? We do have a working google developer account with API for noodle if that at all helps. Thanks! jason",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Saturday, September 17, 2016, 8:34 PM",
          "AuthorName": "Jason Touw",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1860221&course=5",
          "role": [
            "Picture of Jason Touw"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Google Apps One Login Plugin",
          "Text": "Hi Ken, I didn't realize the OAuth2 plugin could be used for creating a google sign in to moodle. I do have that plug in and I want to get started on building the login, because as you said, we are one of the schools that has gone all google for the students (faculty uses google, but now Office 365 is quickly gaining momentum). I'll need step by step directions on how to set that up. Is there anywhere in the docs that someone already wrote it? We do have a working google developer account with API for noodle if that at all helps. Thanks! jason",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Saturday, September 17, 2016, 8:34 PM",
          "AuthorName": "Jason Touw",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1860221&course=5",
          "role": [
            "Picture of Jason Touw"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Google Apps One Login Plugin",
          "Text": "Hi, Did you succeed set it up? I try to do the same with my moodle 3.0 sites.. Thanks!",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, January 16, 2017, 6:45 PM",
          "AuthorName": "lital l",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1541872&course=5",
          "role": [
            "Picture of lital l"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Google Apps One Login Plugin",
          "Text": "I have not been successful in getting one login to work.  Anyone that would like to contribute a success story?? Thanks!",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Saturday, January 21, 2017, 12:54 AM",
          "AuthorName": "Jason Touw",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1860221&course=5",
          "role": [
            "Picture of Jason Touw"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 344860,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=344860",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "moodle user and Office 365",
          "Text": "Hi I have well installed plugin o365 integration and it work but it create me always un new user, i want to it match moodle user with office 365 users login. I have upload in \"integration o365 settings\" >  tool tab > User Matching >  a simple file  with: \n```text\nmoodleuser1,bob.smith@example.onmicrosoft.com,1\n```\n but now, when i login with bob.smith@exemple.onmicrosoft.com, i arrive in bob.smith profile (new user). how can i be redirect in moodleuser1 profile (when i log in with bob.smith) ? ps: I Dont' want to create a new user for each o365 account. Thanks for any help",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Sunday, December 25, 2016, 9:49 PM",
          "AuthorName": "sterk jim",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2130882&course=5",
          "role": [
            "Picture of sterk jim"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 340446,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=340446",
      "NoOfResponses": 3,
      "ResponsesInList": [
        {
          "Title": "Better Google Integration",
          "Text": "Beginning Fall of 2015, Luther College, UCLA, and the University of Minnesota began collaborating to improve the integration of Google Apps with Moodle. Based on functionality developed by Bob Puffer at Luther College, the group began by outlining use cases, and from those use cases, built a prototype that was presented at MootUS16. This project is ongoing, and has since expanded substantially.  Anyone is welcome to join. User Stories GitHub Repository Meetings Wednesday’s 12:00PM PST - https://ucla.zoom.us/j/356175424 Demo of Integration Demo of Integration Demo of Display Types Demo of Display Types",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, September 27, 2016, 3:49 AM",
          "AuthorName": "Nick Thompson",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=807505&course=5",
          "role": [
            "Picture of Nick Thompson"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Better Google Integration",
          "Text": "GitHub separate plugin repo",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Thursday, October 6, 2016, 3:21 AM",
          "AuthorName": "Michelle Melton",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1940200&course=5",
          "role": [
            "Picture of Michelle Melton",
            "Picture of Core developers",
            "Picture of Plugin developers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Better Google Integration",
          "Text": "I have further updated the repo including the readme file. Assuming you have moodle setup, the below steps should let you set up the new repository. ~/Projects/moodle is where your moodle files reside. The file google_drive_core_changes.patch is temporary core changes we have made (a behat fix and minor lib/google modifcations). Here are UNIX command line steps. cd ~/Projects/moodle/repository git clone https://github.com/gedion/repository-google-drive mv repository-google-drive googledrive cd .. php admin/cli/upgrade.php //validate that repository/google_drive installed properly git apply repository/googledrive/google_drive_core_changes.patch //this patch is temporary If you are interested in running the behat(somewhat hardcoded at the moment) tests, your config.php file will require the below settings. Message me and I will provide you with the values. $CFG->forced_plugin_settings['googledrive']['clientid'] = '<clientid>' ; $CFG->forced_plugin_settings['googledrive']['secret'] = '<secret>'; $CFG->forced_plugin_settings['googledrive']['behatuser'] = '<gmailaccount>'; $CFG->forced_plugin_settings['googledrive']['behatpassword'] = '<gmailpassword>';",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, October 14, 2016, 2:07 AM",
          "AuthorName": "Gedion Woldeselassie",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1896843&course=5",
          "role": [
            "Picture of Gedion Woldeselassie"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 340176,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=340176",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Random users authentication switch",
          "Text": "We have the Office 365 plugin enabled. All our users authenticate to Moodle using ADFS and SAML. However, everyday a couple of user accounts seem to switch to OpenID authentication. This is not wanted, the user accounts need to be set to SAML. Any idea how this happens? Moodle 3.1",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, September 21, 2016, 8:00 PM",
          "AuthorName": "Richard van Iwaarden",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=138659&course=5",
          "role": [
            "Picture of Richard van Iwaarden",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 339734,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=339734",
      "NoOfResponses": 4,
      "ResponsesInList": [
        {
          "Title": "Login with office 365 for moodle it redirect to edit profile page?",
          "Text": "Hello, Connection in office 365 to moodle when i login through office 365 it goes to user/edit.php page in moodle. I want to redirect it to homepage . Any solution for fix that problem please let me know ASAP. Thanks!",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, September 13, 2016, 8:58 PM",
          "AuthorName": "Mayuri Kanate",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2137936&course=5",
          "role": [
            "Picture of Mayuri Kanate"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Login with office 365 for moodle it redirect to edit profile page?",
          "Text": "This might be because of missing profile fields. Moodle always redirects you tot the profile page to add at least the necessary information.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Friday, September 16, 2016, 5:52 PM",
          "AuthorName": "Richard van Iwaarden",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=138659&course=5",
          "role": [
            "Picture of Richard van Iwaarden",
            "Picture of Particularly helpful Moodlers"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Login with office 365 for moodle it redirect to edit profile page?",
          "Text": "I have all profile fields in moodle and office 365 same but that users not sync.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, September 19, 2016, 2:07 PM",
          "AuthorName": "Mayuri Kanate",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2137936&course=5",
          "role": [
            "Picture of Mayuri Kanate"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Login with office 365 for moodle it redirect to edit profile page?",
          "Text": "And in case if user is student then he don't have permission to edit their profile page. then what?",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Monday, September 19, 2016, 2:10 PM",
          "AuthorName": "Mayuri Kanate",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2137936&course=5",
          "role": [
            "Picture of Mayuri Kanate"
          ],
          "IsInitialPost": false
        }
      ]
    },
    {
      "PostID": 339733,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=339733",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "User Matching in Microsoft Office 365 Integration the Match Queue status is queued not change why?",
          "Text": "Hi, I trying to add csv file in user matching office 365 integration plugin settings, it is added successfully. but the status for match queue remain queued not change to successful. Please help me ASAP to find solution on it.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Tuesday, September 13, 2016, 8:50 PM",
          "AuthorName": "Mayuri Kanate",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=2137936&course=5",
          "role": [
            "Picture of Mayuri Kanate"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 337723,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=337723",
      "NoOfResponses": 1,
      "ResponsesInList": [
        {
          "Title": "Microsoft Office 365 Integration - New Users can't connect to Microsoft services",
          "Text": "Hello, We've been running the Office 365 integration plugins since last summer. At some point during an upgrade, new (or old accounts that never previously linked their accounts), non-admin users lost the ability to connect to Office 365. Users that had already linked their Moodle account to Office 365 can open their files on OneDrive for Business but new users don't even have an option to connect their account to Office 365 in the Microsoft block. If I log in as a new user and browse to https://ourserver/local/o365/ucp.php , no connection status shows up. If I browse to https://ourserver/local/o365/ucp.php?action=connecttoken as a new user, a permission error is generated. and the following error is logged: local_o365\\oauth2\\token::instance local_o365\\oauth2\\token::get_for_new_resource:174: Cannot retrieve a token for the base resource. Data: (null) If I browser to https://ourserver/local/o365/ucp.php?action=connecttoken as an existing user that previous linked to Office 365, I just get a screen asking to log into my Office 365 account. I'm not getting any errors when I run the health check in the Microsoft Office 365 Integration settings. This looks like a permissions issue but as far as I can tell, the users that previously linked their accounts to Office 365 have the same permissions as new users (and users that never linked their accounts) in Moodle. Does anyone have any ideas? Thanks -Travis",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, August 10, 2016, 5:56 AM",
          "AuthorName": "Travis Cullitan",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=253866&course=5",
          "role": [
            "Picture of Travis Cullitan"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        }
      ]
    },
    {
      "PostID": 336897,
      "LinkToPost": "https://moodle.org/mod/forum/discuss.php?d=336897",
      "NoOfResponses": 4,
      "ResponsesInList": [
        {
          "Title": "Post O365 plugin I get white screened",
          "Text": "Hi, I'd be grateful if anyone can point me in the right direction. I'm running a VPS; CentOS 6, Apache and Moodle 3.0 stable. I actually have done this twice, the first time I thought i broke it by playing with permissions, so i did a fresh install, locally and on my server . Locally was a test and is fine, but on my server I install the plugins by git with the relavant branch. The site acknowledges and installs them then loading the next page \"moodle/admin/upgradesettings.php?\" errors. From here when I try to access my site I get a blank page. The page I seem to be able to load is moodle/login Strangely I can manually delete \"/moodle/auth/oidc\" and when I load the site it detects its missing and goes through the install bit again, then the upgradesettings page errors again. I also can't go anywhere else as i;m stuck in the install dependency loop I've check the server error logs but they are empty, I tried to add debugging to my config.php nothing comes out as the page doesnt seem to load. Cheers Al",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Saturday, July 23, 2016, 3:02 AM",
          "AuthorName": "Al Beal",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1876612&course=5",
          "role": [
            "Picture of Al Beal"
          ],
          "IsInitialPost": true,
          "IsFeatureRequest": false
        },
        {
          "Title": "Re: Post O365 plugin I get white screened",
          "Text": "Ok I manually removed all the related plugins, which enabled me to load into my site, then uninstalled them to clean it up a bit. Now to find out the problem, by the Moodle Plugin Directory I'm installing them one by one and checking to make sure site works; local_o365 ..........ok auth_oidc ..........ok filter_oembed ...already installed (?) repository_office365 .....errors! blocks/microsoft.....ok So now to find out whats wrong with the repository.",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Saturday, July 23, 2016, 3:50 PM",
          "AuthorName": "Al Beal",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1876612&course=5",
          "role": [
            "Picture of Al Beal"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Post O365 plugin I get white screened",
          "Text": "Hi Al, If you're running PHP 5.4 we had an incompatibility that has just been resolved and pushed to the plugin database . Please upgrade and let me know that if that fixes the problem. Thanks! - James",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, July 27, 2016, 2:10 AM",
          "AuthorName": "James McQuillan",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1835508&course=5",
          "role": [
            "Picture of James McQuillan"
          ],
          "IsInitialPost": false
        },
        {
          "Title": "Re: Post O365 plugin I get white screened",
          "Text": "Yes I'm on PHP 5.4.28. I just installed it and it asked to update local_o365 and its all good now! Many thanks for the speedy update, looking forward to using it this year. Al",
          "HasImageInpost": false,
          "ImagesInPost": [],
          "Time": "Wednesday, July 27, 2016, 11:22 AM",
          "AuthorName": "Al Beal",
          "AuthorMoodleLink": "https://moodle.org/user/view.php?id=1876612&course=5",
          "role": [
            "Picture of Al Beal"
          ],
          "IsInitialPost": false
        }
      ]
    }
  ],
  "updated_no_of_posts": 127,
  "original_no_of_posts": 199,
  "removed_no_of_posts": 72
}